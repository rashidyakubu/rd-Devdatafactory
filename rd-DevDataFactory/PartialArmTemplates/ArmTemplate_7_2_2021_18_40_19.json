{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "rd-DevDataFactory"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/Branch_Cache to ODS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CopyActivity1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate Branch",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource"
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"validateDataConsistency": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataset_hdo",
								"type": "DatasetReference",
								"parameters": {
									"TableName": "SQLUser.Branch"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Landing_BranchDataset",
								"type": "DatasetReference"
							}
						]
					},
					{
						"name": "Truncate Branch",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[LandingTablesTruncate_Branch]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1_Landing Linked Service",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Insert",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Truncate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Branch_Insert]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 1').output.firstRow.RunStart1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run End 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "CopyActivity1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 1').output.firstRow.RunEnd1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 2').output.firstRow.RunStart2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run End 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Insert",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "UpdateControlTable",
						"description": "Stored procedure activity to store the new high-watermark value into external control table for delta data loading. ",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 2').output.firstRow.RunEnd2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "UpdateControlTable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[ODSBranch_Truncate]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					}
				],
				"parameters": {
					"ControlTable_Entity": {
						"type": "string",
						"defaultValue": "Branch"
					},
					"ControlTable_Group1": {
						"type": "string",
						"defaultValue": "10"
					},
					"ETLBeginTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run Start"
					},
					"ETLEndTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run End"
					},
					"ControlTable_Group2": {
						"type": "string",
						"defaultValue": "20"
					}
				},
				"annotations": [],
				"lastPublishTime": "2021-06-04T00:02:30Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SourceDataset_hdo')]",
				"[concat(variables('factoryId'), '/datasets/Landing_BranchDataset')]",
				"[concat(variables('factoryId'), '/datasets/ControlTableDataset')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Brand_Cache to ODS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CopyActivity1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate Branch",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource"
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"validateDataConsistency": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataset_hdo",
								"type": "DatasetReference",
								"parameters": {
									"TableName": "SQLUser.Brand"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Landing_BrandDataset",
								"type": "DatasetReference"
							}
						]
					},
					{
						"name": "Truncate Branch",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[LandingTablesTruncate_Brand]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1_Landing Linked Service",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Insert",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Truncate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Brand_Insert]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 1').output.firstRow.RunStart1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run End 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "CopyActivity1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 1').output.firstRow.RunEnd1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 2').output.firstRow.RunStart2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run End 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Insert",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "UpdateControlTable",
						"description": "Stored procedure activity to store the new high-watermark value into external control table for delta data loading. ",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 2').output.firstRow.RunEnd2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "UpdateControlTable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[ODSBrand_Truncate]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					}
				],
				"parameters": {
					"ControlTable_Entity": {
						"type": "string",
						"defaultValue": "Brand"
					},
					"ControlTable_Group1": {
						"type": "string",
						"defaultValue": "10"
					},
					"ETLBeginTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run Start"
					},
					"ETLEndTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run End"
					},
					"ControlTable_Group2": {
						"type": "string",
						"defaultValue": "20"
					}
				},
				"annotations": [],
				"lastPublishTime": "2021-06-10T01:35:50Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SourceDataset_hdo')]",
				"[concat(variables('factoryId'), '/datasets/Landing_BrandDataset')]",
				"[concat(variables('factoryId'), '/datasets/ControlTableDataset')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Cache to Azure SQL Copy Activity')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CopyActivity1",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource"
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"validateDataConsistency": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ID",
											"type": "Int32"
										},
										"sink": {
											"name": "ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Financed",
											"type": "Boolean"
										},
										"sink": {
											"name": "Financed",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "Void",
											"type": "Boolean"
										},
										"sink": {
											"name": "Void",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "Qualification",
											"type": "String"
										},
										"sink": {
											"name": "Qualification",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Priority",
											"type": "String"
										},
										"sink": {
											"name": "Priority",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Tax3Percentage",
											"type": "Decimal"
										},
										"sink": {
											"name": "Tax3Percentage",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "SvcRepairCode1",
											"type": "String"
										},
										"sink": {
											"name": "SvcRepairCode1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcRepairCode2",
											"type": "String"
										},
										"sink": {
											"name": "SvcRepairCode2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcRepairCode3",
											"type": "String"
										},
										"sink": {
											"name": "SvcRepairCode3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcRepairCode4",
											"type": "String"
										},
										"sink": {
											"name": "SvcRepairCode4",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ContractCode",
											"type": "String"
										},
										"sink": {
											"name": "ContractCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcContract",
											"type": "String"
										},
										"sink": {
											"name": "SvcContract",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "UserFinished",
											"type": "String"
										},
										"sink": {
											"name": "UserFinished",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "UserPosted",
											"type": "String"
										},
										"sink": {
											"name": "UserPosted",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "UpdateHistoryWarranty",
											"type": "Boolean"
										},
										"sink": {
											"name": "UpdateHistoryWarranty",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "ShipMethod",
											"type": "String"
										},
										"sink": {
											"name": "ShipMethod",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TimeCreated",
											"type": "String"
										},
										"sink": {
											"name": "TimeCreated",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TimeModified",
											"type": "String"
										},
										"sink": {
											"name": "TimeModified",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TimeFinished",
											"type": "String"
										},
										"sink": {
											"name": "TimeFinished",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DispatchUnits",
											"type": "Int32"
										},
										"sink": {
											"name": "DispatchUnits",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "EDIDateStamp",
											"type": "DateTime"
										},
										"sink": {
											"name": "EDIDateStamp",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "EDITimeStamp",
											"type": "String"
										},
										"sink": {
											"name": "EDITimeStamp",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PrintMethod",
											"type": "String"
										},
										"sink": {
											"name": "PrintMethod",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DispatchStartTime",
											"type": "String"
										},
										"sink": {
											"name": "DispatchStartTime",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TripChargeCode",
											"type": "String"
										},
										"sink": {
											"name": "TripChargeCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TripChargeAmount",
											"type": "Decimal"
										},
										"sink": {
											"name": "TripChargeAmount",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "Locked",
											"type": "Boolean"
										},
										"sink": {
											"name": "Locked",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "MobileTechInvoiceCode",
											"type": "String"
										},
										"sink": {
											"name": "MobileTechInvoiceCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ServiceRequestID",
											"type": "String"
										},
										"sink": {
											"name": "ServiceRequestID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CarrierCode",
											"type": "String"
										},
										"sink": {
											"name": "CarrierCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ShipViaCode",
											"type": "String"
										},
										"sink": {
											"name": "ShipViaCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "JobStatusUpdate",
											"type": "Boolean"
										},
										"sink": {
											"name": "JobStatusUpdate",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "DispatchEmail",
											"type": "Boolean"
										},
										"sink": {
											"name": "DispatchEmail",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "LastDateSaved",
											"type": "DateTime"
										},
										"sink": {
											"name": "LastDateSaved",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "LastTimeSaved",
											"type": "String"
										},
										"sink": {
											"name": "LastTimeSaved",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Terms",
											"type": "String"
										},
										"sink": {
											"name": "Terms",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcEquipmentNumber",
											"type": "String"
										},
										"sink": {
											"name": "SvcEquipmentNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "WebOrderID",
											"type": "String"
										},
										"sink": {
											"name": "WebOrderID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Department",
											"type": "String"
										},
										"sink": {
											"name": "Department",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CreditStatusCode",
											"type": "String"
										},
										"sink": {
											"name": "CreditStatusCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CreditApprovedUserCode",
											"type": "String"
										},
										"sink": {
											"name": "CreditApprovedUserCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CreditApprovedDateStamp",
											"type": "DateTime"
										},
										"sink": {
											"name": "CreditApprovedDateStamp",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CreditApprovedTimeStamp",
											"type": "String"
										},
										"sink": {
											"name": "CreditApprovedTimeStamp",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "EDIMaroline",
											"type": "Boolean"
										},
										"sink": {
											"name": "EDIMaroline",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "RequestedDate",
											"type": "DateTime"
										},
										"sink": {
											"name": "RequestedDate",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "SvcCSRInvoice",
											"type": "String"
										},
										"sink": {
											"name": "SvcCSRInvoice",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcSoldList",
											"type": "Decimal"
										},
										"sink": {
											"name": "SvcSoldList",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "SvcSoldSTDCost",
											"type": "Decimal"
										},
										"sink": {
											"name": "SvcSoldSTDCost",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "SvcFollowUpDate",
											"type": "DateTime"
										},
										"sink": {
											"name": "SvcFollowUpDate",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "SvcScheduleDate",
											"type": "DateTime"
										},
										"sink": {
											"name": "SvcScheduleDate",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "Tax2MaxAmount",
											"type": "Decimal"
										},
										"sink": {
											"name": "Tax2MaxAmount",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "EDIWhirlpool",
											"type": "Boolean"
										},
										"sink": {
											"name": "EDIWhirlpool",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "MinDepositPercent",
											"type": "Decimal"
										},
										"sink": {
											"name": "MinDepositPercent",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "UnitModifier",
											"type": "Int32"
										},
										"sink": {
											"name": "UnitModifier",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "DateFinished",
											"type": "DateTime"
										},
										"sink": {
											"name": "DateFinished",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "DatePosted",
											"type": "DateTime"
										},
										"sink": {
											"name": "DatePosted",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "TimePosted",
											"type": "String"
										},
										"sink": {
											"name": "TimePosted",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TTRTaxCalculated",
											"type": "Boolean"
										},
										"sink": {
											"name": "TTRTaxCalculated",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "PickUpBranchCode",
											"type": "String"
										},
										"sink": {
											"name": "PickUpBranchCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PodiumOptOut",
											"type": "Boolean"
										},
										"sink": {
											"name": "PodiumOptOut",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "SignCustmizedFields",
											"type": "String"
										},
										"sink": {
											"name": "SignCustmizedFields",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "AVBSaleDateSent",
											"type": "DateTime"
										},
										"sink": {
											"name": "AVBSaleDateSent",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AVBSaleTimeSent",
											"type": "String"
										},
										"sink": {
											"name": "AVBSaleTimeSent",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "sysCreated",
											"type": "DateTime"
										},
										"sink": {
											"name": "sysCreated",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "sysModified",
											"type": "DateTime"
										},
										"sink": {
											"name": "sysModified",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "TTRJurisdictionCode",
											"type": "String"
										},
										"sink": {
											"name": "TTRJurisdictionCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "BranchCode",
											"type": "String"
										},
										"sink": {
											"name": "BranchCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "COGSPosted",
											"type": "Boolean"
										},
										"sink": {
											"name": "COGSPosted",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "CallSequence",
											"type": "Int32"
										},
										"sink": {
											"name": "CallSequence",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Code",
											"type": "String"
										},
										"sink": {
											"name": "Code",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CommittedPaymentTotal",
											"type": "Decimal"
										},
										"sink": {
											"name": "CommittedPaymentTotal",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "DateCreated",
											"type": "DateTime"
										},
										"sink": {
											"name": "DateCreated",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "DateModified",
											"type": "DateTime"
										},
										"sink": {
											"name": "DateModified",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "DispatchPriority",
											"type": "String"
										},
										"sink": {
											"name": "DispatchPriority",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DispatchRequestedRouteCode",
											"type": "String"
										},
										"sink": {
											"name": "DispatchRequestedRouteCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DispatchSpecRequest",
											"type": "String"
										},
										"sink": {
											"name": "DispatchSpecRequest",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DispatchTime",
											"type": "String"
										},
										"sink": {
											"name": "DispatchTime",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DispatchTimeAM",
											"type": "String"
										},
										"sink": {
											"name": "DispatchTimeAM",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Estimate",
											"type": "String"
										},
										"sink": {
											"name": "Estimate",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Field1",
											"type": "String"
										},
										"sink": {
											"name": "Field1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Field2",
											"type": "String"
										},
										"sink": {
											"name": "Field2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Field3",
											"type": "String"
										},
										"sink": {
											"name": "Field3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Field4",
											"type": "String"
										},
										"sink": {
											"name": "Field4",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Field5",
											"type": "String"
										},
										"sink": {
											"name": "Field5",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "InvFinishDate",
											"type": "DateTime"
										},
										"sink": {
											"name": "InvFinishDate",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "InvStartDate",
											"type": "DateTime"
										},
										"sink": {
											"name": "InvStartDate",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "InvTypeCode",
											"type": "String"
										},
										"sink": {
											"name": "InvTypeCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemListPriceCode",
											"type": "String"
										},
										"sink": {
											"name": "ItemListPriceCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemTotal",
											"type": "Decimal"
										},
										"sink": {
											"name": "ItemTotal",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "JobLocation",
											"type": "String"
										},
										"sink": {
											"name": "JobLocation",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "JobNumber",
											"type": "String"
										},
										"sink": {
											"name": "JobNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "JobStatusCode",
											"type": "String"
										},
										"sink": {
											"name": "JobStatusCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LaborRate",
											"type": "String"
										},
										"sink": {
											"name": "LaborRate",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LaborTotal",
											"type": "Decimal"
										},
										"sink": {
											"name": "LaborTotal",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "MapReference",
											"type": "String"
										},
										"sink": {
											"name": "MapReference",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "MapZoneCode",
											"type": "String"
										},
										"sink": {
											"name": "MapZoneCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "MiscTotal",
											"type": "Decimal"
										},
										"sink": {
											"name": "MiscTotal",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "OpenPaymentTotal",
											"type": "Decimal"
										},
										"sink": {
											"name": "OpenPaymentTotal",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "OtherListPriceCode",
											"type": "String"
										},
										"sink": {
											"name": "OtherListPriceCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PONumber",
											"type": "String"
										},
										"sink": {
											"name": "PONumber",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PaymentTypeCode",
											"type": "String"
										},
										"sink": {
											"name": "PaymentTypeCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PickUpDate",
											"type": "DateTime"
										},
										"sink": {
											"name": "PickUpDate",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "Reference",
											"type": "String"
										},
										"sink": {
											"name": "Reference",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SaleReferralCode",
											"type": "String"
										},
										"sink": {
											"name": "SaleReferralCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Salesperson1Code",
											"type": "String"
										},
										"sink": {
											"name": "Salesperson1Code",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Salesperson2Code",
											"type": "String"
										},
										"sink": {
											"name": "Salesperson2Code",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Salesperson2Percentage",
											"type": "Decimal"
										},
										"sink": {
											"name": "Salesperson2Percentage",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "ScheduleDate",
											"type": "DateTime"
										},
										"sink": {
											"name": "ScheduleDate",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "SerialListPriceCode",
											"type": "String"
										},
										"sink": {
											"name": "SerialListPriceCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SerialTotal",
											"type": "Decimal"
										},
										"sink": {
											"name": "SerialTotal",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "Status",
											"type": "String"
										},
										"sink": {
											"name": "Status",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcAgreementExpDate",
											"type": "DateTime"
										},
										"sink": {
											"name": "SvcAgreementExpDate",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "SvcAgreementNumber",
											"type": "String"
										},
										"sink": {
											"name": "SvcAgreementNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcBrandCode",
											"type": "String"
										},
										"sink": {
											"name": "SvcBrandCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcCenter",
											"type": "String"
										},
										"sink": {
											"name": "SvcCenter",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcCenterNumber",
											"type": "String"
										},
										"sink": {
											"name": "SvcCenterNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcComplaintCode",
											"type": "String"
										},
										"sink": {
											"name": "SvcComplaintCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcComplaintDesc",
											"type": "String"
										},
										"sink": {
											"name": "SvcComplaintDesc",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcDatePurchased",
											"type": "DateTime"
										},
										"sink": {
											"name": "SvcDatePurchased",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "SvcDealerCode",
											"type": "String"
										},
										"sink": {
											"name": "SvcDealerCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcDealerDesc",
											"type": "String"
										},
										"sink": {
											"name": "SvcDealerDesc",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcDistributorNumber",
											"type": "String"
										},
										"sink": {
											"name": "SvcDistributorNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcInWarranty",
											"type": "String"
										},
										"sink": {
											"name": "SvcInWarranty",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcMfgCodeEiaNumber",
											"type": "String"
										},
										"sink": {
											"name": "SvcMfgCodeEiaNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcMicroLeak",
											"type": "String"
										},
										"sink": {
											"name": "SvcMicroLeak",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcMiles",
											"type": "Decimal"
										},
										"sink": {
											"name": "SvcMiles",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "SvcMilesRate",
											"type": "Decimal"
										},
										"sink": {
											"name": "SvcMilesRate",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "SvcMilesTotal",
											"type": "Decimal"
										},
										"sink": {
											"name": "SvcMilesTotal",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "SvcModel",
											"type": "String"
										},
										"sink": {
											"name": "SvcModel",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcMotorNewNumber",
											"type": "String"
										},
										"sink": {
											"name": "SvcMotorNewNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcMotorOldNumber",
											"type": "String"
										},
										"sink": {
											"name": "SvcMotorOldNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcPerformedCode",
											"type": "String"
										},
										"sink": {
											"name": "SvcPerformedCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcPerformedDesc",
											"type": "String"
										},
										"sink": {
											"name": "SvcPerformedDesc",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcProduct",
											"type": "String"
										},
										"sink": {
											"name": "SvcProduct",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcProductCode",
											"type": "String"
										},
										"sink": {
											"name": "SvcProductCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcRepairCatMinorMajor",
											"type": "String"
										},
										"sink": {
											"name": "SvcRepairCatMinorMajor",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcRepairCategory",
											"type": "String"
										},
										"sink": {
											"name": "SvcRepairCategory",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcRepairCode",
											"type": "String"
										},
										"sink": {
											"name": "SvcRepairCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcRunNumber",
											"type": "String"
										},
										"sink": {
											"name": "SvcRunNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcSerial",
											"type": "String"
										},
										"sink": {
											"name": "SvcSerial",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcSpecAuthNumber",
											"type": "String"
										},
										"sink": {
											"name": "SvcSpecAuthNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcStockMerchandise",
											"type": "Boolean"
										},
										"sink": {
											"name": "SvcStockMerchandise",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "SvcTimeCompleted1",
											"type": "String"
										},
										"sink": {
											"name": "SvcTimeCompleted1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcTimeCompleted2",
											"type": "String"
										},
										"sink": {
											"name": "SvcTimeCompleted2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcTimeOnJob1",
											"type": "String"
										},
										"sink": {
											"name": "SvcTimeOnJob1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcTimeOnJob2",
											"type": "String"
										},
										"sink": {
											"name": "SvcTimeOnJob2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcTimeStarted1",
											"type": "String"
										},
										"sink": {
											"name": "SvcTimeStarted1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SvcTimeStarted2",
											"type": "String"
										},
										"sink": {
											"name": "SvcTimeStarted2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Tax1Exempt",
											"type": "String"
										},
										"sink": {
											"name": "Tax1Exempt",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Tax1Total",
											"type": "Decimal"
										},
										"sink": {
											"name": "Tax1Total",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "Tax2Code",
											"type": "String"
										},
										"sink": {
											"name": "Tax2Code",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Tax2Exempt",
											"type": "String"
										},
										"sink": {
											"name": "Tax2Exempt",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Tax2Percentage",
											"type": "Decimal"
										},
										"sink": {
											"name": "Tax2Percentage",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "Tax2Total",
											"type": "Decimal"
										},
										"sink": {
											"name": "Tax2Total",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "Tax3Exempt",
											"type": "String"
										},
										"sink": {
											"name": "Tax3Exempt",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Tax3Total",
											"type": "Decimal"
										},
										"sink": {
											"name": "Tax3Total",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "UserCreated",
											"type": "String"
										},
										"sink": {
											"name": "UserCreated",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "UserModified",
											"type": "String"
										},
										"sink": {
											"name": "UserModified",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Warranty",
											"type": "String"
										},
										"sink": {
											"name": "Warranty",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "WarrantyField1",
											"type": "String"
										},
										"sink": {
											"name": "WarrantyField1",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "WarrantyField2",
											"type": "String"
										},
										"sink": {
											"name": "WarrantyField2",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "WarrantyField3",
											"type": "String"
										},
										"sink": {
											"name": "WarrantyField3",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "WarrantyField4",
											"type": "String"
										},
										"sink": {
											"name": "WarrantyField4",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "WarrantyField5",
											"type": "String"
										},
										"sink": {
											"name": "WarrantyField5",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "WtyTotal",
											"type": "Decimal"
										},
										"sink": {
											"name": "WtyTotal",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataset_hdo",
								"type": "DatasetReference",
								"parameters": {
									"TableName": "SQLUser.Invoice"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "DestinationDataset_hdo",
								"type": "DatasetReference",
								"parameters": {
									"TableName": "Invoice"
								}
							}
						]
					}
				],
				"annotations": [],
				"lastPublishTime": "2021-05-25T20:46:43Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SourceDataset_hdo')]",
				"[concat(variables('factoryId'), '/datasets/DestinationDataset_hdo')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Cache to Azure SQL Copy Activity2')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CopyActivity1",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource"
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"validateDataConsistency": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataset_hdo",
								"type": "DatasetReference",
								"parameters": {
									"TableName": "SQLUser.InvoiceAddress"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "InvoiceAddressODS",
								"type": "DatasetReference"
							}
						]
					}
				],
				"annotations": [],
				"lastPublishTime": "2021-05-25T20:48:25Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SourceDataset_hdo')]",
				"[concat(variables('factoryId'), '/datasets/InvoiceAddressODS')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Cache to Azure SQL Copy Activity3')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CopyActivity1",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource"
							},
							"sink": {
								"type": "AzureSqlSink",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"validateDataConsistency": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ID",
											"type": "Int32"
										},
										"sink": {
											"name": "ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "TakenStatus",
											"type": "String"
										},
										"sink": {
											"name": "TakenStatus",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TakenDate",
											"type": "DateTime"
										},
										"sink": {
											"name": "TakenDate",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "AverageCost",
											"type": "Decimal"
										},
										"sink": {
											"name": "AverageCost",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "StandardCost",
											"type": "Decimal"
										},
										"sink": {
											"name": "StandardCost",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "LastCost",
											"type": "Decimal"
										},
										"sink": {
											"name": "LastCost",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "Color",
											"type": "String"
										},
										"sink": {
											"name": "Color",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "POCode",
											"type": "String"
										},
										"sink": {
											"name": "POCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Reference",
											"type": "String"
										},
										"sink": {
											"name": "Reference",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PODateStamp",
											"type": "DateTime"
										},
										"sink": {
											"name": "PODateStamp",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "POLineTimeStamp",
											"type": "String"
										},
										"sink": {
											"name": "POLineTimeStamp",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SpecialOrderDate",
											"type": "DateTime"
										},
										"sink": {
											"name": "SpecialOrderDate",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "TripNo",
											"type": "Int32"
										},
										"sink": {
											"name": "TripNo",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "LandedCost",
											"type": "Decimal"
										},
										"sink": {
											"name": "LandedCost",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "AutoBackorder",
											"type": "Boolean"
										},
										"sink": {
											"name": "AutoBackorder",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "ManufacturersWarranty",
											"type": "Int32"
										},
										"sink": {
											"name": "ManufacturersWarranty",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "ReplacementCost",
											"type": "Decimal"
										},
										"sink": {
											"name": "ReplacementCost",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "UserVerified",
											"type": "String"
										},
										"sink": {
											"name": "UserVerified",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DateVerified",
											"type": "DateTime"
										},
										"sink": {
											"name": "DateVerified",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "TimeVerified",
											"type": "String"
										},
										"sink": {
											"name": "TimeVerified",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OriginalCost",
											"type": "Decimal"
										},
										"sink": {
											"name": "OriginalCost",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "ReserveExclusive",
											"type": "Boolean"
										},
										"sink": {
											"name": "ReserveExclusive",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "CommissionCode",
											"type": "String"
										},
										"sink": {
											"name": "CommissionCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "EDIFormat",
											"type": "String"
										},
										"sink": {
											"name": "EDIFormat",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "BranchCode",
											"type": "String"
										},
										"sink": {
											"name": "BranchCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "sysCreated",
											"type": "DateTime"
										},
										"sink": {
											"name": "sysCreated",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "sysModified",
											"type": "DateTime"
										},
										"sink": {
											"name": "sysModified",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "DateCreated",
											"type": "DateTime"
										},
										"sink": {
											"name": "DateCreated",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "DateModified",
											"type": "DateTime"
										},
										"sink": {
											"name": "DateModified",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "DateStamp",
											"type": "DateTime"
										},
										"sink": {
											"name": "DateStamp",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "InPackage",
											"type": "Boolean"
										},
										"sink": {
											"name": "InPackage",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "InvoiceCode",
											"type": "String"
										},
										"sink": {
											"name": "InvoiceCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LineTimeStamp",
											"type": "String"
										},
										"sink": {
											"name": "LineTimeStamp",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LocationCode",
											"type": "String"
										},
										"sink": {
											"name": "LocationCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ModelCode",
											"type": "String"
										},
										"sink": {
											"name": "ModelCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ModelDesc",
											"type": "String"
										},
										"sink": {
											"name": "ModelDesc",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "NewUsed",
											"type": "String"
										},
										"sink": {
											"name": "NewUsed",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "QtyOrdered",
											"type": "Int32"
										},
										"sink": {
											"name": "QtyOrdered",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "QtyReserved",
											"type": "Int32"
										},
										"sink": {
											"name": "QtyReserved",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "QtyShipped",
											"type": "Int32"
										},
										"sink": {
											"name": "QtyShipped",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SellingPrice",
											"type": "Decimal"
										},
										"sink": {
											"name": "SellingPrice",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "Spiff",
											"type": "Decimal"
										},
										"sink": {
											"name": "Spiff",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "Status",
											"type": "String"
										},
										"sink": {
											"name": "Status",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Tax1",
											"type": "Boolean"
										},
										"sink": {
											"name": "Tax1",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "Tax1CostList",
											"type": "String"
										},
										"sink": {
											"name": "Tax1CostList",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Tax1Included",
											"type": "Boolean"
										},
										"sink": {
											"name": "Tax1Included",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "Tax1Percentage",
											"type": "Decimal"
										},
										"sink": {
											"name": "Tax1Percentage",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "Tax2",
											"type": "Boolean"
										},
										"sink": {
											"name": "Tax2",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "Tax3",
											"type": "Boolean"
										},
										"sink": {
											"name": "Tax3",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "Total",
											"type": "Decimal"
										},
										"sink": {
											"name": "Total",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "UserCreated",
											"type": "String"
										},
										"sink": {
											"name": "UserCreated",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "UserModified",
											"type": "String"
										},
										"sink": {
											"name": "UserModified",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataset_hdo",
								"type": "DatasetReference",
								"parameters": {
									"TableName": "SQLUser.InvoiceModel"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "InvoiceModelODS",
								"type": "DatasetReference"
							}
						]
					}
				],
				"annotations": [],
				"lastPublishTime": "2021-06-07T19:03:44Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SourceDataset_hdo')]",
				"[concat(variables('factoryId'), '/datasets/InvoiceModelODS')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Cache to Azure SQL Copy Activity4')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CopyActivity1",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource"
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"validateDataConsistency": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ID",
											"type": "Int32"
										},
										"sink": {
											"name": "ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "TripNo",
											"type": "Int32"
										},
										"sink": {
											"name": "TripNo",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Comment",
											"type": "String"
										},
										"sink": {
											"name": "Comment",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SubmittedDate",
											"type": "DateTime"
										},
										"sink": {
											"name": "SubmittedDate",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "SubmittedTime",
											"type": "String"
										},
										"sink": {
											"name": "SubmittedTime",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SubmittedUser",
											"type": "String"
										},
										"sink": {
											"name": "SubmittedUser",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CreditedDate",
											"type": "DateTime"
										},
										"sink": {
											"name": "CreditedDate",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CreditedTime",
											"type": "String"
										},
										"sink": {
											"name": "CreditedTime",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CreditedUser",
											"type": "String"
										},
										"sink": {
											"name": "CreditedUser",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "InvoicePaymentRef",
											"type": "String"
										},
										"sink": {
											"name": "InvoicePaymentRef",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "UserVerified",
											"type": "String"
										},
										"sink": {
											"name": "UserVerified",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DateVerified",
											"type": "DateTime"
										},
										"sink": {
											"name": "DateVerified",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "TimeVerified",
											"type": "String"
										},
										"sink": {
											"name": "TimeVerified",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CommissionCode",
											"type": "String"
										},
										"sink": {
											"name": "CommissionCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "EDIFormat",
											"type": "String"
										},
										"sink": {
											"name": "EDIFormat",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "InvoiceModelDateStamp",
											"type": "DateTime"
										},
										"sink": {
											"name": "InvoiceModelDateStamp",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "InvoiceModelLineTimeStamp",
											"type": "String"
										},
										"sink": {
											"name": "InvoiceModelLineTimeStamp",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "InvoiceModelInvoiceCode",
											"type": "String"
										},
										"sink": {
											"name": "InvoiceModelInvoiceCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "InvoiceModelCode",
											"type": "String"
										},
										"sink": {
											"name": "InvoiceModelCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "BranchCode",
											"type": "String"
										},
										"sink": {
											"name": "BranchCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "sysCreated",
											"type": "DateTime"
										},
										"sink": {
											"name": "sysCreated",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "sysModified",
											"type": "DateTime"
										},
										"sink": {
											"name": "sysModified",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "DateCreated",
											"type": "DateTime"
										},
										"sink": {
											"name": "DateCreated",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "DateModified",
											"type": "DateTime"
										},
										"sink": {
											"name": "DateModified",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "DateStamp",
											"type": "DateTime"
										},
										"sink": {
											"name": "DateStamp",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "GLCostCr",
											"type": "String"
										},
										"sink": {
											"name": "GLCostCr",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "GLCostDb",
											"type": "String"
										},
										"sink": {
											"name": "GLCostDb",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "GLRevenue",
											"type": "String"
										},
										"sink": {
											"name": "GLRevenue",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "InPackage",
											"type": "Boolean"
										},
										"sink": {
											"name": "InPackage",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "InvoiceCode",
											"type": "String"
										},
										"sink": {
											"name": "InvoiceCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LineTimeStamp",
											"type": "String"
										},
										"sink": {
											"name": "LineTimeStamp",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "MiscCode",
											"type": "String"
										},
										"sink": {
											"name": "MiscCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "MiscDesc",
											"type": "String"
										},
										"sink": {
											"name": "MiscDesc",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Qty",
											"type": "Int32"
										},
										"sink": {
											"name": "Qty",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "SellingPrice",
											"type": "Decimal"
										},
										"sink": {
											"name": "SellingPrice",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "Tax1",
											"type": "Boolean"
										},
										"sink": {
											"name": "Tax1",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "Tax2",
											"type": "Boolean"
										},
										"sink": {
											"name": "Tax2",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "Tax3",
											"type": "Boolean"
										},
										"sink": {
											"name": "Tax3",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "Total",
											"type": "Decimal"
										},
										"sink": {
											"name": "Total",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "UnitCost",
											"type": "Decimal"
										},
										"sink": {
											"name": "UnitCost",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "UpdateHistory",
											"type": "Boolean"
										},
										"sink": {
											"name": "UpdateHistory",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "UserCreated",
											"type": "String"
										},
										"sink": {
											"name": "UserCreated",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "UserModified",
											"type": "String"
										},
										"sink": {
											"name": "UserModified",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Warranty",
											"type": "String"
										},
										"sink": {
											"name": "Warranty",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataset_hdo",
								"type": "DatasetReference",
								"parameters": {
									"TableName": "SQLUser.InvoiceMisc"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "InvoiceMiscODS",
								"type": "DatasetReference"
							}
						]
					}
				],
				"annotations": [],
				"lastPublishTime": "2021-05-25T20:46:43Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SourceDataset_hdo')]",
				"[concat(variables('factoryId'), '/datasets/InvoiceMiscODS')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Cache to Azure SQL Copy Activity4_copy1')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CopyActivity1",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource"
							},
							"sink": {
								"type": "AzureSqlSink",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"validateDataConsistency": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ID",
											"type": "Int32"
										},
										"sink": {
											"name": "ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "TripNo",
											"type": "Int32"
										},
										"sink": {
											"name": "TripNo",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Acknowledged",
											"type": "Boolean"
										},
										"sink": {
											"name": "Acknowledged",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "DateAcknowledged",
											"type": "DateTime"
										},
										"sink": {
											"name": "DateAcknowledged",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "OrgModSelPrice",
											"type": "Decimal"
										},
										"sink": {
											"name": "OrgModSelPrice",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "CheckException",
											"type": "Boolean"
										},
										"sink": {
											"name": "CheckException",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "UserVerified",
											"type": "String"
										},
										"sink": {
											"name": "UserVerified",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DateVerified",
											"type": "DateTime"
										},
										"sink": {
											"name": "DateVerified",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "TimeVerified",
											"type": "String"
										},
										"sink": {
											"name": "TimeVerified",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CommissionCode",
											"type": "String"
										},
										"sink": {
											"name": "CommissionCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "BranchCode",
											"type": "String"
										},
										"sink": {
											"name": "BranchCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "sysCreated",
											"type": "DateTime"
										},
										"sink": {
											"name": "sysCreated",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "sysModified",
											"type": "DateTime"
										},
										"sink": {
											"name": "sysModified",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "Commission",
											"type": "Decimal"
										},
										"sink": {
											"name": "Commission",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "ContractNumber",
											"type": "String"
										},
										"sink": {
											"name": "ContractNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DateCreated",
											"type": "DateTime"
										},
										"sink": {
											"name": "DateCreated",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "DateModified",
											"type": "DateTime"
										},
										"sink": {
											"name": "DateModified",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "DateStamp",
											"type": "DateTime"
										},
										"sink": {
											"name": "DateStamp",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "EndDate",
											"type": "DateTime"
										},
										"sink": {
											"name": "EndDate",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "ExtWarrantyCode",
											"type": "String"
										},
										"sink": {
											"name": "ExtWarrantyCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ExtWarrantyDesc",
											"type": "String"
										},
										"sink": {
											"name": "ExtWarrantyDesc",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "GLCostCr",
											"type": "String"
										},
										"sink": {
											"name": "GLCostCr",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "GLCostDb",
											"type": "String"
										},
										"sink": {
											"name": "GLCostDb",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "GLRevenue",
											"type": "String"
										},
										"sink": {
											"name": "GLRevenue",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "InPackage",
											"type": "Boolean"
										},
										"sink": {
											"name": "InPackage",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "InvoiceCode",
											"type": "String"
										},
										"sink": {
											"name": "InvoiceCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LineTimeStamp",
											"type": "String"
										},
										"sink": {
											"name": "LineTimeStamp",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Model",
											"type": "String"
										},
										"sink": {
											"name": "Model",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SellingPrice",
											"type": "Decimal"
										},
										"sink": {
											"name": "SellingPrice",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "Serial",
											"type": "String"
										},
										"sink": {
											"name": "Serial",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StartDate",
											"type": "DateTime"
										},
										"sink": {
											"name": "StartDate",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "Tax1",
											"type": "Boolean"
										},
										"sink": {
											"name": "Tax1",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "Tax2",
											"type": "Boolean"
										},
										"sink": {
											"name": "Tax2",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "Tax3",
											"type": "Boolean"
										},
										"sink": {
											"name": "Tax3",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "UnitCost",
											"type": "Decimal"
										},
										"sink": {
											"name": "UnitCost",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "UserCreated",
											"type": "String"
										},
										"sink": {
											"name": "UserCreated",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "UserModified",
											"type": "String"
										},
										"sink": {
											"name": "UserModified",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataset_hdo",
								"type": "DatasetReference",
								"parameters": {
									"TableName": "SQLUser.InvoiceWarranty"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "InvoiceWarrantyODS",
								"type": "DatasetReference"
							}
						]
					}
				],
				"annotations": [],
				"lastPublishTime": "2021-05-25T20:46:43Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SourceDataset_hdo')]",
				"[concat(variables('factoryId'), '/datasets/InvoiceWarrantyODS')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Cache to Azure SQL Copy InvoiceMisc_copy1')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CopyActivity1",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource"
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"validateDataConsistency": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ID",
											"type": "Int32"
										},
										"sink": {
											"name": "ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "TripNo",
											"type": "Int32"
										},
										"sink": {
											"name": "TripNo",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "CashedOut",
											"type": "Boolean"
										},
										"sink": {
											"name": "CashedOut",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "CashOutUser",
											"type": "String"
										},
										"sink": {
											"name": "CashOutUser",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CashOutDateStamp",
											"type": "DateTime"
										},
										"sink": {
											"name": "CashOutDateStamp",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "CashOutTimeStamp",
											"type": "String"
										},
										"sink": {
											"name": "CashOutTimeStamp",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TerminalCode",
											"type": "String"
										},
										"sink": {
											"name": "TerminalCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PayerIdentifier",
											"type": "String"
										},
										"sink": {
											"name": "PayerIdentifier",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "SPAN",
											"type": "String"
										},
										"sink": {
											"name": "SPAN",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PayerDataManagedUntilDate",
											"type": "String"
										},
										"sink": {
											"name": "PayerDataManagedUntilDate",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CardBrand",
											"type": "String"
										},
										"sink": {
											"name": "CardBrand",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "EntryMethod",
											"type": "String"
										},
										"sink": {
											"name": "EntryMethod",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "InvoicePaymentRef",
											"type": "String"
										},
										"sink": {
											"name": "InvoicePaymentRef",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PayerIdType",
											"type": "String"
										},
										"sink": {
											"name": "PayerIdType",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "sysCreated",
											"type": "DateTime"
										},
										"sink": {
											"name": "sysCreated",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "sysModified",
											"type": "DateTime"
										},
										"sink": {
											"name": "sysModified",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "BankTransactionID",
											"type": "String"
										},
										"sink": {
											"name": "BankTransactionID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Amount",
											"type": "Decimal"
										},
										"sink": {
											"name": "Amount",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "AuthCode",
											"type": "String"
										},
										"sink": {
											"name": "AuthCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "AuthStatus",
											"type": "String"
										},
										"sink": {
											"name": "AuthStatus",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "BranchCode",
											"type": "String"
										},
										"sink": {
											"name": "BranchCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CardNumber",
											"type": "String"
										},
										"sink": {
											"name": "CardNumber",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DateCreated",
											"type": "DateTime"
										},
										"sink": {
											"name": "DateCreated",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "DateModified",
											"type": "DateTime"
										},
										"sink": {
											"name": "DateModified",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "DateStamp",
											"type": "DateTime"
										},
										"sink": {
											"name": "DateStamp",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "Description",
											"type": "String"
										},
										"sink": {
											"name": "Description",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ExpiryDate",
											"type": "String"
										},
										"sink": {
											"name": "ExpiryDate",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "InvoiceCode",
											"type": "String"
										},
										"sink": {
											"name": "InvoiceCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LineTimeStamp",
											"type": "String"
										},
										"sink": {
											"name": "LineTimeStamp",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PaymentTypeCode",
											"type": "String"
										},
										"sink": {
											"name": "PaymentTypeCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PostDate",
											"type": "DateTime"
										},
										"sink": {
											"name": "PostDate",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "RespBankText",
											"type": "String"
										},
										"sink": {
											"name": "RespBankText",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RespBatchNo",
											"type": "Int32"
										},
										"sink": {
											"name": "RespBatchNo",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RespDate",
											"type": "String"
										},
										"sink": {
											"name": "RespDate",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RespItemNo",
											"type": "Int32"
										},
										"sink": {
											"name": "RespItemNo",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "RespRefNo",
											"type": "String"
										},
										"sink": {
											"name": "RespRefNo",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "RespSettlementAmount",
											"type": "Decimal"
										},
										"sink": {
											"name": "RespSettlementAmount",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "RespTime",
											"type": "String"
										},
										"sink": {
											"name": "RespTime",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Status",
											"type": "String"
										},
										"sink": {
											"name": "Status",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "UserCreated",
											"type": "String"
										},
										"sink": {
											"name": "UserCreated",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "UserModified",
											"type": "String"
										},
										"sink": {
											"name": "UserModified",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataset_hdo",
								"type": "DatasetReference",
								"parameters": {
									"TableName": "SQLUser.InvoicePayment"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "InvoicePaymentODS",
								"type": "DatasetReference"
							}
						]
					}
				],
				"annotations": [],
				"lastPublishTime": "2021-06-03T16:58:30Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SourceDataset_hdo')]",
				"[concat(variables('factoryId'), '/datasets/InvoicePaymentODS')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Cache to Azure SQL Copy InvoiceModel')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CopyActivity1",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource"
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"validateDataConsistency": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "ID",
											"type": "Int32"
										},
										"sink": {
											"name": "ID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "TakenLocationCode",
											"type": "String"
										},
										"sink": {
											"name": "TakenLocationCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ReturnReasonCode",
											"type": "String"
										},
										"sink": {
											"name": "ReturnReasonCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ReturnOutcomeCode",
											"type": "String"
										},
										"sink": {
											"name": "ReturnOutcomeCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ReturnInitiatedByCode",
											"type": "String"
										},
										"sink": {
											"name": "ReturnInitiatedByCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "sysCreated",
											"type": "DateTime"
										},
										"sink": {
											"name": "sysCreated",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "sysModified",
											"type": "DateTime"
										},
										"sink": {
											"name": "sysModified",
											"type": "DateTime",
											"physicalType": "datetime"
										}
									},
									{
										"source": {
											"name": "DateCommitted",
											"type": "DateTime"
										},
										"sink": {
											"name": "DateCommitted",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "DateCreated",
											"type": "DateTime"
										},
										"sink": {
											"name": "DateCreated",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "DateModified",
											"type": "DateTime"
										},
										"sink": {
											"name": "DateModified",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "InvoiceCode",
											"type": "String"
										},
										"sink": {
											"name": "InvoiceCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "LocationCode",
											"type": "String"
										},
										"sink": {
											"name": "LocationCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ModelCode",
											"type": "String"
										},
										"sink": {
											"name": "ModelCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ModelDateStamp",
											"type": "DateTime"
										},
										"sink": {
											"name": "ModelDateStamp",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "ModelLineTimeStamp",
											"type": "String"
										},
										"sink": {
											"name": "ModelLineTimeStamp",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Returned",
											"type": "Boolean"
										},
										"sink": {
											"name": "Returned",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "SerialCode",
											"type": "String"
										},
										"sink": {
											"name": "SerialCode",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Status",
											"type": "String"
										},
										"sink": {
											"name": "Status",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Taken",
											"type": "Boolean"
										},
										"sink": {
											"name": "Taken",
											"type": "Boolean",
											"physicalType": "bit"
										}
									},
									{
										"source": {
											"name": "TakenDate",
											"type": "DateTime"
										},
										"sink": {
											"name": "TakenDate",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "TakenStatus",
											"type": "String"
										},
										"sink": {
											"name": "TakenStatus",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "UnitCost",
											"type": "Decimal"
										},
										"sink": {
											"name": "UnitCost",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 4,
											"precision": 15
										}
									},
									{
										"source": {
											"name": "UserCreated",
											"type": "String"
										},
										"sink": {
											"name": "UserCreated",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "UserModified",
											"type": "String"
										},
										"sink": {
											"name": "UserModified",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataset_hdo",
								"type": "DatasetReference",
								"parameters": {
									"TableName": "SQLUser.InvoiceSerial"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "InvoiceSerialODS",
								"type": "DatasetReference"
							}
						]
					}
				],
				"annotations": [],
				"lastPublishTime": "2021-06-02T16:21:48Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SourceDataset_hdo')]",
				"[concat(variables('factoryId'), '/datasets/InvoiceSerialODS')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Customer_CachetoODS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Copy new or updated rows only from database using external control table",
				"activities": [
					{
						"name": "LookupLastWaterMark",
						"description": "Retrieve the last high-watermark value stored in external control table",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Landing_watermarktableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "LookupCurrentWaterMark",
						"description": "Retrieve  the current maximum value in watermark column of source data store",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Get Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DATEADD(dd,0,[ETL Last Run Start]) as NewWatermarkValue\nFROM ca.Control_Table\nWHERE [Group]=10 AND Entity='Customer'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "DeltaCopyfromDB",
						"description": "Copy activity to use query to filter the delta data by > last high-watermark and <= current high-watermark from source database, and then only copy the changes to the destination store.",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LookupCurrentWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "LookupLastWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Truncate Landing_Invoice Procedure",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "LookupDeltaOffset",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource",
								"query": {
									"value": "select         ID\n      ,FinanceCompany\n      ,FinanceDocument\n      ,ThirtyDayAccount\n      ,PORequired\n      ,Suite\n      ,Longitude\n      ,Latitude\n      ,Statement\n      ,DoNotMail\n      ,ShowInvoicesHyperlink\n      ,Extensions\n      ,Overdue30\n      ,Overdue60\n      ,Overdue90\n      ,Overdue\n      ,MaritalStatus\n      ,Dependants\n      ,EmpOccupation\n      ,Employer\n      ,DoNotService\n      ,MailingSameAsPhysical\n      ,InvTypeCode\n      ,EmpSupervisor\n      ,EmpAltSupervisor\n      ,EmpPayday\n      ,EmpExt\n      ,EmpFromTime\n      ,EmpToTime\n      ,WebID\n      ,WebPassword\n      ,WebDefaultLocation\n      ,WebShipPreference\n      ,WebChargeShipping\n      ,PaymentTypeCode\n      ,BankruptCode\n      ,CreditHold\n      ,WebNotShowRef\n      ,WebNotShowPastDueWarn\n      ,DoNotEmail\n      ,InvoiceDeliveryMethod\n      ,WebViewPartsLookup\n      ,WebViewCurrentOrders\n      ,WebViewOpenPartsList\n      ,WebViewHistory\n      ,WebAccessType\n      ,WebPassword2\n      ,WebCarrierCode\n      ,GoogleValidated\n      ,WebAllowSearchAll\n      ,Phone1TextEnabled\n      ,Phone2TextEnabled\n      ,BusinessPhoneTextEnabled\n      ,FaxTextEnabled\n      ,WebMessageUserCode\n      ,WebMessageRecUserCode\n      ,DoNotText\n      ,DoNotMMS\n      ,PreferredContact\n      ,WebSubmitClaim1Year\n      ,WebSubmitClaimSub\n      ,WebSubmitClaimWolf\n      ,WebReturnParts\n      ,UpdateContactInfo\n      ,SynchInMobileTech\n      ,WebLanguage\n      ,SalespersonCode\n      ,CreditManagerUserCode\n      ,CreditHoldDays\n      ,ForceCreditApproval\n      ,DoNotAllowSaveCreditCard\n      ,UseProjectPricing\n      ,ProjectCode\n      ,SaleReferralCode\n      ,Country\n      ,DeclineEmail\n      ,ParentCompanyCode\n      ,Table1Code\n      ,ExternalID\n      ,AccountType\n      ,AllowCharge\n      ,AveragePaymentDays\n      ,Balance\n      ,BillServiceCharge\n      ,BranchCode\n      ,City\n      ,Code\n      ,Contact\n      ,CreditLimit\n      ,DateCreated\n      ,DateModified\n      ,Directions\n      ,EnableCreditLimit\n      ,ExpiryDate\n      ,Field1\n      ,Field2\n      ,Field3\n      ,Field4\n      ,Field5\n      ,ItemListPriceCode\n      ,LaborRate\n      ,LastActivityDate\n      ,LastYearPurchase\n      ,MapReference\n      ,MapZoneCode\n      ,Note\n      ,OtherListPriceCode\n      ,PONumber\n      ,PrintStatement\n      ,SerialListPriceCode\n      ,State\n      ,Tax1Exempt\n      ,Tax2Exempt\n      ,Tax3Exempt\n      ,TaxCode\n      ,UserCreated\n      ,UserModified\n      ,Website\n      ,YTDPurchase\n      ,ZipCode\nfrom \n@{pipeline().parameters.Data_Source_Table_Name} \n\t where (@{pipeline().parameters.Data_Source_WaterMarkColumn_modified} > '@{activity('LookupDeltaOffset').output.firstRow.DeltaOffset}' OR\n@{pipeline().parameters.Data_Source_WaterMarkColumn_created} > '@{activity('LookupDeltaOffset').output.firstRow.DeltaOffset}')\n\t and (@{pipeline().parameters.Data_Source_WaterMarkColumn_modified} <= '@{activity('LookupCurrentWaterMark').output.firstRow.NewWatermarkValue}' OR\n@{pipeline().parameters.Data_Source_WaterMarkColumn_created} <= '@{activity('LookupCurrentWaterMark').output.firstRow.NewWatermarkValue}')\n",
									"type": "Expression"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"dataIntegrationUnits": 0
						},
						"inputs": [
							{
								"referenceName": "OdbcDataSource",
								"type": "DatasetReference"
							}
						],
						"outputs": [
							{
								"referenceName": "Landing_CustomerDataset",
								"type": "DatasetReference"
							}
						]
					},
					{
						"name": "UpdateWaterMark",
						"description": "Stored procedure activity to store the new high-watermark value into external control table for delta data loading. ",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 2').output.firstRow.RunEnd2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate Landing_Invoice Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[LandingTablesTruncate_Customer]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1_Landing Linked Service",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Delete",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Customer_Delete]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Insert",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Delete",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Customer_Insert]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "UpdateWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LookupDeltaOffset",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DATEADD(dd,-[DeltaOffset (Days)],[ETL Last Run End]) AS DeltaOffset\nFROM ca.Control_Table\nWHERE Entity='Customer' AND\n             [Group]=10",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 1').output.firstRow.RunStart1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set Run End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 1').output.firstRow.RunEnd1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set Run Start 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 2').output.firstRow.RunStart2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 1",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run End 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "DeltaCopyfromDB",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run Start 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run End 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Insert",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					}
				],
				"parameters": {
					"Data_Source_Table_Name": {
						"type": "String",
						"defaultValue": "SQLUser.Customer"
					},
					"Data_Source_WaterMarkColumn": {
						"type": "String",
						"defaultValue": "DateModified"
					},
					"Data_Destination_Container": {
						"type": "String",
						"defaultValue": "rd.Customer"
					},
					"Data_Destination_Directory": {
						"type": "String"
					},
					"Control_Table_Table_Name": {
						"type": "String",
						"defaultValue": "watermark_table"
					},
					"Control_Table_Column_Name": {
						"type": "String",
						"defaultValue": "Invoicewatermark_value"
					},
					"Data_Source_WaterMarkColumn_modified": {
						"type": "string",
						"defaultValue": "SQLUser.Customer.DateModified"
					},
					"DeltaOffset": {
						"type": "int",
						"defaultValue": -1
					},
					"ControlTable_Entity": {
						"type": "string",
						"defaultValue": "Customer"
					},
					"ControlTable_Group1": {
						"type": "int",
						"defaultValue": 10
					},
					"ControlTable_Group2": {
						"type": "int",
						"defaultValue": 20
					},
					"ETLBeginTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run Start"
					},
					"ETLEndTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run End"
					},
					"Data_Source_WaterMarkColumn_created": {
						"type": "string",
						"defaultValue": "DateCreated"
					}
				},
				"variables": {
					"Run Start 1": {
						"type": "String"
					},
					"Run Start 2": {
						"type": "String"
					},
					"Run End 1": {
						"type": "String"
					},
					"Run End 2": {
						"type": "String"
					}
				},
				"annotations": [],
				"lastPublishTime": "2021-06-02T21:56:56Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Landing_watermarktableDataset')]",
				"[concat(variables('factoryId'), '/datasets/ControlTableDataset')]",
				"[concat(variables('factoryId'), '/datasets/OdbcDataSource')]",
				"[concat(variables('factoryId'), '/datasets/Landing_CustomerDataset')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Dim_ProductMajor_Cache to ODS Copy Activity')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CopyActivity1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate Branch",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource"
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"validateDataConsistency": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataset_hdo",
								"type": "DatasetReference",
								"parameters": {
									"TableName": "SQLUser.Dim_ProductMajor"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Landing_DimProductMajorDataset",
								"type": "DatasetReference"
							}
						]
					},
					{
						"name": "Truncate Branch",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[LandingTablesTruncate_Dim_ProductMajor]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1_Landing Linked Service",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Insert",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Truncate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Dim_ProductMajor_Insert]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 1').output.firstRow.RunStart1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run End 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "CopyActivity1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 1').output.firstRow.RunEnd1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 2').output.firstRow.RunStart2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run End 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Insert",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "UpdateControlTable",
						"description": "Stored procedure activity to store the new high-watermark value into external control table for delta data loading. ",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 2').output.firstRow.RunEnd2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "UpdateControlTable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[ODSDim_ProductMajor_Truncate]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					}
				],
				"parameters": {
					"ControlTable_Entity": {
						"type": "string",
						"defaultValue": "Dim_ProductMajor"
					},
					"ControlTable_Group1": {
						"type": "string",
						"defaultValue": "10"
					},
					"ETLBeginTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run Start"
					},
					"ETLEndTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run End"
					},
					"ControlTable_Group2": {
						"type": "string",
						"defaultValue": "20"
					}
				},
				"annotations": [],
				"lastPublishTime": "2021-06-10T02:17:28Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SourceDataset_hdo')]",
				"[concat(variables('factoryId'), '/datasets/Landing_DimProductMajorDataset')]",
				"[concat(variables('factoryId'), '/datasets/ControlTableDataset')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Dim_ProductSuper_Cache to ODS Copy Activity')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CopyActivity1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate Branch",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource"
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"validateDataConsistency": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataset_hdo",
								"type": "DatasetReference",
								"parameters": {
									"TableName": "SQLUser.Dim_ProductSuper"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Landing_DimProductSuperDataset",
								"type": "DatasetReference"
							}
						]
					},
					{
						"name": "Truncate Branch",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[LandingTablesTruncate_Dim_ProductSuper]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1_Landing Linked Service",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Insert",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Truncate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Dim_ProductSuper_Insert]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 1').output.firstRow.RunStart1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run End 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "CopyActivity1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 1').output.firstRow.RunEnd1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 2').output.firstRow.RunStart2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run End 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Insert",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "UpdateControlTable",
						"description": "Stored procedure activity to store the new high-watermark value into external control table for delta data loading. ",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 2').output.firstRow.RunEnd2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "UpdateControlTable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[ODSDim_ProductSuper_Truncate]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					}
				],
				"parameters": {
					"ControlTable_Entity": {
						"type": "string",
						"defaultValue": "Dim_ProductSuper"
					},
					"ControlTable_Group1": {
						"type": "string",
						"defaultValue": "10"
					},
					"ETLBeginTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run Start"
					},
					"ETLEndTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run End"
					},
					"ControlTable_Group2": {
						"type": "string",
						"defaultValue": "20"
					}
				},
				"annotations": [],
				"lastPublishTime": "2021-06-10T01:52:00Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SourceDataset_hdo')]",
				"[concat(variables('factoryId'), '/datasets/Landing_DimProductSuperDataset')]",
				"[concat(variables('factoryId'), '/datasets/ControlTableDataset')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/InvoiceAddress_CachetoODS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Copy new or updated rows only from database using external control table",
				"activities": [
					{
						"name": "LookupLastWaterMark",
						"description": "Retrieve the last high-watermark value stored in external control table",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Landing_watermarktableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "LookupCurrentWaterMark",
						"description": "Retrieve  the current maximum value in watermark column of source data store",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DATEADD(dd,0,[ETL Last Run Start]) as NewWatermarkValue\nFROM ca.Control_Table\nWHERE [Group]=10 AND Entity='Invoice'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "DeltaCopyfromDB",
						"description": "Copy activity to use query to filter the delta data by > last high-watermark and <= current high-watermark from source database, and then only copy the changes to the destination store.",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LookupCurrentWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "LookupLastWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Truncate Landing_Invoice Procedure",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "LookupDeltaOffset",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource",
								"query": {
									"value": "select  SQLUser.InvoiceAddress.ID\n      ,TripNo\n      ,ParentDateStamp\n      ,ParentLineTimeStamp\n      ,SQLUser.InvoiceAddress.sysCreated\n      ,SQLUser.InvoiceAddress.sysModified\n      ,SQLUser.InvoiceAddress.Amount\n      ,SQLUser.InvoiceAddress.Code\n      ,SQLUser.InvoiceAddress.DateStamp\n      ,SQLUser.InvoiceAddress.Description\n      ,SQLUser.InvoiceAddress.InPackage\n      ,InvoiceCode\n      ,LineNo\n      ,LineTimeStamp\n      ,LineType\n      ,SQLUser.InvoiceAddress.LocationCode\n      ,SQLUser.InvoiceAddress.Qty\n      ,SQLUser.InvoiceAddress.Status\n      ,SQLUser.InvoiceAddress.Tax1\n      ,SQLUser.InvoiceAddress.Tax2\n      ,SQLUser.InvoiceAddress.Tax3\n      \nfrom \nSQLUser.InvoiceAddress INNER JOIN SQLUser.Invoice ON InvoiceCode=SQLUser.Invoice.Code\nwhere (@{pipeline().parameters.Data_Source2_WaterMarkColumn} > '@{activity('LookupDeltaOffset').output.firstRow.DeltaOffset}' OR (SQLUser.InvoiceAddress.sysCreated>'@{activity('LookupDeltaOffset').output.firstRow.DeltaOffset}' OR SQLUser.InvoiceAddress.sysModified>'@{activity('LookupDeltaOffset').output.firstRow.DeltaOffset}')) and (@{pipeline().parameters.Data_Source2_WaterMarkColumn} <= '@{activity('LookupCurrentWaterMark').output.firstRow.NewWatermarkValue}' OR \n(SQLUser.InvoiceAddress.sysCreated<='@{activity('LookupCurrentWaterMark').output.firstRow.NewWatermarkValue}' OR SQLUSer.InvoiceAddress.sysModified<='@{activity('LookupCurrentWaterMark').output.firstRow.NewWatermarkValue}')) ",
									"type": "Expression"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"dataIntegrationUnits": 0
						},
						"inputs": [
							{
								"referenceName": "OdbcDataSource",
								"type": "DatasetReference"
							}
						],
						"outputs": [
							{
								"referenceName": "Landing_InvoiceAddressDataset",
								"type": "DatasetReference"
							}
						]
					},
					{
						"name": "UpdateWaterMark",
						"description": "Stored procedure activity to store the new high-watermark value into external control table for delta data loading. ",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 2').output.firstRow.RunEnd2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate Landing_Invoice Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[LandingTablesTruncate_InvoiceAddress]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1_Landing Linked Service",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Delete Modified Records",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[InvoiceAddress_Delete]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Test_2_Insert",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Delete Modified Records",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[InvoiceAddress_Insert]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "UpdateWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LookupDeltaOffset",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DATEADD(dd,-[DeltaOffset (Days)],[ETL Last Run End]) AS DeltaOffset\nFROM ca.Control_Table\nWHERE Entity='Invoice' AND\n             [Group]=10",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 1').output.firstRow.RunStart1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set Run End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 1').output.firstRow.RunEnd1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set Run Start 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 2').output.firstRow.RunStart2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 1",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run End 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "DeltaCopyfromDB",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run Start 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run End 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Test_2_Insert",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					}
				],
				"parameters": {
					"Data_Source_Table_Name": {
						"type": "String",
						"defaultValue": "SQLUser.InvoiceAddress"
					},
					"Data_Source_WaterMarkColumn": {
						"type": "String",
						"defaultValue": "sysModified"
					},
					"Data_Destination_Container": {
						"type": "String",
						"defaultValue": "rd.InvoiceAddress"
					},
					"Data_Destination_Directory": {
						"type": "String"
					},
					"Control_Table_Table_Name": {
						"type": "String",
						"defaultValue": "watermark_table"
					},
					"Control_Table_Column_Name": {
						"type": "String",
						"defaultValue": "Invoicewatermark_value"
					},
					"Data_Source_WaterMarkColumn_modified": {
						"type": "string",
						"defaultValue": "SQLUser.InvoiceAddress.sysModified"
					},
					"DeltaOffset": {
						"type": "int",
						"defaultValue": -1
					},
					"ControlTable_Entity": {
						"type": "string",
						"defaultValue": "InvoiceAddress"
					},
					"ControlTable_Group1": {
						"type": "int",
						"defaultValue": 10
					},
					"ControlTable_Group2": {
						"type": "int",
						"defaultValue": 20
					},
					"ETLBeginTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run Start"
					},
					"ETLEndTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run End"
					},
					"Data_Source_Table_Name2": {
						"type": "string",
						"defaultValue": "SQLUser.Invoice"
					},
					"Data_Source2_WaterMarkColumn": {
						"type": "string",
						"defaultValue": "SQLUser.Invoice.sysModified"
					}
				},
				"variables": {
					"Run Start 1": {
						"type": "String"
					},
					"Run Start 2": {
						"type": "String"
					},
					"Run End 1": {
						"type": "String"
					},
					"Run End 2": {
						"type": "String"
					}
				},
				"annotations": [],
				"lastPublishTime": "2021-06-08T23:54:11Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Landing_watermarktableDataset')]",
				"[concat(variables('factoryId'), '/datasets/ControlTableDataset')]",
				"[concat(variables('factoryId'), '/datasets/OdbcDataSource')]",
				"[concat(variables('factoryId'), '/datasets/Landing_InvoiceAddressDataset')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/InvoiceMisc_CachetoODS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Copy new or updated rows only from database using external control table",
				"activities": [
					{
						"name": "LookupLastWaterMark",
						"description": "Retrieve the last high-watermark value stored in external control table",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Landing_watermarktableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "LookupCurrentWaterMark",
						"description": "Retrieve  the current maximum value in watermark column of source data store",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DATEADD(dd,0,[ETL Last Run Start]) as NewWatermarkValue\nFROM ca.Control_Table\nWHERE [Group]=10 AND Entity='Invoice'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "DeltaCopyfromDB",
						"description": "Copy activity to use query to filter the delta data by > last high-watermark and <= current high-watermark from source database, and then only copy the changes to the destination store.",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LookupCurrentWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "LookupLastWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Truncate Landing_Invoice Procedure",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "LookupDeltaOffset",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource",
								"query": {
									"value": "select   SQLUser.InvoiceMisc.ID      ,SQLUser.InvoiceMisc.TripNo      ,SQLUser.InvoiceMisc.Comment     ,SQLUser.InvoiceMisc.SubmittedDate     ,SQLUser.InvoiceMisc.SubmittedTime      ,SQLUser.InvoiceMisc.SubmittedUser     ,SQLUser.InvoiceMisc.CreditedDate     ,SQLUser.InvoiceMisc.CreditedTime     ,SQLUser.InvoiceMisc.CreditedUser      ,SQLUser.InvoiceMisc.InvoicePaymentRef      ,SQLUser.InvoiceMisc.UserVerified     ,SQLUser.InvoiceMisc.DateVerified     ,SQLUser.InvoiceMisc.TimeVerified      ,SQLUser.InvoiceMisc.CommissionCode      ,SQLUser.InvoiceMisc.EDIFormat      ,SQLUser.InvoiceMisc.InvoiceModelDateStamp   ,SQLUser.InvoiceMisc.InvoiceModelLineTimeStamp      ,SQLUser.InvoiceMisc.InvoiceModelInvoiceCode     ,SQLUser.InvoiceMisc.InvoiceModelCode   ,SQLUser.InvoiceMisc.BranchCode     ,SQLUser.InvoiceMisc.sysCreated    ,SQLUser.InvoiceMisc.sysModified     ,SQLUser.InvoiceMisc.DateCreated      ,SQLUser.InvoiceMisc.DateModified     ,SQLUser.InvoiceMisc.DateStamp      ,SQLUser.InvoiceMisc.GLCostCr      ,SQLUser.InvoiceMisc.GLCostDb      ,SQLUser.InvoiceMisc.GLRevenue      ,SQLUser.InvoiceMisc.InPackage     ,SQLUser.InvoiceMisc.InvoiceCode      ,SQLUser.InvoiceMisc.LineTimeStamp      ,SQLUser.InvoiceMisc.MiscCode      ,SQLUser.InvoiceMisc.MiscDesc     ,SQLUser.InvoiceMisc.Qty     ,SQLUser.InvoiceMisc.SellingPrice      ,SQLUser.InvoiceMisc.Tax1     ,SQLUser.InvoiceMisc.Tax2     ,SQLUser.InvoiceMisc.Tax3     ,SQLUser.InvoiceMisc.Total     ,SQLUser.InvoiceMisc.UnitCost     ,SQLUser.InvoiceMisc.UpdateHistory     ,SQLUser.InvoiceMisc.UserCreated      ,SQLUser.InvoiceMisc.UserModified     ,SQLUser.InvoiceMisc.Warranty\n      \nfrom \nSQLUser.InvoiceMisc INNER JOIN SQLUser.Invoice ON InvoiceCode=SQLUser.Invoice.Code\nwhere (@{pipeline().parameters.Data_Source2_WaterMarkColumn} > '@{activity('LookupDeltaOffset').output.firstRow.DeltaOffset}' OR (SQLUser.InvoiceMisc.sysCreated>'@{activity('LookupDeltaOffset').output.firstRow.DeltaOffset}' OR SQLUser.InvoiceMisc.sysModified>'@{activity('LookupDeltaOffset').output.firstRow.DeltaOffset}')) and (@{pipeline().parameters.Data_Source2_WaterMarkColumn} <= '@{activity('LookupCurrentWaterMark').output.firstRow.NewWatermarkValue}' OR \n(SQLUser.InvoiceMisc.sysCreated<='@{activity('LookupCurrentWaterMark').output.firstRow.NewWatermarkValue}' OR SQLUSer.InvoiceMisc.sysModified<='@{activity('LookupCurrentWaterMark').output.firstRow.NewWatermarkValue}')) ",
									"type": "Expression"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"dataIntegrationUnits": 0
						},
						"inputs": [
							{
								"referenceName": "OdbcDataSource",
								"type": "DatasetReference"
							}
						],
						"outputs": [
							{
								"referenceName": "Landing_InvoiceMiscDataset",
								"type": "DatasetReference"
							}
						]
					},
					{
						"name": "UpdateWaterMark",
						"description": "Stored procedure activity to store the new high-watermark value into external control table for delta data loading. ",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 2').output.firstRow.RunEnd2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate Landing_Invoice Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[LandingTablesTruncate_InvoiceMisc]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1_Landing Linked Service",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Delete Records",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[InvoiceMisc_Delete]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Insert Modified Records",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Delete Records",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[InvoiceMisc_Insert]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "UpdateWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LookupDeltaOffset",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DATEADD(dd,-[DeltaOffset (Days)],[ETL Last Run End]) AS DeltaOffset\nFROM ca.Control_Table\nWHERE Entity='Invoice' AND\n             [Group]=10",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 1').output.firstRow.RunStart1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set Run End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 1').output.firstRow.RunEnd1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set Run Start 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 2').output.firstRow.RunStart2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 1",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run End 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "DeltaCopyfromDB",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run Start 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run End 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Insert Modified Records",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					}
				],
				"parameters": {
					"Data_Source_Table_Name": {
						"type": "String",
						"defaultValue": "SQLUser.InvoiceMisc"
					},
					"Data_Source_WaterMarkColumn": {
						"type": "String",
						"defaultValue": "sysModified"
					},
					"Data_Destination_Container": {
						"type": "String",
						"defaultValue": "rd.InvoiceMisc"
					},
					"Data_Destination_Directory": {
						"type": "String"
					},
					"Control_Table_Table_Name": {
						"type": "String",
						"defaultValue": "watermark_table"
					},
					"Control_Table_Column_Name": {
						"type": "String",
						"defaultValue": "Invoicewatermark_value"
					},
					"Data_Source_WaterMarkColumn_modified": {
						"type": "string",
						"defaultValue": "SQLUser.InvoiceMisc.sysModified"
					},
					"DeltaOffset": {
						"type": "int",
						"defaultValue": -2
					},
					"ControlTable_Entity": {
						"type": "string",
						"defaultValue": "InvoiceMisc"
					},
					"ControlTable_Group1": {
						"type": "int",
						"defaultValue": 10
					},
					"ControlTable_Group2": {
						"type": "int",
						"defaultValue": 20
					},
					"ETLBeginTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run Start"
					},
					"ETLEndTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run End"
					},
					"Data_Source_Table_Name2": {
						"type": "string",
						"defaultValue": "SQLUser.Invoice"
					},
					"Data_Source2_WaterMarkColumn": {
						"type": "string",
						"defaultValue": "SQLUser.Invoice.sysModified"
					}
				},
				"variables": {
					"Run Start 1": {
						"type": "String"
					},
					"Run Start 2": {
						"type": "String"
					},
					"Run End 1": {
						"type": "String"
					},
					"Run End 2": {
						"type": "String"
					}
				},
				"annotations": [],
				"lastPublishTime": "2021-06-09T05:28:17Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Landing_watermarktableDataset')]",
				"[concat(variables('factoryId'), '/datasets/ControlTableDataset')]",
				"[concat(variables('factoryId'), '/datasets/OdbcDataSource')]",
				"[concat(variables('factoryId'), '/datasets/Landing_InvoiceMiscDataset')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/InvoiceModel_CachetoODS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Copy new or updated rows only from database using external control table",
				"activities": [
					{
						"name": "LookupLastWaterMark",
						"description": "Retrieve the last high-watermark value stored in external control table",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Landing_watermarktableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "LookupCurrentWaterMark",
						"description": "Retrieve  the current maximum value in watermark column of source data store",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DATEADD(dd,0,[ETL Last Run Start]) as NewWatermarkValue\nFROM ca.Control_Table\nWHERE [Group]=10 AND Entity='Invoice'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "DeltaCopyfromDB",
						"description": "Copy activity to use query to filter the delta data by > last high-watermark and <= current high-watermark from source database, and then only copy the changes to the destination store.",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LookupCurrentWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "LookupLastWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Truncate Landing_Invoice Procedure",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "LookupDeltaOffset",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource",
								"query": {
									"value": "select         SQLUser.InvoiceModel.ID\n      ,SQLUser.InvoiceModel.TakenStatus\n      ,SQLUser.InvoiceModel.TakenDate\n      ,SQLUser.InvoiceModel.AverageCost\n      ,SQLUser.InvoiceModel.StandardCost\n      ,SQLUser.InvoiceModel.LastCost\n      ,SQLUser.InvoiceModel.Color\n      ,SQLUser.InvoiceModel.POCode\n      ,SQLUser.InvoiceModel.Reference\n      ,SQLUser.InvoiceModel.PODateStamp\n      ,SQLUser.InvoiceModel.POLineTimeStamp\n      ,SQLUser.InvoiceModel.SpecialOrderDate\n      ,SQLUser.InvoiceModel.TripNo\n      ,SQLUser.InvoiceModel.LandedCost\n      ,SQLUser.InvoiceModel.AutoBackorder\n      ,SQLUser.InvoiceModel.ManufacturersWarranty\n      ,SQLUser.InvoiceModel.ReplacementCost\n      ,SQLUser.InvoiceModel.UserVerified\n      ,SQLUser.InvoiceModel.DateVerified\n      ,SQLUser.InvoiceModel.TimeVerified\n      ,SQLUser.InvoiceModel.OriginalCost\n      ,SQLUser.InvoiceModel.ReserveExclusive\n      ,SQLUser.InvoiceModel.CommissionCode\n      ,SQLUser.InvoiceModel.EDIFormat\n      ,SQLUser.InvoiceModel.BranchCode\n      ,SQLUser.InvoiceModel.sysCreated\n      ,SQLUser.InvoiceModel.sysModified\n      ,SQLUser.InvoiceModel.DateCreated\n      ,SQLUser.InvoiceModel.DateModified\n      ,SQLUser.InvoiceModel.DateStamp\n      ,SQLUser.InvoiceModel.InPackage\n      ,SQLUser.InvoiceModel.InvoiceCode\n      ,SQLUser.InvoiceModel.LineTimeStamp\n      ,SQLUser.InvoiceModel.LocationCode\n      ,SQLUser.InvoiceModel.ModelCode\n      ,SQLUser.InvoiceModel.ModelDesc\n      ,SQLUser.InvoiceModel.NewUsed\n      ,SQLUser.InvoiceModel.QtyOrdered\n      ,SQLUser.InvoiceModel.QtyReserved\n      ,SQLUser.InvoiceModel.QtyShipped\n      ,SQLUser.InvoiceModel.SellingPrice\n      ,SQLUser.InvoiceModel.Spiff\n      ,SQLUser.InvoiceModel.Status\n      ,SQLUser.InvoiceModel.Tax1\n      ,SQLUser.InvoiceModel.Tax1CostList\n      ,SQLUser.InvoiceModel.Tax1Included\n      ,SQLUser.InvoiceModel.Tax1Percentage\n      ,SQLUser.InvoiceModel.Tax2\n      ,SQLUser.InvoiceModel.Tax3\n      ,SQLUser.InvoiceModel.Total\n      ,SQLUser.InvoiceModel.UserCreated\n      ,SQLUser.InvoiceModel.UserModified\n      \nfrom \nSQLUser.InvoiceModel INNER JOIN SQLUser.Invoice ON InvoiceCode=SQLUser.Invoice.Code\nwhere (@{pipeline().parameters.Data_Source2_WaterMarkColumn} > '@{activity('LookupDeltaOffset').output.firstRow.DeltaOffset}' OR (SQLUser.InvoiceModel.sysCreated>'@{activity('LookupDeltaOffset').output.firstRow.DeltaOffset}' OR SQLUser.InvoiceModel.sysModified>'@{activity('LookupDeltaOffset').output.firstRow.DeltaOffset}')) and (@{pipeline().parameters.Data_Source2_WaterMarkColumn} <= '@{activity('LookupCurrentWaterMark').output.firstRow.NewWatermarkValue}' OR \n(SQLUser.InvoiceModel.sysCreated<='@{activity('LookupCurrentWaterMark').output.firstRow.NewWatermarkValue}' OR SQLUSer.InvoiceModel.sysModified<='@{activity('LookupCurrentWaterMark').output.firstRow.NewWatermarkValue}')) ",
									"type": "Expression"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"dataIntegrationUnits": 0
						},
						"inputs": [
							{
								"referenceName": "OdbcDataSource",
								"type": "DatasetReference"
							}
						],
						"outputs": [
							{
								"referenceName": "Landing_InvoiceModelDataset",
								"type": "DatasetReference"
							}
						]
					},
					{
						"name": "UpdateWaterMark",
						"description": "Stored procedure activity to store the new high-watermark value into external control table for delta data loading. ",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 2').output.firstRow.RunEnd2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate Landing_Invoice Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[LandingTablesTruncate_InvoiceModel]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1_Landing Linked Service",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Delete Records",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[InvoiceModel_Delete]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Insert Modified Records",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Delete Records",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[InvoiceModel_Insert]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "UpdateWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LookupDeltaOffset",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DATEADD(dd,-[DeltaOffset (Days)],[ETL Last Run End]) AS DeltaOffset\nFROM ca.Control_Table\nWHERE Entity='Invoice' AND\n             [Group]=10",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 1').output.firstRow.RunStart1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set Run End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 1').output.firstRow.RunEnd1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set Run Start 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 2').output.firstRow.RunStart2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 1",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run End 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "DeltaCopyfromDB",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run Start 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run End 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Insert Modified Records",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					}
				],
				"parameters": {
					"Data_Source_Table_Name": {
						"type": "String",
						"defaultValue": "SQLUser.InvoiceModel"
					},
					"Data_Source_WaterMarkColumn": {
						"type": "String",
						"defaultValue": "SQLUser.InvoiceModel.sysModified"
					},
					"Data_Destination_Container": {
						"type": "String",
						"defaultValue": "rd.InvoiceModel"
					},
					"Data_Destination_Directory": {
						"type": "String"
					},
					"Control_Table_Table_Name": {
						"type": "String",
						"defaultValue": "watermark_table"
					},
					"Control_Table_Column_Name": {
						"type": "String",
						"defaultValue": "Invoicewatermark_value"
					},
					"Data_Source_WaterMarkColumn_modified": {
						"type": "string",
						"defaultValue": "SQLUser.InvoiceModel.sysModified"
					},
					"DeltaOffset": {
						"type": "int",
						"defaultValue": -1
					},
					"ControlTable_Entity": {
						"type": "string",
						"defaultValue": "InvoiceModel"
					},
					"ControlTable_Group1": {
						"type": "int",
						"defaultValue": 10
					},
					"ControlTable_Group2": {
						"type": "int",
						"defaultValue": 20
					},
					"ETLBeginTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run Start"
					},
					"ETLEndTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run End"
					},
					"Data_Source_Table_Name2": {
						"type": "string",
						"defaultValue": "SQLUser.Invoice"
					},
					"Data_Source2_WaterMarkColumn": {
						"type": "string",
						"defaultValue": "SQLUser.Invoice.sysModified"
					},
					"Data_Source2_WaterMarkColumn2": {
						"type": "string",
						"defaultValue": "SQLUser.Invoice.sysCreated"
					}
				},
				"variables": {
					"Run Start 1": {
						"type": "String"
					},
					"Run Start 2": {
						"type": "String"
					},
					"Run End 1": {
						"type": "String"
					},
					"Run End 2": {
						"type": "String"
					}
				},
				"annotations": [],
				"lastPublishTime": "2021-06-10T23:02:16Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Landing_watermarktableDataset')]",
				"[concat(variables('factoryId'), '/datasets/ControlTableDataset')]",
				"[concat(variables('factoryId'), '/datasets/OdbcDataSource')]",
				"[concat(variables('factoryId'), '/datasets/Landing_InvoiceModelDataset')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/InvoicePayment_CachetoODS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Copy new or updated rows only from database using external control table",
				"activities": [
					{
						"name": "LookupLastWaterMark",
						"description": "Retrieve the last high-watermark value stored in external control table",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Landing_watermarktableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "LookupCurrentWaterMark",
						"description": "Retrieve  the current maximum value in watermark column of source data store",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DATEADD(dd,0,[ETL Last Run Start]) as NewWatermarkValue\nFROM ca.Control_Table\nWHERE [Group]=10 AND Entity='Invoice'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "DeltaCopyfromDB",
						"description": "Copy activity to use query to filter the delta data by > last high-watermark and <= current high-watermark from source database, and then only copy the changes to the destination store.",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LookupCurrentWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "LookupLastWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Truncate Landing_Invoice Procedure",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "LookupDeltaOffset",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource",
								"query": {
									"value": "select               SQLuser.InvoicePayment.ID\n      ,SQLuser.InvoicePayment.TripNo\n      ,SQLuser.InvoicePayment.CashedOut\n      ,SQLuser.InvoicePayment.CashOutUser\n      ,SQLuser.InvoicePayment.CashOutDateStamp\n      ,SQLuser.InvoicePayment.CashOutTimeStamp\n      ,SQLuser.InvoicePayment.TerminalCode\n      ,SQLuser.InvoicePayment.PayerIdentifier\n      ,SQLuser.InvoicePayment.SPAN\n      ,SQLuser.InvoicePayment.PayerDataManagedUntilDate\n      ,SQLuser.InvoicePayment.CardBrand\n      ,SQLuser.InvoicePayment.EntryMethod\n      ,SQLuser.InvoicePayment.InvoicePaymentRef\n      ,SQLuser.InvoicePayment.PayerIdType\n      ,SQLuser.InvoicePayment.sysCreated\n      ,SQLuser.InvoicePayment.sysModified\n      ,SQLuser.InvoicePayment.BankTransactionID\n      ,SQLuser.InvoicePayment.Amount\n      ,SQLuser.InvoicePayment.AuthCode\n      ,SQLuser.InvoicePayment.AuthStatus\n      ,SQLuser.InvoicePayment.BranchCode\n      ,SQLuser.InvoicePayment.CardNumber\n      ,SQLuser.InvoicePayment.DateCreated\n      ,SQLuser.InvoicePayment.DateModified\n      ,SQLuser.InvoicePayment.DateStamp\n      ,SQLuser.InvoicePayment.Description\n      ,SQLuser.InvoicePayment.ExpiryDate\n      ,SQLuser.InvoicePayment.InvoiceCode\n      ,SQLuser.InvoicePayment.LineTimeStamp\n      ,SQLuser.InvoicePayment.PaymentTypeCode\n      ,SQLuser.InvoicePayment.PostDate\n      ,SQLuser.InvoicePayment.RespBankText\n      ,SQLuser.InvoicePayment.RespBatchNo\n      ,SQLuser.InvoicePayment.RespDate\n      ,SQLuser.InvoicePayment.RespItemNo\n      ,SQLuser.InvoicePayment.RespRefNo\n      ,SQLuser.InvoicePayment.RespSettlementAmount\n      ,SQLuser.InvoicePayment.RespTime\n      ,SQLuser.InvoicePayment.Status\n      ,SQLuser.InvoicePayment.UserCreated\n      ,SQLuser.InvoicePayment.UserModified\nfrom \nSQLUser.InvoicePayment INNER JOIN SQLUser.Invoice ON InvoiceCode=SQLUser.Invoice.Code\nwhere (@{pipeline().parameters.Data_Source2_WaterMarkColumn} > '@{activity('LookupDeltaOffset').output.firstRow.DeltaOffset}' OR (SQLUser.InvoicePayment.sysCreated>'@{activity('LookupDeltaOffset').output.firstRow.DeltaOffset}' OR SQLUser.InvoicePayment.sysModified>'@{activity('LookupDeltaOffset').output.firstRow.DeltaOffset}')) and (@{pipeline().parameters.Data_Source2_WaterMarkColumn} <= '@{activity('LookupCurrentWaterMark').output.firstRow.NewWatermarkValue}' OR \n(SQLUser.InvoicePayment.sysCreated<='@{activity('LookupCurrentWaterMark').output.firstRow.NewWatermarkValue}' OR SQLUSer.InvoicePayment.sysModified<='@{activity('LookupCurrentWaterMark').output.firstRow.NewWatermarkValue}')) ",
									"type": "Expression"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"dataIntegrationUnits": 0
						},
						"inputs": [
							{
								"referenceName": "OdbcDataSource",
								"type": "DatasetReference"
							}
						],
						"outputs": [
							{
								"referenceName": "Landing_InvoicePaymentDataset",
								"type": "DatasetReference"
							}
						]
					},
					{
						"name": "UpdateWaterMark",
						"description": "Stored procedure activity to store the new high-watermark value into external control table for delta data loading. ",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 2').output.firstRow.RunEnd2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate Landing_Invoice Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[LandingTablesTruncate_InvoicePayment]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1_Landing Linked Service",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Delete Modified Records",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[InvoicePayment_Delete]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Insert",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Delete Modified Records",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[InvoicePayment_Insert]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "UpdateWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LookupDeltaOffset",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DATEADD(dd,-[DeltaOffset (Days)],[ETL Last Run End]) AS DeltaOffset\nFROM ca.Control_Table\nWHERE Entity='Invoice' AND\n             [Group]=10",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 1').output.firstRow.RunStart1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set Run End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 1').output.firstRow.RunEnd1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set Run Start 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 2').output.firstRow.RunStart2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 1",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run End 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "DeltaCopyfromDB",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run Start 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run End 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Insert",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					}
				],
				"parameters": {
					"Data_Source_Table_Name": {
						"type": "String",
						"defaultValue": "SQLUser.InvoicePayment"
					},
					"Data_Source_WaterMarkColumn": {
						"type": "String",
						"defaultValue": "sysModified"
					},
					"Data_Destination_Container": {
						"type": "String",
						"defaultValue": "rd.InvoicePayment"
					},
					"Data_Destination_Directory": {
						"type": "String"
					},
					"Control_Table_Table_Name": {
						"type": "String",
						"defaultValue": "watermark_table"
					},
					"Control_Table_Column_Name": {
						"type": "String",
						"defaultValue": "Invoicewatermark_value"
					},
					"Data_Source_WaterMarkColumn_modified": {
						"type": "string",
						"defaultValue": "SQLUser.InvoicePayment.sysModified"
					},
					"DeltaOffset": {
						"type": "int",
						"defaultValue": -1
					},
					"ControlTable_Entity": {
						"type": "string",
						"defaultValue": "InvoicePayment"
					},
					"ControlTable_Group1": {
						"type": "int",
						"defaultValue": 10
					},
					"ControlTable_Group2": {
						"type": "int",
						"defaultValue": 20
					},
					"ETLBeginTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run Start"
					},
					"ETLEndTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run End"
					},
					"Data_Source_Table_Name2": {
						"type": "string",
						"defaultValue": "SQLUser.Invoice"
					},
					"Data_Source2_WaterMarkColumn": {
						"type": "string",
						"defaultValue": "SQLUser.Invoice.sysModified"
					},
					"Data_Source2_WaterMarkColumn2": {
						"type": "string",
						"defaultValue": "SQLUser.InvoicePayment.sysCreated"
					}
				},
				"variables": {
					"Run Start 1": {
						"type": "String"
					},
					"Run Start 2": {
						"type": "String"
					},
					"Run End 1": {
						"type": "String"
					},
					"Run End 2": {
						"type": "String"
					}
				},
				"annotations": [],
				"lastPublishTime": "2021-06-09T05:30:21Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Landing_watermarktableDataset')]",
				"[concat(variables('factoryId'), '/datasets/ControlTableDataset')]",
				"[concat(variables('factoryId'), '/datasets/OdbcDataSource')]",
				"[concat(variables('factoryId'), '/datasets/Landing_InvoicePaymentDataset')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/InvoiceSerial_CachetoODS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Copy new or updated rows only from database using external control table",
				"activities": [
					{
						"name": "LookupLastWaterMark",
						"description": "Retrieve the last high-watermark value stored in external control table",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Landing_watermarktableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "LookupCurrentWaterMark",
						"description": "Retrieve  the current maximum value in watermark column of source data store",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DATEADD(dd,0,[ETL Last Run Start]) as NewWatermarkValue\nFROM ca.Control_Table\nWHERE [Group]=10 AND Entity='Invoice'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "DeltaCopyfromDB",
						"description": "Copy activity to use query to filter the delta data by > last high-watermark and <= current high-watermark from source database, and then only copy the changes to the destination store.",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LookupCurrentWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "LookupLastWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Truncate Landing_Invoice Procedure",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "LookupDeltaOffset",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource",
								"query": {
									"value": "select               SQLUser.InvoiceSerial.ID\n      ,SQLUser.InvoiceSerial.TakenLocationCode\n      ,SQLUser.InvoiceSerial.ReturnReasonCode\n      ,SQLUser.InvoiceSerial.ReturnOutcomeCode\n      ,SQLUser.InvoiceSerial.ReturnInitiatedByCode\n      ,SQLUser.InvoiceSerial.sysCreated\n      ,SQLUser.InvoiceSerial.sysModified\n      ,SQLUser.InvoiceSerial.DateCommitted\n      ,SQLUser.InvoiceSerial.DateCreated\n      ,SQLUser.InvoiceSerial.DateModified\n      ,SQLUser.InvoiceSerial.InvoiceCode\n      ,SQLUser.InvoiceSerial.LocationCode\n      ,SQLUser.InvoiceSerial.ModelCode\n      ,SQLUser.InvoiceSerial.ModelDateStamp\n      ,SQLUser.InvoiceSerial.ModelLineTimeStamp\n      ,SQLUser.InvoiceSerial.Returned\n      ,SQLUser.InvoiceSerial.SerialCode\n      ,SQLUser.InvoiceSerial.Status\n      ,SQLUser.InvoiceSerial.Taken\n      ,SQLUser.InvoiceSerial.TakenDate\n      ,SQLUser.InvoiceSerial.TakenStatus\n      ,SQLUser.InvoiceSerial.UnitCost\n      ,SQLUser.InvoiceSerial.UserCreated\n      ,SQLUser.InvoiceSerial.UserModified\n      \nfrom \nSQLUser.InvoiceSerial INNER JOIN SQLUser.Invoice ON InvoiceCode=SQLUser.Invoice.Code\nwhere (@{pipeline().parameters.Data_Source2_WaterMarkColumn} > '@{activity('LookupDeltaOffset').output.firstRow.DeltaOffset}' OR (SQLUser.InvoiceSerial.sysCreated>'@{activity('LookupDeltaOffset').output.firstRow.DeltaOffset}' OR SQLUser.InvoiceSerial.sysModified>'@{activity('LookupDeltaOffset').output.firstRow.DeltaOffset}')) and (@{pipeline().parameters.Data_Source2_WaterMarkColumn} <= '@{activity('LookupCurrentWaterMark').output.firstRow.NewWatermarkValue}' OR \n(SQLUser.InvoiceSerial.sysCreated<='@{activity('LookupCurrentWaterMark').output.firstRow.NewWatermarkValue}' OR SQLUSer.InvoiceSerial.sysModified<='@{activity('LookupCurrentWaterMark').output.firstRow.NewWatermarkValue}'))",
									"type": "Expression"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"dataIntegrationUnits": 0
						},
						"inputs": [
							{
								"referenceName": "OdbcDataSource",
								"type": "DatasetReference"
							}
						],
						"outputs": [
							{
								"referenceName": "Landing_InvoiceSerialDataset",
								"type": "DatasetReference"
							}
						]
					},
					{
						"name": "UpdateWaterMark",
						"description": "Stored procedure activity to store the new high-watermark value into external control table for delta data loading. ",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 2').output.firstRow.RunEnd2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate Landing_Invoice Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[LandingTablesTruncate_InvoiceSerial]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1_Landing Linked Service",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Delete Records",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[InvoiceSerial_Delete]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Insert Modified Records",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Delete Records",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[InvoiceSerial_Insert]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "UpdateWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LookupDeltaOffset",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DATEADD(dd,-[DeltaOffset (Days)],[ETL Last Run End]) AS DeltaOffset\nFROM ca.Control_Table\nWHERE Entity='Invoice' AND\n             [Group]=10",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 1').output.firstRow.RunStart1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set Run End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 1').output.firstRow.RunEnd1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set Run Start 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 2').output.firstRow.RunStart2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 1",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run End 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "DeltaCopyfromDB",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run Start 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run End 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Insert Modified Records",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					}
				],
				"parameters": {
					"Data_Source_Table_Name": {
						"type": "String",
						"defaultValue": "SQLUser.InvoiceSerial"
					},
					"Data_Source_WaterMarkColumn": {
						"type": "String",
						"defaultValue": "sysModified"
					},
					"Data_Destination_Container": {
						"type": "String",
						"defaultValue": "rd.InvoiceSerial"
					},
					"Data_Destination_Directory": {
						"type": "String"
					},
					"Control_Table_Table_Name": {
						"type": "String",
						"defaultValue": "watermark_table"
					},
					"Control_Table_Column_Name": {
						"type": "String",
						"defaultValue": "Invoicewatermark_value"
					},
					"Data_Source_WaterMarkColumn_modified": {
						"type": "string",
						"defaultValue": "SQLUser.InvoiceSerial.sysModified"
					},
					"DeltaOffset": {
						"type": "int",
						"defaultValue": -1
					},
					"ControlTable_Entity": {
						"type": "string",
						"defaultValue": "InvoiceSerial"
					},
					"ControlTable_Group1": {
						"type": "int",
						"defaultValue": 10
					},
					"ControlTable_Group2": {
						"type": "int",
						"defaultValue": 20
					},
					"ETLBeginTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run Start"
					},
					"ETLEndTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run End"
					},
					"Data_Source_Table_Name2": {
						"type": "string",
						"defaultValue": "SQLUser.Invoice"
					},
					"Data_Source2_WaterMarkColumn": {
						"type": "string",
						"defaultValue": "SQLUser.Invoice.sysModified"
					},
					"Data_Source2_WaterMarkColumn2": {
						"type": "string",
						"defaultValue": "SQLUser.InvoiceSerial.sysCreated"
					}
				},
				"variables": {
					"Run Start 1": {
						"type": "String"
					},
					"Run Start 2": {
						"type": "String"
					},
					"Run End 1": {
						"type": "String"
					},
					"Run End 2": {
						"type": "String"
					}
				},
				"annotations": [],
				"lastPublishTime": "2021-06-09T05:30:21Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Landing_watermarktableDataset')]",
				"[concat(variables('factoryId'), '/datasets/ControlTableDataset')]",
				"[concat(variables('factoryId'), '/datasets/OdbcDataSource')]",
				"[concat(variables('factoryId'), '/datasets/Landing_InvoiceSerialDataset')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/InvoiceWarranty_CachetoODS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Copy new or updated rows only from database using external control table",
				"activities": [
					{
						"name": "LookupLastWaterMark",
						"description": "Retrieve the last high-watermark value stored in external control table",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Landing_watermarktableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "LookupCurrentWaterMark",
						"description": "Retrieve  the current maximum value in watermark column of source data store",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DATEADD(dd,0,[ETL Last Run Start]) as NewWatermarkValue\nFROM ca.Control_Table\nWHERE [Group]=10 AND Entity='Invoice'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "DeltaCopyfromDB",
						"description": "Copy activity to use query to filter the delta data by > last high-watermark and <= current high-watermark from source database, and then only copy the changes to the destination store.",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LookupCurrentWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "LookupLastWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Truncate Landing_Invoice Procedure",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "LookupDeltaOffset",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource",
								"query": {
									"value": "select         SQLUser.InvoiceWarranty.ID\n      ,SQLUser.InvoiceWarranty.TripNo\n      ,SQLUser.InvoiceWarranty.Acknowledged\n      ,SQLUser.InvoiceWarranty.DateAcknowledged\n      ,SQLUser.InvoiceWarranty.OrgModSelPrice\n      ,SQLUser.InvoiceWarranty.CheckException\n      ,SQLUser.InvoiceWarranty.UserVerified\n      ,SQLUser.InvoiceWarranty.DateVerified\n      ,SQLUser.InvoiceWarranty.TimeVerified\n      ,SQLUser.InvoiceWarranty.CommissionCode\n      ,SQLUser.InvoiceWarranty.BranchCode\n      ,SQLUser.InvoiceWarranty.sysCreated\n      ,SQLUser.InvoiceWarranty.sysModified\n      ,SQLUser.InvoiceWarranty.Commission\n      ,SQLUser.InvoiceWarranty.ContractNumber\n      ,SQLUser.InvoiceWarranty.DateCreated\n      ,SQLUser.InvoiceWarranty.DateModified\n      ,SQLUser.InvoiceWarranty.DateStamp\n      ,SQLUser.InvoiceWarranty.EndDate\n      ,SQLUser.InvoiceWarranty.ExtWarrantyCode\n      ,SQLUser.InvoiceWarranty.ExtWarrantyDesc\n      ,SQLUser.InvoiceWarranty.GLCostCr\n      ,SQLUser.InvoiceWarranty.GLCostDb\n      ,SQLUser.InvoiceWarranty.GLRevenue\n      ,SQLUser.InvoiceWarranty.InPackage\n      ,SQLUser.InvoiceWarranty.InvoiceCode\n      ,SQLUser.InvoiceWarranty.LineTimeStamp\n      ,SQLUser.InvoiceWarranty.Model\n      ,SQLUser.InvoiceWarranty.SellingPrice\n      ,SQLUser.InvoiceWarranty.Serial\n      ,SQLUser.InvoiceWarranty.StartDate\n      ,SQLUser.InvoiceWarranty.Tax1\n      ,SQLUser.InvoiceWarranty.Tax2\n      ,SQLUser.InvoiceWarranty.Tax3\n      ,SQLUser.InvoiceWarranty.UnitCost\n      ,SQLUser.InvoiceWarranty.UserCreated\n      ,SQLUser.InvoiceWarranty.UserModified\nfrom \nSQLUser.InvoiceWarranty INNER JOIN SQLUser.Invoice ON InvoiceCode=SQLUser.Invoice.Code\nwhere (@{pipeline().parameters.Data_Source2_WaterMarkColumn} > '@{activity('LookupDeltaOffset').output.firstRow.DeltaOffset}' OR (SQLUser.InvoiceWarranty.sysCreated>'@{activity('LookupDeltaOffset').output.firstRow.DeltaOffset}' OR SQLUser.InvoiceWarranty.sysModified>'@{activity('LookupDeltaOffset').output.firstRow.DeltaOffset}')) and (@{pipeline().parameters.Data_Source2_WaterMarkColumn} <= '@{activity('LookupCurrentWaterMark').output.firstRow.NewWatermarkValue}' OR \n(SQLUser.InvoiceWarranty.sysCreated<='@{activity('LookupCurrentWaterMark').output.firstRow.NewWatermarkValue}' OR SQLUSer.InvoiceWarranty.sysModified<='@{activity('LookupCurrentWaterMark').output.firstRow.NewWatermarkValue}'))\n",
									"type": "Expression"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"dataIntegrationUnits": 0
						},
						"inputs": [
							{
								"referenceName": "OdbcDataSource",
								"type": "DatasetReference"
							}
						],
						"outputs": [
							{
								"referenceName": "Landing_InvoiceWarrantyDataset",
								"type": "DatasetReference"
							}
						]
					},
					{
						"name": "UpdateWaterMark",
						"description": "Stored procedure activity to store the new high-watermark value into external control table for delta data loading. ",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 2').output.firstRow.RunEnd2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate Landing_Invoice Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[LandingTablesTruncate_InvoiceWarranty]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1_Landing Linked Service",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Delete Modified Records",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[InvoiceWarranty_Delete]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Insert",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Delete Modified Records",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[InvoiceWarranty_Insert]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "UpdateWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LookupDeltaOffset",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DATEADD(dd,-[DeltaOffset (Days)],[ETL Last Run End]) AS DeltaOffset\nFROM ca.Control_Table\nWHERE Entity='Invoice' AND\n             [Group]=10",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 1').output.firstRow.RunStart1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set Run End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 1').output.firstRow.RunEnd1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set Run Start 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 2').output.firstRow.RunStart2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 1",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run End 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "DeltaCopyfromDB",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run Start 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run End 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Insert",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					}
				],
				"parameters": {
					"Data_Source_Table_Name": {
						"type": "String",
						"defaultValue": "SQLUser.InvoiceWarranty"
					},
					"Data_Source_WaterMarkColumn": {
						"type": "String",
						"defaultValue": "sysModified"
					},
					"Data_Destination_Container": {
						"type": "String",
						"defaultValue": "rd.InvoiceWarranty"
					},
					"Data_Destination_Directory": {
						"type": "String"
					},
					"Control_Table_Table_Name": {
						"type": "String",
						"defaultValue": "watermark_table"
					},
					"Control_Table_Column_Name": {
						"type": "String",
						"defaultValue": "Invoicewatermark_value"
					},
					"Data_Source_WaterMarkColumn_modified": {
						"type": "string",
						"defaultValue": "SQLUser.InvoiceWarranty.sysModified"
					},
					"DeltaOffset": {
						"type": "int",
						"defaultValue": -1
					},
					"ControlTable_Entity": {
						"type": "string",
						"defaultValue": "InvoiceWarranty"
					},
					"ControlTable_Group1": {
						"type": "int",
						"defaultValue": 10
					},
					"ControlTable_Group2": {
						"type": "int",
						"defaultValue": 20
					},
					"ETLBeginTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run Start"
					},
					"ETLEndTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run End"
					},
					"Data_Source_Table_Name2": {
						"type": "string",
						"defaultValue": "SQLUser.Invoice"
					},
					"Data_Source2_WaterMarkColumn": {
						"type": "string",
						"defaultValue": "SQLUser.Invoice.sysModified"
					},
					"Data_Source2_WaterMarkColumn2": {
						"type": "string",
						"defaultValue": "SQLUser.InvoiceWarranty.sysCreated"
					}
				},
				"variables": {
					"Run Start 1": {
						"type": "String"
					},
					"Run Start 2": {
						"type": "String"
					},
					"Run End 1": {
						"type": "String"
					},
					"Run End 2": {
						"type": "String"
					}
				},
				"annotations": [],
				"lastPublishTime": "2021-06-09T05:30:21Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Landing_watermarktableDataset')]",
				"[concat(variables('factoryId'), '/datasets/ControlTableDataset')]",
				"[concat(variables('factoryId'), '/datasets/OdbcDataSource')]",
				"[concat(variables('factoryId'), '/datasets/Landing_InvoiceWarrantyDataset')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Invoice_CachetoODS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Copy new or updated rows only from database using external control table",
				"activities": [
					{
						"name": "LookupLastWaterMark",
						"description": "Retrieve the last high-watermark value stored in external control table",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Landing_watermarktableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "LookupCurrentWaterMark",
						"description": "Retrieve  the current maximum value in watermark column of source data store",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DATEADD(dd,0,[ETL Last Run Start]) as NewWatermarkValue\nFROM ca.Control_Table\nWHERE [Group]=10 AND Entity='Invoice'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "DeltaCopyfromDB",
						"description": "Copy activity to use query to filter the delta data by > last high-watermark and <= current high-watermark from source database, and then only copy the changes to the destination store.",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LookupCurrentWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "LookupLastWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Truncate Landing_Invoice Procedure",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "LookupDeltaOffset",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource",
								"query": {
									"value": "select  ID , Financed , Void , Qualification , Priority , Tax3Percentage \n      , SvcRepairCode1 , SvcRepairCode2 , SvcRepairCode3 , SvcRepairCode4 , ContractCode , SvcContract \n      , UserFinished , UserPosted , UpdateHistoryWarranty , ShipMethod , TimeCreated , TimeModified , TimeFinished \n      , DispatchUnits , EDIDateStamp , EDITimeStamp , PrintMethod , DispatchStartTime , TripChargeCode \n      , TripChargeAmount \n      , Locked \n      , MobileTechInvoiceCode \n      , ServiceRequestID \n      , CarrierCode \n      , ShipViaCode \n      , JobStatusUpdate \n      , DispatchEmail \n      , LastDateSaved \n      , LastTimeSaved \n      , Terms \n      , SvcEquipmentNumber \n      , WebOrderID \n      , Department \n      , CreditStatusCode \n      , CreditApprovedUserCode \n      , CreditApprovedDateStamp \n      , CreditApprovedTimeStamp \n      , EDIMaroline \n      , RequestedDate \n      , SvcCSRInvoice \n      , SvcSoldList \n      , SvcSoldSTDCost \n      , SvcFollowUpDate \n      , SvcScheduleDate \n      , Tax2MaxAmount \n      , EDIWhirlpool \n      , MinDepositPercent \n      , UnitModifier \n      , DateFinished \n      , DatePosted \n      , TimePosted \n      , TTRTaxCalculated \n      , PickUpBranchCode \n      , PodiumOptOut \n      , SignCustmizedFields \n      , AVBSaleDateSent \n      , AVBSaleTimeSent \n      , sysCreated \n      , sysModified \n      , TTRJurisdictionCode \n      , BranchCode \n      , COGSPosted \n      , CallSequence \n      , Code \n      , CommittedPaymentTotal \n      , DateCreated \n      , DateModified \n      , DispatchPriority \n      , DispatchRequestedRouteCode \n      , DispatchSpecRequest \n      , DispatchTime \n      , DispatchTimeAM \n      , Estimate \n      , Field1 \n      , Field2 \n      , Field3 \n      , Field4 \n      , Field5 \n      , InvFinishDate \n      , InvStartDate \n      , InvTypeCode \n      , ItemListPriceCode \n      , ItemTotal \n      , JobLocation \n      , JobNumber \n      , JobStatusCode \n      , LaborRate \n      , LaborTotal \n      , MapReference \n      , MapZoneCode \n      , MiscTotal \n      , OpenPaymentTotal \n      , OtherListPriceCode \n      , PONumber \n      , PaymentTypeCode \n      , PickUpDate \n      , Reference \n      , SaleReferralCode \n      , Salesperson1Code \n      , Salesperson2Code \n      , Salesperson2Percentage \n      , ScheduleDate \n      , SerialListPriceCode \n      , SerialTotal \n      , Status \n      , SvcAgreementExpDate \n      , SvcAgreementNumber \n      , SvcBrandCode \n      , SvcCenter \n      , SvcCenterNumber \n      , SvcComplaintCode \n      , SvcComplaintDesc \n      , SvcDatePurchased \n      , SvcDealerCode \n      , SvcDealerDesc \n      , SvcDistributorNumber \n      , SvcInWarranty \n      , SvcMfgCodeEiaNumber \n      , SvcMicroLeak \n      , SvcMiles \n      , SvcMilesRate \n      , SvcMilesTotal \n      , SvcModel \n      , SvcMotorNewNumber \n      , SvcMotorOldNumber \n      , SvcPerformedCode \n      , SvcPerformedDesc \n      , SvcProduct \n      , SvcProductCode \n      , SvcRepairCatMinorMajor \n      , SvcRepairCategory \n      , SvcRepairCode \n      , SvcRunNumber \n      , SvcSerial \n      , SvcSpecAuthNumber \n      , SvcStockMerchandise \n      , SvcTimeCompleted1 \n      , SvcTimeCompleted2 \n      , SvcTimeOnJob1 \n      , SvcTimeOnJob2 \n      , SvcTimeStarted1 \n      , SvcTimeStarted2 \n      , Tax1Exempt \n      , Tax1Total \n      , Tax2Code \n      , Tax2Exempt \n      , Tax2Percentage \n      , Tax2Total \n      , Tax3Exempt \n      , Tax3Total \n      , UserCreated \n      , UserModified \n      , Warranty \n      , WarrantyField1 \n      , WarrantyField2 \n      , WarrantyField3 \n      , WarrantyField4 \n      , WarrantyField5 \n      , WtyTotal \nfrom \n@{pipeline().parameters.Data_Source_Table_Name} \n\t where (@{pipeline().parameters.Data_Source_WaterMarkColumn_modified} > '@{activity('LookupDeltaOffset').output.firstRow.DeltaOffset}'  OR\n@{pipeline().parameters.Data_Source_WaterMarkColumn_modified} IS NULL OR\nSQLUser.Invoice.sysCreated>'@{activity('LookupDeltaOffset').output.firstRow.DeltaOffset}')\n\t and (@{pipeline().parameters.Data_Source_WaterMarkColumn_modified} <= '@{activity('LookupCurrentWaterMark').output.firstRow.NewWatermarkValue}'  OR \nSQLUser.Invoice.sysCreated<='@{activity('LookupCurrentWaterMark').output.firstRow.NewWatermarkValue}')\n",
									"type": "Expression"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"dataIntegrationUnits": 0
						},
						"inputs": [
							{
								"referenceName": "OdbcDataSource",
								"type": "DatasetReference"
							}
						],
						"outputs": [
							{
								"referenceName": "Landing_InvoiceDataset",
								"type": "DatasetReference"
							}
						]
					},
					{
						"name": "UpdateWaterMark",
						"description": "Stored procedure activity to store the new high-watermark value into external control table for delta data loading. ",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 2').output.firstRow.RunEnd2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate Landing_Invoice Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[LandingTablesTruncate_Invoice]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1_Landing Linked Service",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Test",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Invoice_Delete]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Test_2_Insert",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Test",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Invoice_Insert]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "UpdateWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LookupDeltaOffset",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DATEADD(dd,-[DeltaOffset (Days)],[ETL Last Run End]) AS DeltaOffset\nFROM ca.Control_Table\nWHERE Entity='Invoice' AND\n             [Group]=10",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 1').output.firstRow.RunStart1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set Run End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 1').output.firstRow.RunEnd1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set Run Start 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 2').output.firstRow.RunStart2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 1",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run End 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "DeltaCopyfromDB",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run Start 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run End 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Test_2_Insert",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					}
				],
				"parameters": {
					"Data_Source_Table_Name": {
						"type": "String",
						"defaultValue": "SQLUser.Invoice"
					},
					"Data_Source_WaterMarkColumn": {
						"type": "String",
						"defaultValue": "sysModified"
					},
					"Data_Destination_Container": {
						"type": "String",
						"defaultValue": "rd.Invoice"
					},
					"Data_Destination_Directory": {
						"type": "String"
					},
					"Control_Table_Table_Name": {
						"type": "String",
						"defaultValue": "watermark_table"
					},
					"Control_Table_Column_Name": {
						"type": "String",
						"defaultValue": "Invoicewatermark_value"
					},
					"Data_Source_WaterMarkColumn_modified": {
						"type": "string",
						"defaultValue": "SQLUser.Invoice.sysModified"
					},
					"DeltaOffset": {
						"type": "int",
						"defaultValue": -1
					},
					"ControlTable_Entity": {
						"type": "string",
						"defaultValue": "Invoice"
					},
					"ControlTable_Group1": {
						"type": "int",
						"defaultValue": 10
					},
					"ControlTable_Group2": {
						"type": "int",
						"defaultValue": 20
					},
					"ETLBeginTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run Start"
					},
					"ETLEndTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run End"
					}
				},
				"variables": {
					"Run Start 1": {
						"type": "String"
					},
					"Run Start 2": {
						"type": "String"
					},
					"Run End 1": {
						"type": "String"
					},
					"Run End 2": {
						"type": "String"
					}
				},
				"annotations": [],
				"lastPublishTime": "2021-06-11T13:58:06Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Landing_watermarktableDataset')]",
				"[concat(variables('factoryId'), '/datasets/ControlTableDataset')]",
				"[concat(variables('factoryId'), '/datasets/OdbcDataSource')]",
				"[concat(variables('factoryId'), '/datasets/Landing_InvoiceDataset')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Location_Cache to ODS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CopyActivity1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate Location",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource"
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"validateDataConsistency": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataset_hdo",
								"type": "DatasetReference",
								"parameters": {
									"TableName": "SQLUser.Location"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Landing_LocationDataset",
								"type": "DatasetReference"
							}
						]
					},
					{
						"name": "Truncate Location",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[LandingTablesTruncate_Location]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1_Landing Linked Service",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Insert",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Truncate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Location_Insert]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 1').output.firstRow.RunStart1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run End 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "CopyActivity1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 1').output.firstRow.RunEnd1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 2').output.firstRow.RunStart2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run End 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Insert",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "UpdateControlTable",
						"description": "Stored procedure activity to store the new high-watermark value into external control table for delta data loading. ",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 2').output.firstRow.RunEnd2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "UpdateControlTable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[ODSLocation_Truncate]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					}
				],
				"parameters": {
					"ControlTable_Entity": {
						"type": "string",
						"defaultValue": "Location"
					},
					"ControlTable_Group1": {
						"type": "string",
						"defaultValue": "10"
					},
					"ETLBeginTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run Start"
					},
					"ETLEndTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run End"
					},
					"ControlTable_Group2": {
						"type": "string",
						"defaultValue": "20"
					}
				},
				"annotations": [],
				"lastPublishTime": "2021-06-04T14:53:36Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SourceDataset_hdo')]",
				"[concat(variables('factoryId'), '/datasets/Landing_LocationDataset')]",
				"[concat(variables('factoryId'), '/datasets/ControlTableDataset')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Misc_Cache to ODS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CopyActivity1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate Misc",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource"
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"validateDataConsistency": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataset_hdo",
								"type": "DatasetReference",
								"parameters": {
									"TableName": "SQLUser.Misc"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Landing_MiscDataset",
								"type": "DatasetReference"
							}
						]
					},
					{
						"name": "Truncate Misc",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[LandingTablesTruncate_Misc]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1_Landing Linked Service",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Insert",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Truncate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Misc_Insert]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 1').output.firstRow.RunStart1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run End 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "CopyActivity1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 1').output.firstRow.RunEnd1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 2').output.firstRow.RunStart2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run End 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Insert",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "UpdateWaterMark",
						"description": "Stored procedure activity to store the new high-watermark value into external control table for delta data loading. ",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 2').output.firstRow.RunEnd2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "UpdateWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[ODSMisc_Truncate]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					}
				],
				"parameters": {
					"ControlTable_Entity": {
						"type": "string",
						"defaultValue": "Misc"
					},
					"ControlTable_Group1": {
						"type": "string",
						"defaultValue": "10"
					},
					"ETLBeginTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run Start"
					},
					"ETLEndTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run End"
					},
					"ControlTable_Group2": {
						"type": "string",
						"defaultValue": "20"
					}
				},
				"annotations": [],
				"lastPublishTime": "2021-06-03T17:08:17Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SourceDataset_hdo')]",
				"[concat(variables('factoryId'), '/datasets/Landing_MiscDataset')]",
				"[concat(variables('factoryId'), '/datasets/ControlTableDataset')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ModelNote_Cache to ODS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CopyActivity1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate Branch",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource"
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"validateDataConsistency": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataset_hdo",
								"type": "DatasetReference",
								"parameters": {
									"TableName": "SQLUser.ModelNote"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Landing_ModelNote",
								"type": "DatasetReference"
							}
						]
					},
					{
						"name": "Truncate Branch",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[LandingTablesTruncate_ModelNote]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1_Landing Linked Service",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Insert",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Truncate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[ModelNote_Insert]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 1').output.firstRow.RunStart1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run End 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "CopyActivity1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 1').output.firstRow.RunEnd1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 2').output.firstRow.RunStart2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run End 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Insert",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "UpdateControlTable",
						"description": "Stored procedure activity to store the new high-watermark value into external control table for delta data loading. ",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 2').output.firstRow.RunEnd2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "UpdateControlTable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[ODSModelNote_Truncate]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					}
				],
				"parameters": {
					"ControlTable_Entity": {
						"type": "string",
						"defaultValue": "ModelNote"
					},
					"ControlTable_Group1": {
						"type": "string",
						"defaultValue": "10"
					},
					"ETLBeginTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run Start"
					},
					"ETLEndTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run End"
					},
					"ControlTable_Group2": {
						"type": "string",
						"defaultValue": "20"
					}
				},
				"annotations": [],
				"lastPublishTime": "2021-06-11T00:42:31Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SourceDataset_hdo')]",
				"[concat(variables('factoryId'), '/datasets/Landing_ModelNote')]",
				"[concat(variables('factoryId'), '/datasets/ControlTableDataset')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Model_CachetoODS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Copy new or updated rows only from database using external control table",
				"activities": [
					{
						"name": "LookupLastWaterMark",
						"description": "Retrieve the last high-watermark value stored in external control table",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Landing_watermarktableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "LookupCurrentWaterMark",
						"description": "Retrieve  the current maximum value in watermark column of source data store",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DATEADD(dd,0,[ETL Last Run Start]) as NewWatermarkValue\nFROM ca.Control_Table\nWHERE [Group]=10 AND Entity='Model'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "DeltaCopyfromDB",
						"description": "Copy activity to use query to filter the delta data by > last high-watermark and <= current high-watermark from source database, and then only copy the changes to the destination store.",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LookupCurrentWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "LookupLastWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Truncate Landing_Invoice Procedure",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "LookupDeltaOffset",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource",
								"query": {
									"value": "select ID\n      ,MfgBarcode\n      ,UPCBarcode\n      ,RootModelCode\n      ,PackageCode\n      ,Link\n      ,Identifier\n      ,BarcodeSchema\n      ,AllowSpecialOrder\n      ,UpdateImportPricing\n      ,WarrantyTypeCode\n      ,AllowPackageWty\n      ,ShippingMethodCode\n      ,Volume\n      ,UnloadTime\n      ,AutoNumber\n      ,ShipAnySerial\n      ,SalePrice\n      ,SaleStartDate\n      ,SaleEndDate\n      ,Feature1\n      ,Feature2\n      ,Feature3\n      ,Feature4\n      ,Feature5\n      ,Feature6\n      ,Feature7\n      ,Feature8\n      ,Feature9\n      ,Feature10\n      ,Dimension1\n      ,Dimension2\n      ,Warranty1\n      ,Warranty2\n      ,PTDesc\n      ,InstallationEstimate\n      ,UpdateImportCost\n      ,Dimension3\n      ,Misc2Code\n      ,Misc3Code\n      ,Misc4Code\n      ,Misc5Code\n      ,MiscPrompt\n      ,Misc2Prompt\n      ,Misc3Prompt\n      ,Misc4Prompt\n      ,Misc5Prompt\n      ,ExtWarrantyPrompt\n      ,ExtWarranty2Prompt\n      ,ExtWarranty3Prompt\n      ,ExtWarranty4Prompt\n      ,ExtWarranty5Prompt\n      ,ExtWarranty2Code\n      ,ExtWarranty3Code\n      ,ExtWarranty4Code\n      ,ExtWarranty5Code\n      ,Item1Prompt\n      ,Item2Prompt\n      ,Item3Prompt\n      ,Item4Prompt\n      ,Item5Prompt\n      ,Item1Code\n      ,Item2Code\n      ,Item3Code\n      ,Item4Code\n      ,Item5Code\n      ,Model1Prompt\n      ,Model2Prompt\n      ,Model3Prompt\n      ,Model4Prompt\n      ,Model5Prompt\n      ,Model1Code\n      ,Model2Code\n      ,Model3Code\n      ,Model4Code\n      ,Model5Code\n      ,ImmediateReservedDays\n      ,Spiff2\n      ,Spiff2EndDate\n      ,Spiff2StartDate\n      ,CommentPrompt\n      ,Comment2Prompt\n      ,Comment3Prompt\n      ,Comment4Prompt\n      ,Comment5Prompt\n      ,Comment2Code\n      ,Comment3Code\n      ,Comment4Code\n      ,Comment5Code\n      ,Discount1\n      ,Discount2\n      ,Discount3\n      ,Discount4\n      ,Discount5\n      ,Discount6\n      ,Discount7\n      ,Discount8\n      ,Discount9\n      ,Discount10\n      ,NotUMRP\n      ,Flooring\n      ,MasterPackQty\n      ,ABCRating\n      ,ActualSpiff\n      ,SalePrice2\n      ,SaleStartDate2\n      ,SaleEndDate2\n      ,Weight\n      ,LinqProductId\n      ,BeingDiscontinued\n      ,Active\n      ,AverageCost\n      ,Barcode\n      ,BeginYearQty\n      ,BinLocationCode\n      ,BrandCode\n      ,Code\n      ,Color\n      ,CommentCode\n      ,DateCreated\n      ,DateModified\n      ,Description\n      ,EOQ\n      ,Equivalent\n      ,ExtWarrantyCode\n      ,Field1\n      ,Field2\n      ,Field3\n      ,Field4\n      ,Field5\n      ,InventoryTypeCode\n      ,LandedCost\n      ,LandingFactor\n      ,LastCost\n      ,LastDateOrdered\n      ,LastDateReceived\n      ,LastDateSold\n      ,ListPrice\n      ,LocQOH\n      ,LocYTD\n      ,MainStockQOH\n      ,MainStockYTD\n      ,ManufacturersWarranty\n      ,MfgReturned\n      ,MiscCode\n      ,NewUsed\n      ,Note\n      ,Obsolete\n      ,OriginalCost\n      ,PicturePath\n      ,Points\n      ,PriceTag\n      ,ProductCode\n      ,ReplacementCost\n      ,ReplacementCostEffectiveDate\n      ,ResizePicture\n      ,SKU\n      ,Spiff\n      ,SpiffEndDate\n      ,SpiffStartDate\n      ,StandardCost\n      ,Stock\n      ,Substituted\n      ,SupplierCode\n      ,Tax1\n      ,Tax1CostList\n      ,Tax1Included\n      ,Tax1Percentage\n      ,Tax2\n      ,Tax3\n      ,TotalBooked\n      ,TotalLastYear\n      ,TotalMax\n      ,TotalMin\n      ,TotalNotAvailable\n      ,TotalPrevLastYear\n      ,TotalQOO\n      ,TotalReserved\n      ,UserCreated\n      ,UserModified\nfrom \n@{pipeline().parameters.Data_Source_Table_Name} \n\t where \n@{pipeline().parameters.Data_Source_WaterMarkColumn_modified} > '@{activity('LookupDeltaOffset').output.firstRow.DeltaOffset}' \n\t and @{pipeline().parameters.Data_Source_WaterMarkColumn_modified} <= '@{activity('LookupCurrentWaterMark').output.firstRow.NewWatermarkValue}' \n\nUNION\n\nselect ID\n      ,MfgBarcode\n      ,UPCBarcode\n      ,RootModelCode\n      ,PackageCode\n      ,Link\n      ,Identifier\n      ,BarcodeSchema\n      ,AllowSpecialOrder\n      ,UpdateImportPricing\n      ,WarrantyTypeCode\n      ,AllowPackageWty\n      ,ShippingMethodCode\n      ,Volume\n      ,UnloadTime\n      ,AutoNumber\n      ,ShipAnySerial\n      ,SalePrice\n      ,SaleStartDate\n      ,SaleEndDate\n      ,Feature1\n      ,Feature2\n      ,Feature3\n      ,Feature4\n      ,Feature5\n      ,Feature6\n      ,Feature7\n      ,Feature8\n      ,Feature9\n      ,Feature10\n      ,Dimension1\n      ,Dimension2\n      ,Warranty1\n      ,Warranty2\n      ,PTDesc\n      ,InstallationEstimate\n      ,UpdateImportCost\n      ,Dimension3\n      ,Misc2Code\n      ,Misc3Code\n      ,Misc4Code\n      ,Misc5Code\n      ,MiscPrompt\n      ,Misc2Prompt\n      ,Misc3Prompt\n      ,Misc4Prompt\n      ,Misc5Prompt\n      ,ExtWarrantyPrompt\n      ,ExtWarranty2Prompt\n      ,ExtWarranty3Prompt\n      ,ExtWarranty4Prompt\n      ,ExtWarranty5Prompt\n      ,ExtWarranty2Code\n      ,ExtWarranty3Code\n      ,ExtWarranty4Code\n      ,ExtWarranty5Code\n      ,Item1Prompt\n      ,Item2Prompt\n      ,Item3Prompt\n      ,Item4Prompt\n      ,Item5Prompt\n      ,Item1Code\n      ,Item2Code\n      ,Item3Code\n      ,Item4Code\n      ,Item5Code\n      ,Model1Prompt\n      ,Model2Prompt\n      ,Model3Prompt\n      ,Model4Prompt\n      ,Model5Prompt\n      ,Model1Code\n      ,Model2Code\n      ,Model3Code\n      ,Model4Code\n      ,Model5Code\n      ,ImmediateReservedDays\n      ,Spiff2\n      ,Spiff2EndDate\n      ,Spiff2StartDate\n      ,CommentPrompt\n      ,Comment2Prompt\n      ,Comment3Prompt\n      ,Comment4Prompt\n      ,Comment5Prompt\n      ,Comment2Code\n      ,Comment3Code\n      ,Comment4Code\n      ,Comment5Code\n      ,Discount1\n      ,Discount2\n      ,Discount3\n      ,Discount4\n      ,Discount5\n      ,Discount6\n      ,Discount7\n      ,Discount8\n      ,Discount9\n      ,Discount10\n      ,NotUMRP\n      ,Flooring\n      ,MasterPackQty\n      ,ABCRating\n      ,ActualSpiff\n      ,SalePrice2\n      ,SaleStartDate2\n      ,SaleEndDate2\n      ,Weight\n      ,LinqProductId\n      ,BeingDiscontinued\n      ,Active\n      ,AverageCost\n      ,Barcode\n      ,BeginYearQty\n      ,BinLocationCode\n      ,BrandCode\n      ,Code\n      ,Color\n      ,CommentCode\n      ,DateCreated\n      ,DateModified\n      ,Description\n      ,EOQ\n      ,Equivalent\n      ,ExtWarrantyCode\n      ,Field1\n      ,Field2\n      ,Field3\n      ,Field4\n      ,Field5\n      ,InventoryTypeCode\n      ,LandedCost\n      ,LandingFactor\n      ,LastCost\n      ,LastDateOrdered\n      ,LastDateReceived\n      ,LastDateSold\n      ,ListPrice\n      ,LocQOH\n      ,LocYTD\n      ,MainStockQOH\n      ,MainStockYTD\n      ,ManufacturersWarranty\n      ,MfgReturned\n      ,MiscCode\n      ,NewUsed\n      ,Note\n      ,Obsolete\n      ,OriginalCost\n      ,PicturePath\n      ,Points\n      ,PriceTag\n      ,ProductCode\n      ,ReplacementCost\n      ,ReplacementCostEffectiveDate\n      ,ResizePicture\n      ,SKU\n      ,Spiff\n      ,SpiffEndDate\n      ,SpiffStartDate\n      ,StandardCost\n      ,Stock\n      ,Substituted\n      ,SupplierCode\n      ,Tax1\n      ,Tax1CostList\n      ,Tax1Included\n      ,Tax1Percentage\n      ,Tax2\n      ,Tax3\n      ,TotalBooked\n      ,TotalLastYear\n      ,TotalMax\n      ,TotalMin\n      ,TotalNotAvailable\n      ,TotalPrevLastYear\n      ,TotalQOO\n      ,TotalReserved\n      ,UserCreated\n      ,UserModified\nfrom \n@{pipeline().parameters.Data_Source_Table_Name} \n\t where @{pipeline().parameters.Data_Source_WaterMarkColumn_modified} IS NULL ",
									"type": "Expression"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"dataIntegrationUnits": 0
						},
						"inputs": [
							{
								"referenceName": "OdbcDataSource",
								"type": "DatasetReference"
							}
						],
						"outputs": [
							{
								"referenceName": "Landing_ModelDataset",
								"type": "DatasetReference"
							}
						]
					},
					{
						"name": "UpdateWaterMark",
						"description": "Stored procedure activity to store the new high-watermark value into external control table for delta data loading. ",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 2').output.firstRow.RunEnd2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate Landing_Invoice Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[LandingTablesTruncate_Model]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1_Landing Linked Service",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Test",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Model_Delete]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Test_2_Insert",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Test",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Model_Insert]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "UpdateWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LookupDeltaOffset",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DATEADD(dd,-[DeltaOffset (Days)],[ETL Last Run End]) AS DeltaOffset\nFROM ca.Control_Table\nWHERE Entity='Model' AND\n             [Group]=10",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 1').output.firstRow.RunStart1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set Run End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 1').output.firstRow.RunEnd1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set Run Start 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 2').output.firstRow.RunStart2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 1",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run End 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "DeltaCopyfromDB",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run Start 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run End 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Test_2_Insert",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					}
				],
				"parameters": {
					"Data_Source_Table_Name": {
						"type": "String",
						"defaultValue": "SQLUser.Model"
					},
					"Data_Source_WaterMarkColumn": {
						"type": "String",
						"defaultValue": "DateModified"
					},
					"Data_Destination_Container": {
						"type": "String",
						"defaultValue": "rd.Model"
					},
					"Data_Destination_Directory": {
						"type": "String"
					},
					"Control_Table_Table_Name": {
						"type": "String",
						"defaultValue": "watermark_table"
					},
					"Control_Table_Column_Name": {
						"type": "String",
						"defaultValue": "Invoicewatermark_value"
					},
					"Data_Source_WaterMarkColumn_modified": {
						"type": "string",
						"defaultValue": "SQLUser.Model.DateModified"
					},
					"DeltaOffset": {
						"type": "int",
						"defaultValue": -1
					},
					"ControlTable_Entity": {
						"type": "string",
						"defaultValue": "Model"
					},
					"ControlTable_Group1": {
						"type": "int",
						"defaultValue": 10
					},
					"ControlTable_Group2": {
						"type": "int",
						"defaultValue": 20
					},
					"ETLBeginTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run Start"
					},
					"ETLEndTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run End"
					}
				},
				"variables": {
					"Run Start 1": {
						"type": "String"
					},
					"Run Start 2": {
						"type": "String"
					},
					"Run End 1": {
						"type": "String"
					},
					"Run End 2": {
						"type": "String"
					}
				},
				"annotations": [],
				"lastPublishTime": "2021-06-04T14:10:29Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Landing_watermarktableDataset')]",
				"[concat(variables('factoryId'), '/datasets/ControlTableDataset')]",
				"[concat(variables('factoryId'), '/datasets/OdbcDataSource')]",
				"[concat(variables('factoryId'), '/datasets/Landing_ModelDataset')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/POModel_CachetoODS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Copy new or updated rows only from database using external control table",
				"activities": [
					{
						"name": "LookupLastWaterMark",
						"description": "Retrieve the last high-watermark value stored in external control table",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Landing_watermarktableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "LookupCurrentWaterMark",
						"description": "Retrieve  the current maximum value in watermark column of source data store",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DATEADD(dd,0,[ETL Last Run Start]) as NewWatermarkValue\nFROM ca.Control_Table\nWHERE [Group]=10 AND Entity='PO'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "DeltaCopyfromDB",
						"description": "Copy activity to use query to filter the delta data by > last high-watermark and <= current high-watermark from source database, and then only copy the changes to the destination store.",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LookupCurrentWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "LookupLastWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Truncate Landing_Invoice Procedure",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "LookupDeltaOffset",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource",
								"query": {
									"value": "select SQLUSer.POModel.ID\n      ,SQLUSer.POModel.StandardCost\n      ,SQLUSer.POModel.OrderExclusive\n      ,SQLUSer.POModel.SerialTypeCode\n      ,SQLUSer.POModel.ReceiveToLocation\n      ,SQLUSer.POModel.Discount1\n      ,SQLUSer.POModel.Discount2\n      ,SQLUSer.POModel.Discount3\n      ,SQLUSer.POModel.Discount4\n      ,SQLUSer.POModel.Discount5\n      ,SQLUSer.POModel.Discount6\n      ,SQLUSer.POModel.Discount7\n      ,SQLUSer.POModel.Discount8\n      ,SQLUSer.POModel.Discount9\n      ,SQLUSer.POModel.Discount10\n      ,SQLUSer.POModel.Discount1Method\n      ,SQLUSer.POModel.Discount2Method\n      ,SQLUSer.POModel.Discount3Method\n      ,SQLUSer.POModel.Discount4Method\n      ,SQLUSer.POModel.Discount5Method\n      ,SQLUSer.POModel.Discount6Method\n      ,SQLUSer.POModel.Discount7Method\n      ,SQLUSer.POModel.Discount8Method\n      ,SQLUSer.POModel.Discount9Method\n      ,SQLUSer.POModel.Discount10Method\n      ,SQLUSer.POModel.Discount1Rate\n      ,SQLUSer.POModel.Discount2Rate\n      ,SQLUSer.POModel.Discount3Rate\n      ,SQLUSer.POModel.Discount4Rate\n      ,SQLUSer.POModel.Discount5Rate\n      ,SQLUSer.POModel.Discount6Rate\n      ,SQLUSer.POModel.Discount7Rate\n      ,SQLUSer.POModel.Discount8Rate\n      ,SQLUSer.POModel.Discount9Rate\n      ,SQLUSer.POModel.Discount10Rate\n      ,SQLUSer.POModel.Unreleased\n      ,SQLUSer.POModel.RequestedDeliveryDate\n      ,SQLUSer.POModel.ETADateMostUpdated\n      ,SQLUSer.POModel.EDISentDate\n      ,SQLUSer.POModel.EDISentTime\n      ,SQLUSer.POModel.RSDMostUpdated\n      ,SQLUSer.POModel.BackOrderInvoiceCode\n      ,SQLUSer.POModel.BackOrderInvoiceDateStamp\n      ,SQLUSer.POModel.BackOrderInvoiceLineTimeStamp\n      ,SQLUSer.POModel.CostFactor\n      ,SQLUSer.POModel.Costed\n      ,SQLUSer.POModel.DateReceived\n      ,SQLUSer.POModel.DateStamp\n      ,SQLUSer.POModel.ETADate\n      ,SQLUSer.POModel.ExtendedFactoredCost\n      ,SQLUSer.POModel.ExtendedUnitCost\n      ,SQLUSer.POModel.LineTimeStamp\n      ,SQLUSer.POModel.LocationCode\n      ,SQLUSer.POModel.ModelCode\n      ,SQLUSer.POModel.Ordered\n      ,SQLUSer.POModel.POCode\n      ,SQLUSer.POModel.PackingSlipNumber\n      ,SQLUSer.POModel.QtyOrdered\n      ,SQLUSer.POModel.QtyPrevReceived\n      ,SQLUSer.POModel.QtyReceived\n      ,SQLUSer.POModel.QtySuggested\n      ,SQLUSer.POModel.QuotedCost\n      ,SQLUSer.POModel.Received\n      ,SQLUSer.POModel.Reference\n      ,SQLUSer.POModel.SupplierInvoice\n      ,SQLUSer.POModel.UnitCost\nfrom \nSQLUser.POModel INNER JOIN SQLUser.PO ON\nSQLUser.POModel.POCode=SQLUser.PO.Code\n where @{pipeline().parameters.Data_Source_WaterMarkColumn2} > '@{activity('LookupDeltaOffset').output.firstRow.DeltaOffset}'and @{pipeline().parameters.Data_Source_WaterMarkColumn2} <= '@{activity('LookupCurrentWaterMark').output.firstRow.NewWatermarkValue}'",
									"type": "Expression"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"dataIntegrationUnits": 0
						},
						"inputs": [
							{
								"referenceName": "OdbcDataSource",
								"type": "DatasetReference"
							}
						],
						"outputs": [
							{
								"referenceName": "Landing_POModelDataset",
								"type": "DatasetReference"
							}
						]
					},
					{
						"name": "UpdateWaterMark",
						"description": "Stored procedure activity to store the new high-watermark value into external control table for delta data loading. ",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 2').output.firstRow.RunEnd2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate Landing_Invoice Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[LandingTablesTruncate_POModel]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1_Landing Linked Service",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Test",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[POModel_Delete]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Test_2_Insert",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Test",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[POModel_Insert]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "UpdateWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LookupDeltaOffset",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DATEADD(dd,-[DeltaOffset (Days)],[ETL Last Run End]) AS DeltaOffset\nFROM ca.Control_Table\nWHERE Entity='PO' AND\n             [Group]=10",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 1').output.firstRow.RunStart1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set Run End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 1').output.firstRow.RunEnd1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set Run Start 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 2').output.firstRow.RunStart2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 1",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run End 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "DeltaCopyfromDB",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run Start 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run End 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Test_2_Insert",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					}
				],
				"parameters": {
					"Data_Source_Table_Name": {
						"type": "String",
						"defaultValue": "SQLUser.POModel"
					},
					"Data_Source_WaterMarkColumn": {
						"type": "String",
						"defaultValue": "DateStamp"
					},
					"Data_Destination_Container": {
						"type": "String",
						"defaultValue": "rd.POModel"
					},
					"Data_Destination_Directory": {
						"type": "String"
					},
					"Control_Table_Table_Name": {
						"type": "String",
						"defaultValue": "watermark_table"
					},
					"Control_Table_Column_Name": {
						"type": "String",
						"defaultValue": "Invoicewatermark_value"
					},
					"Data_Source_WaterMarkColumn_modified": {
						"type": "string",
						"defaultValue": "SQLUser.POModel.DateStamp"
					},
					"DeltaOffset": {
						"type": "int",
						"defaultValue": -1
					},
					"ControlTable_Entity": {
						"type": "string",
						"defaultValue": "POModel"
					},
					"ControlTable_Group1": {
						"type": "int",
						"defaultValue": 10
					},
					"ControlTable_Group2": {
						"type": "int",
						"defaultValue": 20
					},
					"ETLBeginTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run Start"
					},
					"ETLEndTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run End"
					},
					"Data_Source_WaterMarkColumn2": {
						"type": "string",
						"defaultValue": "SQLUser.PO.DateStarted"
					}
				},
				"variables": {
					"Run Start 1": {
						"type": "String"
					},
					"Run Start 2": {
						"type": "String"
					},
					"Run End 1": {
						"type": "String"
					},
					"Run End 2": {
						"type": "String"
					}
				},
				"annotations": [],
				"lastPublishTime": "2021-06-10T05:37:14Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Landing_watermarktableDataset')]",
				"[concat(variables('factoryId'), '/datasets/ControlTableDataset')]",
				"[concat(variables('factoryId'), '/datasets/OdbcDataSource')]",
				"[concat(variables('factoryId'), '/datasets/Landing_POModelDataset')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/POSerial_CachetoODS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Copy new or updated rows only from database using external control table",
				"activities": [
					{
						"name": "LookupLastWaterMark",
						"description": "Retrieve the last high-watermark value stored in external control table",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Landing_watermarktableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "LookupCurrentWaterMark",
						"description": "Retrieve  the current maximum value in watermark column of source data store",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Set Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DATEADD(dd,0,[ETL Last Run Start]) as NewWatermarkValue\nFROM ca.Control_Table\nWHERE [Group]=10 AND Entity='PO'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "DeltaCopyfromDB",
						"description": "Copy activity to use query to filter the delta data by > last high-watermark and <= current high-watermark from source database, and then only copy the changes to the destination store.",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LookupCurrentWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "LookupLastWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Truncate Landing_POSerial Procedure",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "LookupDeltaOffset",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource",
								"query": {
									"value": "select SQLUser.POSerial.ID\n      ,SQLUser.POSerial.OriginalCost\n      ,SQLUser.POSerial.FreightAmount\n      ,SQLUser.POSerial.FreightInvoiceNumber\n      ,SQLUser.POSerial.SerialTypeCode\n      ,SQLUser.POSerial.Discount1\n      ,SQLUser.POSerial.Discount2\n      ,SQLUser.POSerial.Discount3\n      ,SQLUser.POSerial.Discount4\n      ,SQLUser.POSerial.Discount5\n      ,SQLUser.POSerial.Discount6\n      ,SQLUser.POSerial.Discount7\n      ,SQLUser.POSerial.Discount8\n      ,SQLUser.POSerial.Discount9\n      ,SQLUser.POSerial.Discount10\n      ,SQLUser.POSerial.Discount1Method\n      ,SQLUser.POSerial.Discount2Method\n      ,SQLUser.POSerial.Discount3Method\n      ,SQLUser.POSerial.Discount4Method\n      ,SQLUser.POSerial.Discount5Method\n      ,SQLUser.POSerial.Discount6Method\n      ,SQLUser.POSerial.Discount7Method\n      ,SQLUser.POSerial.Discount8Method\n      ,SQLUser.POSerial.Discount9Method\n      ,SQLUser.POSerial.Discount10Method\n      ,SQLUser.POSerial.Discount1Rate\n      ,SQLUser.POSerial.Discount2Rate\n      ,SQLUser.POSerial.Discount3Rate\n      ,SQLUser.POSerial.Discount4Rate\n      ,SQLUser.POSerial.Discount5Rate\n      ,SQLUser.POSerial.Discount6Rate\n      ,SQLUser.POSerial.Discount7Rate\n      ,SQLUser.POSerial.Discount8Rate\n      ,SQLUser.POSerial.Discount9Rate\n      ,SQLUser.POSerial.Discount10Rate\n      ,SQLUser.POSerial.DyeLot\n      ,SQLUser.POSerial.Available\n      ,SQLUser.POSerial.BinLocationCode\n      ,SQLUser.POSerial.Cost\n      ,SQLUser.POSerial.Costed\n      ,SQLUser.POSerial.DateReceived\n      ,SQLUser.POSerial.Features\n      ,SQLUser.POSerial.FloorPlan\n      ,SQLUser.POSerial.FloorPlanDueDate\n      ,SQLUser.POSerial.LocationCode\n      ,SQLUser.POSerial.ModelCode\n      ,SQLUser.POSerial.ModelDateStamp\n      ,SQLUser.POSerial.ModelLineTimeStamp\n      ,SQLUser.POSerial.Ordered\n      ,SQLUser.POSerial.POCode\n      ,SQLUser.POSerial.Received\n      ,SQLUser.POSerial.Returned\n      ,SQLUser.POSerial.RunNumber\n      ,SQLUser.POSerial.SerialCode\n      ,SQLUser.POSerial.SupplierInvoice\n      ,SQLUser.POSerial.TrustDocument\n      ,SQLUser.POSerial.TrustDocumentLine\nfrom \nSQLUser.POSerial INNER JOIN SQLUser.PO ON\nSQLUser.POSerial.POCode=SQLUser.PO.Code\n where @{pipeline().parameters.Data_Source_WaterMarkColumn2} > '@{activity('LookupDeltaOffset').output.firstRow.DeltaOffset}'and @{pipeline().parameters.Data_Source_WaterMarkColumn2} <= '@{activity('LookupCurrentWaterMark').output.firstRow.NewWatermarkValue}'",
									"type": "Expression"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"dataIntegrationUnits": 0
						},
						"inputs": [
							{
								"referenceName": "OdbcDataSource",
								"type": "DatasetReference"
							}
						],
						"outputs": [
							{
								"referenceName": "Landing_POSerialDataset",
								"type": "DatasetReference"
							}
						]
					},
					{
						"name": "UpdateWaterMark",
						"description": "Stored procedure activity to store the new high-watermark value into external control table for delta data loading. ",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 2').output.firstRow.RunEnd2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate Landing_POSerial Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[LandingTablesTruncate_POSerial]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1_Landing Linked Service",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Test",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[POSerial_Delete]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Test_2_Insert",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Test",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[POSerial_Insert]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "UpdateWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LookupDeltaOffset",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DATEADD(dd,-[DeltaOffset (Days)],[ETL Last Run End]) AS DeltaOffset\nFROM ca.Control_Table\nWHERE Entity='PO' AND\n             [Group]=10",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 1').output.firstRow.RunStart1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set Run End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 1').output.firstRow.RunEnd1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set Run Start 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 2').output.firstRow.RunStart2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 1",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run End 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "DeltaCopyfromDB",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run Start 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run End 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Test_2_Insert",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					}
				],
				"parameters": {
					"Data_Source_Table_Name": {
						"type": "String",
						"defaultValue": "SQLUser.POSerial"
					},
					"Data_Source_WaterMarkColumn": {
						"type": "String",
						"defaultValue": "ModelDateStamp"
					},
					"Data_Destination_Container": {
						"type": "String",
						"defaultValue": "rd.POSerial"
					},
					"Data_Destination_Directory": {
						"type": "String"
					},
					"Control_Table_Table_Name": {
						"type": "String",
						"defaultValue": "watermark_table"
					},
					"Control_Table_Column_Name": {
						"type": "String",
						"defaultValue": "Invoicewatermark_value"
					},
					"Data_Source_WaterMarkColumn_modified": {
						"type": "string",
						"defaultValue": "SQLUser.POSerial.ModelDateStamp"
					},
					"DeltaOffset": {
						"type": "int",
						"defaultValue": -1
					},
					"ControlTable_Entity": {
						"type": "string",
						"defaultValue": "POSerial"
					},
					"ControlTable_Group1": {
						"type": "int",
						"defaultValue": 10
					},
					"ControlTable_Group2": {
						"type": "int",
						"defaultValue": 20
					},
					"ETLBeginTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run Start"
					},
					"ETLEndTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run End"
					},
					"Data_Source_WaterMarkColumn2": {
						"type": "string",
						"defaultValue": "SQLUser.PO.DateStarted"
					}
				},
				"variables": {
					"Run Start 1": {
						"type": "String"
					},
					"Run Start 2": {
						"type": "String"
					},
					"Run End 1": {
						"type": "String"
					},
					"Run End 2": {
						"type": "String"
					}
				},
				"annotations": [],
				"lastPublishTime": "2021-06-10T14:34:44Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Landing_watermarktableDataset')]",
				"[concat(variables('factoryId'), '/datasets/ControlTableDataset')]",
				"[concat(variables('factoryId'), '/datasets/OdbcDataSource')]",
				"[concat(variables('factoryId'), '/datasets/Landing_POSerialDataset')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/PO_CachetoODS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Copy new or updated rows only from database using external control table",
				"activities": [
					{
						"name": "LookupLastWaterMark",
						"description": "Retrieve the last high-watermark value stored in external control table",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Landing_watermarktableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "LookupCurrentWaterMark",
						"description": "Retrieve  the current maximum value in watermark column of source data store",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DATEADD(dd,0,[ETL Last Run Start]) as NewWatermarkValue\nFROM ca.Control_Table\nWHERE [Group]=10 AND Entity='PO'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "DeltaCopyfromDB",
						"description": "Copy activity to use query to filter the delta data by > last high-watermark and <= current high-watermark from source database, and then only copy the changes to the destination store.",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LookupCurrentWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "LookupLastWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Truncate Landing_Invoice Procedure",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "LookupDeltaOffset",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource",
								"query": {
									"value": "select ID\n      ,FloorPlan\n      ,ShipToType\n      ,SerialTypeCode\n      ,ReceiveToLocation\n      ,ReceiveToLocationCode\n      ,DateEffective\n      ,Unreleased\n      ,DateCreated\n      ,UserCreated\n      ,Authorized\n      ,DateAuthorized\n      ,UserAuthorized\n      ,Received\n      ,DateConfirmedReceived\n      ,UserReceived\n      ,Paid\n      ,DatePaid\n      ,UserPaid\n      ,EDISentDate\n      ,EDISentTime\n      ,RequestedDeliveryDate\n      ,Buyer\n      ,Code\n      ,Confirmed\n      ,CostFactor\n      ,DateConfirmed\n      ,DateCosted\n      ,DateFinished\n      ,DateOrdered\n      ,DateReceived\n      ,DateStarted\n      ,FloorPlanDays\n      ,ShipToAddress1\n      ,ShipToAddress2\n      ,ShipToCity\n      ,ShipToCode\n      ,ShipToName\n      ,ShipToNotes\n      ,ShipToPhone1\n      ,ShipToPhone2\n      ,ShipToState\n      ,ShipToZipCode\n      ,SupplierAccountNumber\n      ,SupplierAddress1\n      ,SupplierAddress2\n      ,SupplierCity\n      ,SupplierCode\n      ,SupplierContact1\n      ,SupplierContact2\n      ,SupplierCustomerServicePhone\n      ,SupplierDescription\n      ,SupplierEmail\n      ,SupplierFax\n      ,SupplierPONotes\n      ,SupplierPhone1\n      ,SupplierPhone2\n      ,SupplierShipVia\n      ,SupplierState\n      ,SupplierWebsite\n      ,SupplierZipCode\n      ,TotalCosted\n      ,TotalOrdered\n      ,TotalReceived\n      ,UserConfirmed\nfrom \n@{pipeline().parameters.Data_Source_Table_Name} \n\t where @{pipeline().parameters.Data_Source_WaterMarkColumn_modified} > '@{activity('LookupDeltaOffset').output.firstRow.DeltaOffset}' \n\t and @{pipeline().parameters.Data_Source_WaterMarkColumn_modified} <= '@{activity('LookupCurrentWaterMark').output.firstRow.NewWatermarkValue}' \n",
									"type": "Expression"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"dataIntegrationUnits": 0
						},
						"inputs": [
							{
								"referenceName": "OdbcDataSource",
								"type": "DatasetReference"
							}
						],
						"outputs": [
							{
								"referenceName": "Landing_PODataset",
								"type": "DatasetReference"
							}
						]
					},
					{
						"name": "UpdateWaterMark",
						"description": "Stored procedure activity to store the new high-watermark value into external control table for delta data loading. ",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 2').output.firstRow.RunEnd2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate Landing_Invoice Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[LandingTablesTruncate_PO]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1_Landing Linked Service",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Test",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[PO_Delete]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Test_2_Insert",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Test",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[PO_Insert]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "UpdateWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LookupDeltaOffset",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DATEADD(dd,-[DeltaOffset (Days)],[ETL Last Run End]) AS DeltaOffset\nFROM ca.Control_Table\nWHERE Entity='PO' AND\n             [Group]=10",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 1').output.firstRow.RunStart1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set Run End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 1').output.firstRow.RunEnd1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set Run Start 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 2').output.firstRow.RunStart2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 1",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run End 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "DeltaCopyfromDB",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run Start 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run End 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Test_2_Insert",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					}
				],
				"parameters": {
					"Data_Source_Table_Name": {
						"type": "String",
						"defaultValue": "SQLUser.PO"
					},
					"Data_Source_WaterMarkColumn": {
						"type": "String",
						"defaultValue": "DateStarted"
					},
					"Data_Destination_Container": {
						"type": "String",
						"defaultValue": "rd.PO"
					},
					"Data_Destination_Directory": {
						"type": "String"
					},
					"Control_Table_Table_Name": {
						"type": "String",
						"defaultValue": "watermark_table"
					},
					"Control_Table_Column_Name": {
						"type": "String",
						"defaultValue": "Invoicewatermark_value"
					},
					"Data_Source_WaterMarkColumn_modified": {
						"type": "string",
						"defaultValue": "SQLUser.PO.DateStarted"
					},
					"DeltaOffset": {
						"type": "int",
						"defaultValue": -1
					},
					"ControlTable_Entity": {
						"type": "string",
						"defaultValue": "PO"
					},
					"ControlTable_Group1": {
						"type": "int",
						"defaultValue": 10
					},
					"ControlTable_Group2": {
						"type": "int",
						"defaultValue": 20
					},
					"ETLBeginTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run Start"
					},
					"ETLEndTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run End"
					}
				},
				"variables": {
					"Run Start 1": {
						"type": "String"
					},
					"Run Start 2": {
						"type": "String"
					},
					"Run End 1": {
						"type": "String"
					},
					"Run End 2": {
						"type": "String"
					}
				},
				"annotations": [],
				"lastPublishTime": "2021-06-10T04:40:19Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Landing_watermarktableDataset')]",
				"[concat(variables('factoryId'), '/datasets/ControlTableDataset')]",
				"[concat(variables('factoryId'), '/datasets/OdbcDataSource')]",
				"[concat(variables('factoryId'), '/datasets/Landing_PODataset')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/ProductMinor_Cache to ODS Copy Activity')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CopyActivity1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate Branch",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource"
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"validateDataConsistency": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataset_hdo",
								"type": "DatasetReference",
								"parameters": {
									"TableName": "SQLUser.ProductMinor"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Landing_ProductMinorDataset",
								"type": "DatasetReference"
							}
						]
					},
					{
						"name": "Truncate Branch",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[LandingTablesTruncate_ProductMinor]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1_Landing Linked Service",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Insert",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Truncate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[ProductMinor_Insert]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 1').output.firstRow.RunStart1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run End 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "CopyActivity1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 1').output.firstRow.RunEnd1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 2').output.firstRow.RunStart2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run End 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Insert",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "UpdateControlTable",
						"description": "Stored procedure activity to store the new high-watermark value into external control table for delta data loading. ",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 2').output.firstRow.RunEnd2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "UpdateControlTable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[ODSProductMinor_Truncate]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					}
				],
				"parameters": {
					"ControlTable_Entity": {
						"type": "string",
						"defaultValue": "ProductMinor"
					},
					"ControlTable_Group1": {
						"type": "string",
						"defaultValue": "10"
					},
					"ETLBeginTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run Start"
					},
					"ETLEndTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run End"
					},
					"ControlTable_Group2": {
						"type": "string",
						"defaultValue": "20"
					}
				},
				"annotations": [],
				"lastPublishTime": "2021-06-10T04:28:28Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SourceDataset_hdo')]",
				"[concat(variables('factoryId'), '/datasets/Landing_ProductMinorDataset')]",
				"[concat(variables('factoryId'), '/datasets/ControlTableDataset')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Product_Cache to ODS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CopyActivity1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate Branch",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource"
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"validateDataConsistency": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataset_hdo",
								"type": "DatasetReference",
								"parameters": {
									"TableName": "SQLUser.Product"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Landing_ProductDataset",
								"type": "DatasetReference"
							}
						]
					},
					{
						"name": "Truncate Branch",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[LandingTablesTruncate_Product]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1_Landing Linked Service",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Insert",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Truncate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Product_Insert]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 1').output.firstRow.RunStart1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run End 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "CopyActivity1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 1').output.firstRow.RunEnd1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 2').output.firstRow.RunStart2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run End 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Insert",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "UpdateControlTable",
						"description": "Stored procedure activity to store the new high-watermark value into external control table for delta data loading. ",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 2').output.firstRow.RunEnd2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "UpdateControlTable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[ODSProduct_Truncate]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					}
				],
				"parameters": {
					"ControlTable_Entity": {
						"type": "string",
						"defaultValue": "Product"
					},
					"ControlTable_Group1": {
						"type": "string",
						"defaultValue": "10"
					},
					"ETLBeginTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run Start"
					},
					"ETLEndTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run End"
					},
					"ControlTable_Group2": {
						"type": "string",
						"defaultValue": "20"
					}
				},
				"annotations": [],
				"lastPublishTime": "2021-06-10T04:06:32Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SourceDataset_hdo')]",
				"[concat(variables('factoryId'), '/datasets/Landing_ProductDataset')]",
				"[concat(variables('factoryId'), '/datasets/ControlTableDataset')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SaleReferral_Cache to ODS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CopyActivity1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate SaleReferral",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource"
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"validateDataConsistency": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataset_hdo",
								"type": "DatasetReference",
								"parameters": {
									"TableName": "SQLUser.SaleReferral"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Landing_SaleReferralDataset",
								"type": "DatasetReference"
							}
						]
					},
					{
						"name": "Truncate SaleReferral",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[LandingTablesTruncate_SaleReferral]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1_Landing Linked Service",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Insert",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Truncate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SaleReferral_Insert]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 1').output.firstRow.RunStart1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run End 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "CopyActivity1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 1').output.firstRow.RunEnd1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 2').output.firstRow.RunStart2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run End 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Insert",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "UpdateControlTable",
						"description": "Stored procedure activity to store the new high-watermark value into external control table for delta data loading. ",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 2').output.firstRow.RunEnd2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "UpdateControlTable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[ODSSaleReferral_Truncate]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					}
				],
				"parameters": {
					"ControlTable_Entity": {
						"type": "string",
						"defaultValue": "SaleReferral"
					},
					"ControlTable_Group1": {
						"type": "string",
						"defaultValue": "10"
					},
					"ETLBeginTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run Start"
					},
					"ETLEndTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run End"
					},
					"ControlTable_Group2": {
						"type": "string",
						"defaultValue": "20"
					}
				},
				"annotations": [],
				"lastPublishTime": "2021-06-04T14:31:07Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SourceDataset_hdo')]",
				"[concat(variables('factoryId'), '/datasets/Landing_SaleReferralDataset')]",
				"[concat(variables('factoryId'), '/datasets/ControlTableDataset')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/SalesPerson_Cache to ODS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "CopyActivity1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Truncate Salesperson",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource"
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"validateDataConsistency": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SourceDataset_hdo",
								"type": "DatasetReference",
								"parameters": {
									"TableName": "SQLUser.SalesPerson"
								}
							}
						],
						"outputs": [
							{
								"referenceName": "Landing_SalesPersonDataset",
								"type": "DatasetReference"
							}
						]
					},
					{
						"name": "Truncate Salesperson",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[LandingTablesTruncate_SalesPerson]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1_Landing Linked Service",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Insert",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Truncate",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[SalesPerson_Insert]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 1').output.firstRow.RunStart1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run End 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "CopyActivity1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 1').output.firstRow.RunEnd1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 2').output.firstRow.RunStart2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run End 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Insert",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "UpdateControlTable",
						"description": "Stored procedure activity to store the new high-watermark value into external control table for delta data loading. ",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 2').output.firstRow.RunEnd2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "UpdateControlTable",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[ODSSalesPerson_Truncate]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					}
				],
				"parameters": {
					"ControlTable_Entity": {
						"type": "string",
						"defaultValue": "SalesPerson"
					},
					"ControlTable_Group1": {
						"type": "string",
						"defaultValue": "10"
					},
					"ETLBeginTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run Start"
					},
					"ETLEndTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run End"
					},
					"ControlTable_Group2": {
						"type": "string",
						"defaultValue": "20"
					}
				},
				"annotations": [],
				"lastPublishTime": "2021-06-04T13:21:42Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/SourceDataset_hdo')]",
				"[concat(variables('factoryId'), '/datasets/Landing_SalesPersonDataset')]",
				"[concat(variables('factoryId'), '/datasets/ControlTableDataset')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Serial_CachetoODS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Copy new or updated rows only from database using external control table",
				"activities": [
					{
						"name": "LookupLastWaterMark",
						"description": "Retrieve the last high-watermark value stored in external control table",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Landing_watermarktableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "LookupCurrentWaterMark",
						"description": "Retrieve  the current maximum value in watermark column of source data store",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DATEADD(dd,0,[ETL Last Run Start]) as NewWatermarkValue\nFROM ca.Control_Table\nWHERE [Group]=10 AND Entity='Serial'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "DeltaCopyfromDB",
						"description": "Copy activity to use query to filter the delta data by > last high-watermark and <= current high-watermark from source database, and then only copy the changes to the destination store.",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LookupCurrentWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "LookupLastWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Truncate Landing_Serial Procedure",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "LookupDeltaOffset",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource",
								"query": {
									"value": "select  ID\n      ,RawBarcode\n      ,OrderedForInvoiceCode\n      ,OrderedForInvoiceDateStamp\n      ,OrderedForInvoiceTimeStamp\n      ,Spiff\n      ,SpiffEndDate\n      ,SpiffStartDate\n      ,POLineTimeStamp\n      ,PODateStamp\n      ,DateReserved\n      ,Notes\n      ,OriginalCost\n      ,FreightAmount\n      ,FreightInvoiceNumber\n      ,ResizePicture\n      ,PicturePath\n      ,StandardCost\n      ,ReserveExclusive\n      ,SerialTypeCode\n      ,UniqueSellPrice\n      ,Discount1\n      ,Discount2\n      ,Discount3\n      ,Discount4\n      ,Discount5\n      ,Discount6\n      ,Discount7\n      ,Discount8\n      ,Discount9\n      ,Discount10\n      ,ReserveExclusiveCommentCode\n      ,TagPrice\n      ,Discount1Method\n      ,Discount2Method\n      ,Discount3Method\n      ,Discount4Method\n      ,Discount5Method\n      ,Discount6Method\n      ,Discount7Method\n      ,Discount8Method\n      ,Discount9Method\n      ,Discount10Method\n      ,Discount1Rate\n      ,Discount2Rate\n      ,Discount3Rate\n      ,Discount4Rate\n      ,Discount5Rate\n      ,Discount6Rate\n      ,Discount7Rate\n      ,Discount8Rate\n      ,Discount9Rate\n      ,Discount10Rate\n      ,SupplierCode\n      ,DyeLot\n      ,Available\n      ,BinLocationCode\n      ,Code\n      ,Cost\n      ,DateReceived\n      ,Features\n      ,FloorPlan\n      ,FloorPlanDueDate\n      ,InvLineDateStamp\n      ,InvLineTimeStamp\n      ,InvoiceCode\n      ,LocationCode\n      ,ModelCode\n      ,POCode\n      ,RunNumber\n      ,Status\n      ,SupplierInvoice\n      ,TrustDocument\n      ,TrustDocumentLine\n      \nfrom \n@{pipeline().parameters.Data_Source_Table_Name} \n\t where @{pipeline().parameters.Data_Source_WaterMarkColumn_modified} > '@{activity('LookupDeltaOffset').output.firstRow.DeltaOffset}' \n\t and @{pipeline().parameters.Data_Source_WaterMarkColumn_modified} <= '@{activity('LookupCurrentWaterMark').output.firstRow.NewWatermarkValue}' \n",
									"type": "Expression"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"dataIntegrationUnits": 0
						},
						"inputs": [
							{
								"referenceName": "OdbcDataSource",
								"type": "DatasetReference"
							}
						],
						"outputs": [
							{
								"referenceName": "Landing_SerialDataset",
								"type": "DatasetReference"
							}
						]
					},
					{
						"name": "UpdateWaterMark",
						"description": "Stored procedure activity to store the new high-watermark value into external control table for delta data loading. ",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 2').output.firstRow.RunEnd2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate Landing_Serial Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[LandingTablesTruncate_Serial]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1_Landing Linked Service",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Test",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Serial_Delete]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Test_2_Insert",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Test",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Serial_Insert]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "UpdateWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LookupDeltaOffset",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DATEADD(dd,-[DeltaOffset (Days)],[ETL Last Run End]) AS DeltaOffset\nFROM ca.Control_Table\nWHERE Entity='Serial' AND\n             [Group]=10",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 1').output.firstRow.RunStart1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set Run End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 1').output.firstRow.RunEnd1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set Run Start 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 2').output.firstRow.RunStart2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 1",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run End 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "DeltaCopyfromDB",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run Start 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run End 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Test_2_Insert",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					}
				],
				"parameters": {
					"Data_Source_Table_Name": {
						"type": "String",
						"defaultValue": "SQLUser.Serial"
					},
					"Data_Source_WaterMarkColumn": {
						"type": "String",
						"defaultValue": "DateReceived"
					},
					"Data_Destination_Container": {
						"type": "String",
						"defaultValue": "rd.Serial"
					},
					"Data_Destination_Directory": {
						"type": "String"
					},
					"Control_Table_Table_Name": {
						"type": "String",
						"defaultValue": "watermark_table"
					},
					"Control_Table_Column_Name": {
						"type": "String",
						"defaultValue": "Invoicewatermark_value"
					},
					"Data_Source_WaterMarkColumn_modified": {
						"type": "string",
						"defaultValue": "SQLUser.Serial.DateReceived"
					},
					"DeltaOffset": {
						"type": "int",
						"defaultValue": -1
					},
					"ControlTable_Entity": {
						"type": "string",
						"defaultValue": "Serial"
					},
					"ControlTable_Group1": {
						"type": "int",
						"defaultValue": 10
					},
					"ControlTable_Group2": {
						"type": "int",
						"defaultValue": 20
					},
					"ETLBeginTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run Start"
					},
					"ETLEndTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run End"
					}
				},
				"variables": {
					"Run Start 1": {
						"type": "String"
					},
					"Run Start 2": {
						"type": "String"
					},
					"Run End 1": {
						"type": "String"
					},
					"Run End 2": {
						"type": "String"
					}
				},
				"annotations": [],
				"lastPublishTime": "2021-06-03T22:29:03Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Landing_watermarktableDataset')]",
				"[concat(variables('factoryId'), '/datasets/ControlTableDataset')]",
				"[concat(variables('factoryId'), '/datasets/OdbcDataSource')]",
				"[concat(variables('factoryId'), '/datasets/Landing_SerialDataset')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/Supplier_CachetoODS')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Copy new or updated rows only from database using external control table",
				"activities": [
					{
						"name": "LookupLastWaterMark",
						"description": "Retrieve the last high-watermark value stored in external control table",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "Landing_watermarktableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "LookupCurrentWaterMark",
						"description": "Retrieve  the current maximum value in watermark column of source data store",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Set Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DATEADD(dd,0,[ETL Last Run Start]) as NewWatermarkValue\nFROM ca.Control_Table\nWHERE [Group]=10 AND Entity='Supplier'",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "DeltaCopyfromDB",
						"description": "Copy activity to use query to filter the delta data by > last high-watermark and <= current high-watermark from source database, and then only copy the changes to the destination store.",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "LookupCurrentWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "LookupLastWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "Truncate Landing_Invoice Procedure",
								"dependencyConditions": [
									"Succeeded"
								]
							},
							{
								"activity": "LookupDeltaOffset",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "OdbcSource",
								"query": {
									"value": "select ID\n      ,AdditionalBillTo\n      ,FloorPlanning\n      ,ETADays\n      ,BranchCode\n      ,Memo\n      ,BankAccount\n      ,DefaultPONumber\n      ,DefaultLocation\n      ,Branch\n      ,ImmediateReservedDays\n      ,CreditGLAccount\n      ,CRDueDateTerms\n      ,CRDueDays\n      ,EFTBankingInstitution\n      ,EFTBranch\n      ,EFTBankAccount\n      ,EFTContactName\n      ,EFTContactPhone\n      ,EFTContactExtension\n      ,EFTContactFax\n      ,EFTEmail\n      ,EDIFormat\n      ,DefaultPOCost\n      ,AvgLeadTime\n      ,Obsolete\n      ,DefaultCostCenter\n      ,Require1099\n      ,UseDueDateForSplitPayments\n      ,AutoCreateAPInvoiceCosting\n      ,EDIOutFolder\n      ,DeliveryDateRequired\n      ,UseRDDFrom\n      ,AccountNumber\n      ,Address1\n      ,Address2\n      ,BillToSupplierCode\n      ,City\n      ,Code\n      ,Contact1\n      ,Contact2\n      ,CustomerServicePhone\n      ,DateCreated\n      ,DateModified\n      ,Description\n      ,DiscountDateTerms\n      ,DiscountDays\n      ,DiscountGLAccount\n      ,DiscountPercentage\n      ,DueDateTerms\n      ,DueDays\n      ,Email\n      ,Fax\n      ,Field1\n      ,Field2\n      ,Field3\n      ,Field4\n      ,Field5\n      ,FreightGLAccount\n      ,GSTCharged\n      ,InventorySupplier\n      ,LastYearPurchase\n      ,Note\n      ,NoteToPO\n      ,POCostFactor\n      ,POFloorPlanDays\n      ,POLineType\n      ,POMinOrder\n      ,PONote\n      ,POPrintISE\n      ,POShipVia\n      ,POUpdateAP\n      ,Phone1\n      ,Phone2\n      ,PrevLastYearPurchase\n      ,PrintAccountOnCheck\n      ,PurchaseGLAccount\n      ,State\n      ,SupplierTypeCode\n      ,TINNumber\n      ,UserCreated\n      ,UserModified\n      ,Website\n      ,YTDPurchase\n      ,ZipCode\nfrom \n@{pipeline().parameters.Data_Source_Table_Name} \n\t where (@{pipeline().parameters.Data_Source_WaterMarkColumn_modified} > '@{activity('LookupDeltaOffset').output.firstRow.DeltaOffset}' \n         OR SQLUser.Supplier.DateModified>'@{activity('LookupDeltaOffset').output.firstRow.DeltaOffset}')\n\t and (@{pipeline().parameters.Data_Source_WaterMarkColumn_modified} <= '@{activity('LookupCurrentWaterMark').output.firstRow.NewWatermarkValue}'  OR\n       SQLUser.Supplier.DateModified<='@{activity('LookupCurrentWaterMark').output.firstRow.NewWatermarkValue}')\n",
									"type": "Expression"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"dataIntegrationUnits": 0
						},
						"inputs": [
							{
								"referenceName": "OdbcDataSource",
								"type": "DatasetReference"
							}
						],
						"outputs": [
							{
								"referenceName": "Landing_SupplierDataset",
								"type": "DatasetReference"
							}
						]
					},
					{
						"name": "UpdateWaterMark",
						"description": "Stored procedure activity to store the new high-watermark value into external control table for delta data loading. ",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 2').output.firstRow.RunEnd2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Truncate Landing_Invoice Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[LandingTablesTruncate_Supplier]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1_Landing Linked Service",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Test",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Supplier_Delete]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Test_2_Insert",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Test",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Supplier_Insert]"
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "UpdateWaterMark",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "LookupDeltaOffset",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger Begin 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT DATEADD(dd,-[DeltaOffset (Days)],[ETL Last Run End]) AS DeltaOffset\nFROM ca.Control_Table\nWHERE Entity='Supplier' AND\n             [Group]=10",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Set Run Start 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 1').output.firstRow.RunStart1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set Run End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLEndTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run End 1').output.firstRow.RunEnd1}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Set Run Start 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Get Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_ETLTimes]",
							"storedProcedureParameters": {
								"Column_Name": {
									"value": {
										"value": "@{pipeline().parameters.ETLBeginTimeColumn}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"GetRunEnd": {
									"value": {
										"value": "@{activity('Get Run Start 2').output.firstRow.RunStart2}",
										"type": "Expression"
									},
									"type": "DateTime"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger End 1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group1}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Load Active Trigger Begin 2",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Set Run Start 2",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[Control_LoadActive]",
							"storedProcedureParameters": {
								"Entity": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Entity}",
										"type": "Expression"
									},
									"type": "String"
								},
								"Group": {
									"value": {
										"value": "@{pipeline().parameters.ControlTable_Group2}",
										"type": "Expression"
									},
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Secondary1LinkedService_Test",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Get Run Start 1",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run End 1",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "DeltaCopyfromDB",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd1]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run Start 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Load Active Trigger End 1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunStart2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					},
					{
						"name": "Get Run End 2",
						"type": "Lookup",
						"dependsOn": [
							{
								"activity": "Test_2_Insert",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderQuery": "SELECT  DATEADD(hh,-7,current_timestamp) AS [RunEnd2]",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "ControlTableDataset",
								"type": "DatasetReference"
							}
						}
					}
				],
				"parameters": {
					"Data_Source_Table_Name": {
						"type": "String",
						"defaultValue": "SQLUser.Supplier"
					},
					"Data_Source_WaterMarkColumn": {
						"type": "String",
						"defaultValue": "DateCreated"
					},
					"Data_Destination_Container": {
						"type": "String",
						"defaultValue": "rd.Supplier"
					},
					"Data_Destination_Directory": {
						"type": "String"
					},
					"Control_Table_Table_Name": {
						"type": "String",
						"defaultValue": "watermark_table"
					},
					"Control_Table_Column_Name": {
						"type": "String",
						"defaultValue": "Invoicewatermark_value"
					},
					"Data_Source_WaterMarkColumn_modified": {
						"type": "string",
						"defaultValue": "SQLUser.Supplier.DateCreated"
					},
					"DeltaOffset": {
						"type": "int",
						"defaultValue": -1
					},
					"ControlTable_Entity": {
						"type": "string",
						"defaultValue": "Supplier"
					},
					"ControlTable_Group1": {
						"type": "int",
						"defaultValue": 10
					},
					"ControlTable_Group2": {
						"type": "int",
						"defaultValue": 20
					},
					"ETLBeginTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run Start"
					},
					"ETLEndTimeColumn": {
						"type": "string",
						"defaultValue": "ETL Last Run End"
					}
				},
				"variables": {
					"Run Start 1": {
						"type": "String"
					},
					"Run Start 2": {
						"type": "String"
					},
					"Run End 1": {
						"type": "String"
					},
					"Run End 2": {
						"type": "String"
					}
				},
				"annotations": [],
				"lastPublishTime": "2021-06-10T01:20:24Z"
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/datasets/Landing_watermarktableDataset')]",
				"[concat(variables('factoryId'), '/datasets/ControlTableDataset')]",
				"[concat(variables('factoryId'), '/datasets/OdbcDataSource')]",
				"[concat(variables('factoryId'), '/datasets/Landing_SupplierDataset')]"
			]
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureSqlDatabaseExternal_ControlTable')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "External control table to store high water mark value.",
				"linkedServiceName": {
					"referenceName": "Controltablelinkedservice",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "dbo",
					"table": "watermarktable"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/AzureTable1')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "AzureTableStorage1",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureTable",
				"schema": [],
				"typeProperties": {
					"tableName": "InvoiceModified"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ControlTableDataset')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1LinkedService_Test",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "Group",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Step",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Data Source",
						"type": "nvarchar"
					},
					{
						"name": "Entity",
						"type": "nvarchar"
					},
					{
						"name": "Load Active",
						"type": "bit"
					},
					{
						"name": "Load Type",
						"type": "nvarchar"
					},
					{
						"name": "DeltaOffset (Days)",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ETL Last Run Start",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "ETL Last Run End",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "Last Run Volume",
						"type": "int",
						"precision": 10
					}
				],
				"typeProperties": {
					"schema": "ca",
					"table": "Control_Table"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/CustomerODS')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1LinkedService_Test",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "TripNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ParentDateStamp",
						"type": "date"
					},
					{
						"name": "ParentLineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "Amount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "DateStamp",
						"type": "date"
					},
					{
						"name": "Description",
						"type": "varchar"
					},
					{
						"name": "InPackage",
						"type": "varchar"
					},
					{
						"name": "InvoiceCode",
						"type": "varchar"
					},
					{
						"name": "LineNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "LineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "LineType",
						"type": "varchar"
					},
					{
						"name": "LocationCode",
						"type": "varchar"
					},
					{
						"name": "Qty",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "Tax1",
						"type": "bit"
					},
					{
						"name": "Tax2",
						"type": "bit"
					},
					{
						"name": "Tax3",
						"type": "bit"
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "Customer"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DataDestination')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Connection to your destination data store.",
				"linkedServiceName": {
					"referenceName": "linkedService1_storage",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"Data_Destination_Container": {
						"type": "String"
					},
					"Data_Destination_Directory": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"folderPath": {
							"value": "@{dataset().Data_Destination_Directory}",
							"type": "Expression"
						},
						"container": {
							"value": "@{dataset().Data_Destination_Container}",
							"type": "Expression"
						}
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DelimitedText1')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Testblobstorage1",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"container": "loadtest"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "ID",
						"type": "String"
					},
					{
						"name": "Financed",
						"type": "String"
					},
					{
						"name": "Void",
						"type": "String"
					},
					{
						"name": "Qualification",
						"type": "String"
					},
					{
						"name": "Priority",
						"type": "String"
					},
					{
						"name": "Tax3Percentage",
						"type": "String"
					},
					{
						"name": "SvcRepairCode1",
						"type": "String"
					},
					{
						"name": "SvcRepairCode2",
						"type": "String"
					},
					{
						"name": "SvcRepairCode3",
						"type": "String"
					},
					{
						"name": "SvcRepairCode4",
						"type": "String"
					},
					{
						"name": "ContractCode",
						"type": "String"
					},
					{
						"name": "SvcContract",
						"type": "String"
					},
					{
						"name": "UserFinished",
						"type": "String"
					},
					{
						"name": "UserPosted",
						"type": "String"
					},
					{
						"name": "UpdateHistoryWarranty",
						"type": "String"
					},
					{
						"name": "ShipMethod",
						"type": "String"
					},
					{
						"name": "TimeCreated",
						"type": "String"
					},
					{
						"name": "TimeModified",
						"type": "String"
					},
					{
						"name": "TimeFinished",
						"type": "String"
					},
					{
						"name": "DispatchUnits",
						"type": "String"
					},
					{
						"name": "EDIDateStamp",
						"type": "String"
					},
					{
						"name": "EDITimeStamp",
						"type": "String"
					},
					{
						"name": "PrintMethod",
						"type": "String"
					},
					{
						"name": "DispatchStartTime",
						"type": "String"
					},
					{
						"name": "TripChargeCode",
						"type": "String"
					},
					{
						"name": "TripChargeAmount",
						"type": "String"
					},
					{
						"name": "Locked",
						"type": "String"
					},
					{
						"name": "MobileTechInvoiceCode",
						"type": "String"
					},
					{
						"name": "ServiceRequestID",
						"type": "String"
					},
					{
						"name": "CarrierCode",
						"type": "String"
					},
					{
						"name": "ShipViaCode",
						"type": "String"
					},
					{
						"name": "JobStatusUpdate",
						"type": "String"
					},
					{
						"name": "DispatchEmail",
						"type": "String"
					},
					{
						"name": "LastDateSaved",
						"type": "String"
					},
					{
						"name": "LastTimeSaved",
						"type": "String"
					},
					{
						"name": "Terms",
						"type": "String"
					},
					{
						"name": "SvcEquipmentNumber",
						"type": "String"
					},
					{
						"name": "WebOrderID",
						"type": "String"
					},
					{
						"name": "Department",
						"type": "String"
					},
					{
						"name": "CreditStatusCode",
						"type": "String"
					},
					{
						"name": "CreditApprovedUserCode",
						"type": "String"
					},
					{
						"name": "CreditApprovedDateStamp",
						"type": "String"
					},
					{
						"name": "CreditApprovedTimeStamp",
						"type": "String"
					},
					{
						"name": "EDIMaroline",
						"type": "String"
					},
					{
						"name": "RequestedDate",
						"type": "String"
					},
					{
						"name": "SvcCSRInvoice",
						"type": "String"
					},
					{
						"name": "SvcSoldList",
						"type": "String"
					},
					{
						"name": "SvcSoldSTDCost",
						"type": "String"
					},
					{
						"name": "SvcFollowUpDate",
						"type": "String"
					},
					{
						"name": "SvcScheduleDate",
						"type": "String"
					},
					{
						"name": "Tax2MaxAmount",
						"type": "String"
					},
					{
						"name": "EDIWhirlpool",
						"type": "String"
					},
					{
						"name": "MinDepositPercent",
						"type": "String"
					},
					{
						"name": "UnitModifier",
						"type": "String"
					},
					{
						"name": "DateFinished",
						"type": "String"
					},
					{
						"name": "DatePosted",
						"type": "String"
					},
					{
						"name": "TimePosted",
						"type": "String"
					},
					{
						"name": "TTRTaxCalculated",
						"type": "String"
					},
					{
						"name": "PickUpBranchCode",
						"type": "String"
					},
					{
						"name": "PodiumOptOut",
						"type": "String"
					},
					{
						"name": "SignCustmizedFields",
						"type": "String"
					},
					{
						"name": "AVBSaleDateSent",
						"type": "String"
					},
					{
						"name": "AVBSaleTimeSent",
						"type": "String"
					},
					{
						"name": "sysCreated",
						"type": "String"
					},
					{
						"name": "sysModified",
						"type": "String"
					},
					{
						"name": "TTRJurisdictionCode",
						"type": "String"
					},
					{
						"name": "BranchCode",
						"type": "String"
					},
					{
						"name": "COGSPosted",
						"type": "String"
					},
					{
						"name": "CallSequence",
						"type": "String"
					},
					{
						"name": "Code",
						"type": "String"
					},
					{
						"name": "CommittedPaymentTotal",
						"type": "String"
					},
					{
						"name": "DateCreated",
						"type": "String"
					},
					{
						"name": "DateModified",
						"type": "String"
					},
					{
						"name": "DispatchPriority",
						"type": "String"
					},
					{
						"name": "DispatchRequestedRouteCode",
						"type": "String"
					},
					{
						"name": "DispatchSpecRequest",
						"type": "String"
					},
					{
						"name": "DispatchTime",
						"type": "String"
					},
					{
						"name": "DispatchTimeAM",
						"type": "String"
					},
					{
						"name": "Estimate",
						"type": "String"
					},
					{
						"name": "Field1",
						"type": "String"
					},
					{
						"name": "Field2",
						"type": "String"
					},
					{
						"name": "Field3",
						"type": "String"
					},
					{
						"name": "Field4",
						"type": "String"
					},
					{
						"name": "Field5",
						"type": "String"
					},
					{
						"name": "InvFinishDate",
						"type": "String"
					},
					{
						"name": "InvStartDate",
						"type": "String"
					},
					{
						"name": "InvTypeCode",
						"type": "String"
					},
					{
						"name": "ItemListPriceCode",
						"type": "String"
					},
					{
						"name": "ItemTotal",
						"type": "String"
					},
					{
						"name": "JobLocation",
						"type": "String"
					},
					{
						"name": "JobNumber",
						"type": "String"
					},
					{
						"name": "JobStatusCode",
						"type": "String"
					},
					{
						"name": "LaborRate",
						"type": "String"
					},
					{
						"name": "LaborTotal",
						"type": "String"
					},
					{
						"name": "MapReference",
						"type": "String"
					},
					{
						"name": "MapZoneCode",
						"type": "String"
					},
					{
						"name": "MiscTotal",
						"type": "String"
					},
					{
						"name": "OpenPaymentTotal",
						"type": "String"
					},
					{
						"name": "OtherListPriceCode",
						"type": "String"
					},
					{
						"name": "PONumber",
						"type": "String"
					},
					{
						"name": "PaymentTypeCode",
						"type": "String"
					},
					{
						"name": "PickUpDate",
						"type": "String"
					},
					{
						"name": "Reference",
						"type": "String"
					},
					{
						"name": "SaleReferralCode",
						"type": "String"
					},
					{
						"name": "Salesperson1Code",
						"type": "String"
					},
					{
						"name": "Salesperson2Code",
						"type": "String"
					},
					{
						"name": "Salesperson2Percentage",
						"type": "String"
					},
					{
						"name": "ScheduleDate",
						"type": "String"
					},
					{
						"name": "SerialListPriceCode",
						"type": "String"
					},
					{
						"name": "SerialTotal",
						"type": "String"
					},
					{
						"name": "Status",
						"type": "String"
					},
					{
						"name": "SvcAgreementExpDate",
						"type": "String"
					},
					{
						"name": "SvcAgreementNumber",
						"type": "String"
					},
					{
						"name": "SvcBrandCode",
						"type": "String"
					},
					{
						"name": "SvcCenter",
						"type": "String"
					},
					{
						"name": "SvcCenterNumber",
						"type": "String"
					},
					{
						"name": "SvcComplaintCode",
						"type": "String"
					},
					{
						"name": "SvcComplaintDesc",
						"type": "String"
					},
					{
						"name": "SvcDatePurchased",
						"type": "String"
					},
					{
						"name": "SvcDealerCode",
						"type": "String"
					},
					{
						"name": "SvcDealerDesc",
						"type": "String"
					},
					{
						"name": "SvcDistributorNumber",
						"type": "String"
					},
					{
						"name": "SvcInWarranty",
						"type": "String"
					},
					{
						"name": "SvcMfgCodeEiaNumber",
						"type": "String"
					},
					{
						"name": "SvcMicroLeak",
						"type": "String"
					},
					{
						"name": "SvcMiles",
						"type": "String"
					},
					{
						"name": "SvcMilesRate",
						"type": "String"
					},
					{
						"name": "SvcMilesTotal",
						"type": "String"
					},
					{
						"name": "SvcModel",
						"type": "String"
					},
					{
						"name": "SvcMotorNewNumber",
						"type": "String"
					},
					{
						"name": "SvcMotorOldNumber",
						"type": "String"
					},
					{
						"name": "SvcPerformedCode",
						"type": "String"
					},
					{
						"name": "SvcPerformedDesc",
						"type": "String"
					},
					{
						"name": "SvcProduct",
						"type": "String"
					},
					{
						"name": "SvcProductCode",
						"type": "String"
					},
					{
						"name": "SvcRepairCatMinorMajor",
						"type": "String"
					},
					{
						"name": "SvcRepairCategory",
						"type": "String"
					},
					{
						"name": "SvcRepairCode",
						"type": "String"
					},
					{
						"name": "SvcRunNumber",
						"type": "String"
					},
					{
						"name": "SvcSerial",
						"type": "String"
					},
					{
						"name": "SvcSpecAuthNumber",
						"type": "String"
					},
					{
						"name": "SvcStockMerchandise",
						"type": "String"
					},
					{
						"name": "SvcTimeCompleted1",
						"type": "String"
					},
					{
						"name": "SvcTimeCompleted2",
						"type": "String"
					},
					{
						"name": "SvcTimeOnJob1",
						"type": "String"
					},
					{
						"name": "SvcTimeOnJob2",
						"type": "String"
					},
					{
						"name": "SvcTimeStarted1",
						"type": "String"
					},
					{
						"name": "SvcTimeStarted2",
						"type": "String"
					},
					{
						"name": "Tax1Exempt",
						"type": "String"
					},
					{
						"name": "Tax1Total",
						"type": "String"
					},
					{
						"name": "Tax2Code",
						"type": "String"
					},
					{
						"name": "Tax2Exempt",
						"type": "String"
					},
					{
						"name": "Tax2Percentage",
						"type": "String"
					},
					{
						"name": "Tax2Total",
						"type": "String"
					},
					{
						"name": "Tax3Exempt",
						"type": "String"
					},
					{
						"name": "Tax3Total",
						"type": "String"
					},
					{
						"name": "UserCreated",
						"type": "String"
					},
					{
						"name": "UserModified",
						"type": "String"
					},
					{
						"name": "Warranty",
						"type": "String"
					},
					{
						"name": "WarrantyField1",
						"type": "String"
					},
					{
						"name": "WarrantyField2",
						"type": "String"
					},
					{
						"name": "WarrantyField3",
						"type": "String"
					},
					{
						"name": "WarrantyField4",
						"type": "String"
					},
					{
						"name": "WarrantyField5",
						"type": "String"
					},
					{
						"name": "WtyTotal",
						"type": "String"
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DestinationDataset_hdo')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1LinkedService_Test",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"TableName": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Financed",
						"type": "bit"
					},
					{
						"name": "Void",
						"type": "bit"
					},
					{
						"name": "Qualification",
						"type": "varchar"
					},
					{
						"name": "Priority",
						"type": "varchar"
					},
					{
						"name": "Tax3Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcRepairCode1",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode2",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode3",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode4",
						"type": "varchar"
					},
					{
						"name": "ContractCode",
						"type": "varchar"
					},
					{
						"name": "SvcContract",
						"type": "varchar"
					},
					{
						"name": "UserFinished",
						"type": "varchar"
					},
					{
						"name": "UserPosted",
						"type": "varchar"
					},
					{
						"name": "UpdateHistoryWarranty",
						"type": "bit"
					},
					{
						"name": "ShipMethod",
						"type": "varchar"
					},
					{
						"name": "TimeCreated",
						"type": "varchar"
					},
					{
						"name": "TimeModified",
						"type": "varchar"
					},
					{
						"name": "TimeFinished",
						"type": "varchar"
					},
					{
						"name": "DispatchUnits",
						"type": "int",
						"precision": 10
					},
					{
						"name": "EDIDateStamp",
						"type": "date"
					},
					{
						"name": "EDITimeStamp",
						"type": "varchar"
					},
					{
						"name": "PrintMethod",
						"type": "varchar"
					},
					{
						"name": "DispatchStartTime",
						"type": "varchar"
					},
					{
						"name": "TripChargeCode",
						"type": "varchar"
					},
					{
						"name": "TripChargeAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Locked",
						"type": "bit"
					},
					{
						"name": "MobileTechInvoiceCode",
						"type": "varchar"
					},
					{
						"name": "ServiceRequestID",
						"type": "varchar"
					},
					{
						"name": "CarrierCode",
						"type": "varchar"
					},
					{
						"name": "ShipViaCode",
						"type": "varchar"
					},
					{
						"name": "JobStatusUpdate",
						"type": "bit"
					},
					{
						"name": "DispatchEmail",
						"type": "bit"
					},
					{
						"name": "LastDateSaved",
						"type": "date"
					},
					{
						"name": "LastTimeSaved",
						"type": "varchar"
					},
					{
						"name": "Terms",
						"type": "varchar"
					},
					{
						"name": "SvcEquipmentNumber",
						"type": "varchar"
					},
					{
						"name": "WebOrderID",
						"type": "varchar"
					},
					{
						"name": "Department",
						"type": "varchar"
					},
					{
						"name": "CreditStatusCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedUserCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedDateStamp",
						"type": "date"
					},
					{
						"name": "CreditApprovedTimeStamp",
						"type": "varchar"
					},
					{
						"name": "EDIMaroline",
						"type": "bit"
					},
					{
						"name": "RequestedDate",
						"type": "date"
					},
					{
						"name": "SvcCSRInvoice",
						"type": "varchar"
					},
					{
						"name": "SvcSoldList",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcSoldSTDCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcFollowUpDate",
						"type": "date"
					},
					{
						"name": "SvcScheduleDate",
						"type": "date"
					},
					{
						"name": "Tax2MaxAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "EDIWhirlpool",
						"type": "bit"
					},
					{
						"name": "MinDepositPercent",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UnitModifier",
						"type": "int",
						"precision": 10
					},
					{
						"name": "DateFinished",
						"type": "date"
					},
					{
						"name": "DatePosted",
						"type": "date"
					},
					{
						"name": "TimePosted",
						"type": "varchar"
					},
					{
						"name": "TTRTaxCalculated",
						"type": "bit"
					},
					{
						"name": "PickUpBranchCode",
						"type": "varchar"
					},
					{
						"name": "PodiumOptOut",
						"type": "bit"
					},
					{
						"name": "SignCustmizedFields",
						"type": "varchar"
					},
					{
						"name": "AVBSaleDateSent",
						"type": "date"
					},
					{
						"name": "AVBSaleTimeSent",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "TTRJurisdictionCode",
						"type": "varchar"
					},
					{
						"name": "BranchCode",
						"type": "varchar"
					},
					{
						"name": "COGSPosted",
						"type": "bit"
					},
					{
						"name": "CallSequence",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "CommittedPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "DateCreated",
						"type": "date"
					},
					{
						"name": "DateModified",
						"type": "date"
					},
					{
						"name": "DispatchPriority",
						"type": "varchar"
					},
					{
						"name": "DispatchRequestedRouteCode",
						"type": "varchar"
					},
					{
						"name": "DispatchSpecRequest",
						"type": "varchar"
					},
					{
						"name": "DispatchTime",
						"type": "varchar"
					},
					{
						"name": "DispatchTimeAM",
						"type": "varchar"
					},
					{
						"name": "Estimate",
						"type": "varchar"
					},
					{
						"name": "Field1",
						"type": "varchar"
					},
					{
						"name": "Field2",
						"type": "varchar"
					},
					{
						"name": "Field3",
						"type": "varchar"
					},
					{
						"name": "Field4",
						"type": "varchar"
					},
					{
						"name": "Field5",
						"type": "varchar"
					},
					{
						"name": "InvFinishDate",
						"type": "date"
					},
					{
						"name": "InvStartDate",
						"type": "date"
					},
					{
						"name": "InvTypeCode",
						"type": "varchar"
					},
					{
						"name": "ItemListPriceCode",
						"type": "varchar"
					},
					{
						"name": "ItemTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "JobLocation",
						"type": "varchar"
					},
					{
						"name": "JobNumber",
						"type": "varchar"
					},
					{
						"name": "JobStatusCode",
						"type": "varchar"
					},
					{
						"name": "LaborRate",
						"type": "varchar"
					},
					{
						"name": "LaborTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "MapReference",
						"type": "varchar"
					},
					{
						"name": "MapZoneCode",
						"type": "varchar"
					},
					{
						"name": "MiscTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OpenPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OtherListPriceCode",
						"type": "varchar"
					},
					{
						"name": "PONumber",
						"type": "varchar"
					},
					{
						"name": "PaymentTypeCode",
						"type": "varchar"
					},
					{
						"name": "PickUpDate",
						"type": "date"
					},
					{
						"name": "Reference",
						"type": "varchar"
					},
					{
						"name": "SaleReferralCode",
						"type": "varchar"
					},
					{
						"name": "Salesperson1Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "ScheduleDate",
						"type": "date"
					},
					{
						"name": "SerialListPriceCode",
						"type": "varchar"
					},
					{
						"name": "SerialTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "SvcAgreementExpDate",
						"type": "date"
					},
					{
						"name": "SvcAgreementNumber",
						"type": "varchar"
					},
					{
						"name": "SvcBrandCode",
						"type": "varchar"
					},
					{
						"name": "SvcCenter",
						"type": "varchar"
					},
					{
						"name": "SvcCenterNumber",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintCode",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDatePurchased",
						"type": "date"
					},
					{
						"name": "SvcDealerCode",
						"type": "varchar"
					},
					{
						"name": "SvcDealerDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDistributorNumber",
						"type": "varchar"
					},
					{
						"name": "SvcInWarranty",
						"type": "varchar"
					},
					{
						"name": "SvcMfgCodeEiaNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMicroLeak",
						"type": "varchar"
					},
					{
						"name": "SvcMiles",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesRate",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcModel",
						"type": "varchar"
					},
					{
						"name": "SvcMotorNewNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMotorOldNumber",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedCode",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedDesc",
						"type": "varchar"
					},
					{
						"name": "SvcProduct",
						"type": "varchar"
					},
					{
						"name": "SvcProductCode",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCatMinorMajor",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCategory",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode",
						"type": "varchar"
					},
					{
						"name": "SvcRunNumber",
						"type": "varchar"
					},
					{
						"name": "SvcSerial",
						"type": "varchar"
					},
					{
						"name": "SvcSpecAuthNumber",
						"type": "varchar"
					},
					{
						"name": "SvcStockMerchandise",
						"type": "bit"
					},
					{
						"name": "SvcTimeCompleted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeCompleted2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted2",
						"type": "varchar"
					},
					{
						"name": "Tax1Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax1Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Code",
						"type": "varchar"
					},
					{
						"name": "Tax2Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax3Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax3Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UserCreated",
						"type": "varchar"
					},
					{
						"name": "UserModified",
						"type": "varchar"
					},
					{
						"name": "Warranty",
						"type": "varchar"
					},
					{
						"name": "WarrantyField1",
						"type": "varchar"
					},
					{
						"name": "WarrantyField2",
						"type": "varchar"
					},
					{
						"name": "WarrantyField3",
						"type": "varchar"
					},
					{
						"name": "WarrantyField4",
						"type": "varchar"
					},
					{
						"name": "WarrantyField5",
						"type": "varchar"
					},
					{
						"name": "WtyTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": {
						"value": "Invoice",
						"type": "Expression"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/DestinationDataset_invoiceaddress')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1LinkedService_Test",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"TableName": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Financed",
						"type": "bit"
					},
					{
						"name": "Void",
						"type": "bit"
					},
					{
						"name": "Qualification",
						"type": "varchar"
					},
					{
						"name": "Priority",
						"type": "varchar"
					},
					{
						"name": "Tax3Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcRepairCode1",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode2",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode3",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode4",
						"type": "varchar"
					},
					{
						"name": "ContractCode",
						"type": "varchar"
					},
					{
						"name": "SvcContract",
						"type": "varchar"
					},
					{
						"name": "UserFinished",
						"type": "varchar"
					},
					{
						"name": "UserPosted",
						"type": "varchar"
					},
					{
						"name": "UpdateHistoryWarranty",
						"type": "bit"
					},
					{
						"name": "ShipMethod",
						"type": "varchar"
					},
					{
						"name": "TimeCreated",
						"type": "varchar"
					},
					{
						"name": "TimeModified",
						"type": "varchar"
					},
					{
						"name": "TimeFinished",
						"type": "varchar"
					},
					{
						"name": "DispatchUnits",
						"type": "int",
						"precision": 10
					},
					{
						"name": "EDIDateStamp",
						"type": "date"
					},
					{
						"name": "EDITimeStamp",
						"type": "varchar"
					},
					{
						"name": "PrintMethod",
						"type": "varchar"
					},
					{
						"name": "DispatchStartTime",
						"type": "varchar"
					},
					{
						"name": "TripChargeCode",
						"type": "varchar"
					},
					{
						"name": "TripChargeAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Locked",
						"type": "bit"
					},
					{
						"name": "MobileTechInvoiceCode",
						"type": "varchar"
					},
					{
						"name": "ServiceRequestID",
						"type": "varchar"
					},
					{
						"name": "CarrierCode",
						"type": "varchar"
					},
					{
						"name": "ShipViaCode",
						"type": "varchar"
					},
					{
						"name": "JobStatusUpdate",
						"type": "bit"
					},
					{
						"name": "DispatchEmail",
						"type": "bit"
					},
					{
						"name": "LastDateSaved",
						"type": "date"
					},
					{
						"name": "LastTimeSaved",
						"type": "varchar"
					},
					{
						"name": "Terms",
						"type": "varchar"
					},
					{
						"name": "SvcEquipmentNumber",
						"type": "varchar"
					},
					{
						"name": "WebOrderID",
						"type": "varchar"
					},
					{
						"name": "Department",
						"type": "varchar"
					},
					{
						"name": "CreditStatusCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedUserCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedDateStamp",
						"type": "date"
					},
					{
						"name": "CreditApprovedTimeStamp",
						"type": "varchar"
					},
					{
						"name": "EDIMaroline",
						"type": "bit"
					},
					{
						"name": "RequestedDate",
						"type": "date"
					},
					{
						"name": "SvcCSRInvoice",
						"type": "varchar"
					},
					{
						"name": "SvcSoldList",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcSoldSTDCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcFollowUpDate",
						"type": "date"
					},
					{
						"name": "SvcScheduleDate",
						"type": "date"
					},
					{
						"name": "Tax2MaxAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "EDIWhirlpool",
						"type": "bit"
					},
					{
						"name": "MinDepositPercent",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UnitModifier",
						"type": "int",
						"precision": 10
					},
					{
						"name": "DateFinished",
						"type": "date"
					},
					{
						"name": "DatePosted",
						"type": "date"
					},
					{
						"name": "TimePosted",
						"type": "varchar"
					},
					{
						"name": "TTRTaxCalculated",
						"type": "bit"
					},
					{
						"name": "PickUpBranchCode",
						"type": "varchar"
					},
					{
						"name": "PodiumOptOut",
						"type": "bit"
					},
					{
						"name": "SignCustmizedFields",
						"type": "varchar"
					},
					{
						"name": "AVBSaleDateSent",
						"type": "date"
					},
					{
						"name": "AVBSaleTimeSent",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "TTRJurisdictionCode",
						"type": "varchar"
					},
					{
						"name": "BranchCode",
						"type": "varchar"
					},
					{
						"name": "COGSPosted",
						"type": "bit"
					},
					{
						"name": "CallSequence",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "CommittedPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "DateCreated",
						"type": "date"
					},
					{
						"name": "DateModified",
						"type": "date"
					},
					{
						"name": "DispatchPriority",
						"type": "varchar"
					},
					{
						"name": "DispatchRequestedRouteCode",
						"type": "varchar"
					},
					{
						"name": "DispatchSpecRequest",
						"type": "varchar"
					},
					{
						"name": "DispatchTime",
						"type": "varchar"
					},
					{
						"name": "DispatchTimeAM",
						"type": "varchar"
					},
					{
						"name": "Estimate",
						"type": "varchar"
					},
					{
						"name": "Field1",
						"type": "varchar"
					},
					{
						"name": "Field2",
						"type": "varchar"
					},
					{
						"name": "Field3",
						"type": "varchar"
					},
					{
						"name": "Field4",
						"type": "varchar"
					},
					{
						"name": "Field5",
						"type": "varchar"
					},
					{
						"name": "InvFinishDate",
						"type": "date"
					},
					{
						"name": "InvStartDate",
						"type": "date"
					},
					{
						"name": "InvTypeCode",
						"type": "varchar"
					},
					{
						"name": "ItemListPriceCode",
						"type": "varchar"
					},
					{
						"name": "ItemTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "JobLocation",
						"type": "varchar"
					},
					{
						"name": "JobNumber",
						"type": "varchar"
					},
					{
						"name": "JobStatusCode",
						"type": "varchar"
					},
					{
						"name": "LaborRate",
						"type": "varchar"
					},
					{
						"name": "LaborTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "MapReference",
						"type": "varchar"
					},
					{
						"name": "MapZoneCode",
						"type": "varchar"
					},
					{
						"name": "MiscTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OpenPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OtherListPriceCode",
						"type": "varchar"
					},
					{
						"name": "PONumber",
						"type": "varchar"
					},
					{
						"name": "PaymentTypeCode",
						"type": "varchar"
					},
					{
						"name": "PickUpDate",
						"type": "date"
					},
					{
						"name": "Reference",
						"type": "varchar"
					},
					{
						"name": "SaleReferralCode",
						"type": "varchar"
					},
					{
						"name": "Salesperson1Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "ScheduleDate",
						"type": "date"
					},
					{
						"name": "SerialListPriceCode",
						"type": "varchar"
					},
					{
						"name": "SerialTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "SvcAgreementExpDate",
						"type": "date"
					},
					{
						"name": "SvcAgreementNumber",
						"type": "varchar"
					},
					{
						"name": "SvcBrandCode",
						"type": "varchar"
					},
					{
						"name": "SvcCenter",
						"type": "varchar"
					},
					{
						"name": "SvcCenterNumber",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintCode",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDatePurchased",
						"type": "date"
					},
					{
						"name": "SvcDealerCode",
						"type": "varchar"
					},
					{
						"name": "SvcDealerDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDistributorNumber",
						"type": "varchar"
					},
					{
						"name": "SvcInWarranty",
						"type": "varchar"
					},
					{
						"name": "SvcMfgCodeEiaNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMicroLeak",
						"type": "varchar"
					},
					{
						"name": "SvcMiles",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesRate",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcModel",
						"type": "varchar"
					},
					{
						"name": "SvcMotorNewNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMotorOldNumber",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedCode",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedDesc",
						"type": "varchar"
					},
					{
						"name": "SvcProduct",
						"type": "varchar"
					},
					{
						"name": "SvcProductCode",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCatMinorMajor",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCategory",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode",
						"type": "varchar"
					},
					{
						"name": "SvcRunNumber",
						"type": "varchar"
					},
					{
						"name": "SvcSerial",
						"type": "varchar"
					},
					{
						"name": "SvcSpecAuthNumber",
						"type": "varchar"
					},
					{
						"name": "SvcStockMerchandise",
						"type": "bit"
					},
					{
						"name": "SvcTimeCompleted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeCompleted2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted2",
						"type": "varchar"
					},
					{
						"name": "Tax1Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax1Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Code",
						"type": "varchar"
					},
					{
						"name": "Tax2Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax3Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax3Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UserCreated",
						"type": "varchar"
					},
					{
						"name": "UserModified",
						"type": "varchar"
					},
					{
						"name": "Warranty",
						"type": "varchar"
					},
					{
						"name": "WarrantyField1",
						"type": "varchar"
					},
					{
						"name": "WarrantyField2",
						"type": "varchar"
					},
					{
						"name": "WarrantyField3",
						"type": "varchar"
					},
					{
						"name": "WarrantyField4",
						"type": "varchar"
					},
					{
						"name": "WarrantyField5",
						"type": "varchar"
					},
					{
						"name": "WtyTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": {
						"value": "InvoiceAddress",
						"type": "Expression"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/InvoiceAddressControlTableDataset')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1LinkedService_Test",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "watermark_value",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "invoiceaddresswatermark_table"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/InvoiceAddressODS')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1LinkedService_Test",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "TripNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ParentDateStamp",
						"type": "date"
					},
					{
						"name": "ParentLineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "Amount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "DateStamp",
						"type": "date"
					},
					{
						"name": "Description",
						"type": "varchar"
					},
					{
						"name": "InPackage",
						"type": "varchar"
					},
					{
						"name": "InvoiceCode",
						"type": "varchar"
					},
					{
						"name": "LineNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "LineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "LineType",
						"type": "varchar"
					},
					{
						"name": "LocationCode",
						"type": "varchar"
					},
					{
						"name": "Qty",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "Tax1",
						"type": "bit"
					},
					{
						"name": "Tax2",
						"type": "bit"
					},
					{
						"name": "Tax3",
						"type": "bit"
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "InvoiceAddress"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/InvoiceAddressODS_Sink')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1LinkedService_Test",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "TripNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ParentDateStamp",
						"type": "date"
					},
					{
						"name": "ParentLineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "Amount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "DateStamp",
						"type": "date"
					},
					{
						"name": "Description",
						"type": "varchar"
					},
					{
						"name": "InPackage",
						"type": "varchar"
					},
					{
						"name": "InvoiceCode",
						"type": "varchar"
					},
					{
						"name": "LineNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "LineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "LineType",
						"type": "varchar"
					},
					{
						"name": "LocationCode",
						"type": "varchar"
					},
					{
						"name": "Qty",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "Tax1",
						"type": "bit"
					},
					{
						"name": "Tax2",
						"type": "bit"
					},
					{
						"name": "Tax3",
						"type": "bit"
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "InvoiceAddress"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/InvoiceMiscODS')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1LinkedService_Test",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "TakenStatus",
						"type": "varchar"
					},
					{
						"name": "TakenDate",
						"type": "date"
					},
					{
						"name": "AverageCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "StandardCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "LastCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Color",
						"type": "varchar"
					},
					{
						"name": "POCode",
						"type": "varchar"
					},
					{
						"name": "Reference",
						"type": "varchar"
					},
					{
						"name": "PODateStamp",
						"type": "date"
					},
					{
						"name": "POLineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "SpecialOrderDate",
						"type": "date"
					},
					{
						"name": "TripNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "LandedCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "AutoBackorder",
						"type": "bit"
					},
					{
						"name": "ManufacturersWarranty",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ReplacementCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UserVerified",
						"type": "varchar"
					},
					{
						"name": "DateVerified",
						"type": "date"
					},
					{
						"name": "TimeVerified",
						"type": "varchar"
					},
					{
						"name": "OriginalCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "ReserveExclusive",
						"type": "bit"
					},
					{
						"name": "CommissionCode",
						"type": "varchar"
					},
					{
						"name": "EDIFormat",
						"type": "varchar"
					},
					{
						"name": "BranchCode",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "DateCreated",
						"type": "date"
					},
					{
						"name": "DateModified",
						"type": "date"
					},
					{
						"name": "DateStamp",
						"type": "date"
					},
					{
						"name": "InPackage",
						"type": "bit"
					},
					{
						"name": "InvoiceCode",
						"type": "varchar"
					},
					{
						"name": "LineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "LocationCode",
						"type": "varchar"
					},
					{
						"name": "ModelCode",
						"type": "varchar"
					},
					{
						"name": "ModelDesc",
						"type": "varchar"
					},
					{
						"name": "NewUsed",
						"type": "varchar"
					},
					{
						"name": "QtyOrdered",
						"type": "int",
						"precision": 10
					},
					{
						"name": "QtyReserved",
						"type": "int",
						"precision": 10
					},
					{
						"name": "QtyShipped",
						"type": "int",
						"precision": 10
					},
					{
						"name": "SellingPrice",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Spiff",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "Tax1",
						"type": "bit"
					},
					{
						"name": "Tax1CostList",
						"type": "varchar"
					},
					{
						"name": "Tax1Included",
						"type": "bit"
					},
					{
						"name": "Tax1Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2",
						"type": "bit"
					},
					{
						"name": "Tax3",
						"type": "bit"
					},
					{
						"name": "Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UserCreated",
						"type": "varchar"
					},
					{
						"name": "UserModified",
						"type": "varchar"
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "InvoiceMisc"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/InvoiceModelControlTableDataset')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1LinkedService_Test",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "watermark_value",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "invoicemodelwatermark_table"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/InvoiceModelODS')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1LinkedService_Test",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "TakenStatus",
						"type": "varchar"
					},
					{
						"name": "TakenDate",
						"type": "date"
					},
					{
						"name": "AverageCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "StandardCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "LastCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Color",
						"type": "varchar"
					},
					{
						"name": "POCode",
						"type": "varchar"
					},
					{
						"name": "Reference",
						"type": "varchar"
					},
					{
						"name": "PODateStamp",
						"type": "date"
					},
					{
						"name": "POLineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "SpecialOrderDate",
						"type": "date"
					},
					{
						"name": "TripNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "LandedCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "AutoBackorder",
						"type": "bit"
					},
					{
						"name": "ManufacturersWarranty",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ReplacementCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UserVerified",
						"type": "varchar"
					},
					{
						"name": "DateVerified",
						"type": "date"
					},
					{
						"name": "TimeVerified",
						"type": "varchar"
					},
					{
						"name": "OriginalCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "ReserveExclusive",
						"type": "bit"
					},
					{
						"name": "CommissionCode",
						"type": "varchar"
					},
					{
						"name": "EDIFormat",
						"type": "varchar"
					},
					{
						"name": "BranchCode",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "DateCreated",
						"type": "date"
					},
					{
						"name": "DateModified",
						"type": "date"
					},
					{
						"name": "DateStamp",
						"type": "date"
					},
					{
						"name": "InPackage",
						"type": "bit"
					},
					{
						"name": "InvoiceCode",
						"type": "varchar"
					},
					{
						"name": "LineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "LocationCode",
						"type": "varchar"
					},
					{
						"name": "ModelCode",
						"type": "varchar"
					},
					{
						"name": "ModelDesc",
						"type": "varchar"
					},
					{
						"name": "NewUsed",
						"type": "varchar"
					},
					{
						"name": "QtyOrdered",
						"type": "int",
						"precision": 10
					},
					{
						"name": "QtyReserved",
						"type": "int",
						"precision": 10
					},
					{
						"name": "QtyShipped",
						"type": "int",
						"precision": 10
					},
					{
						"name": "SellingPrice",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Spiff",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "Tax1",
						"type": "bit"
					},
					{
						"name": "Tax1CostList",
						"type": "varchar"
					},
					{
						"name": "Tax1Included",
						"type": "bit"
					},
					{
						"name": "Tax1Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2",
						"type": "bit"
					},
					{
						"name": "Tax3",
						"type": "bit"
					},
					{
						"name": "Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UserCreated",
						"type": "varchar"
					},
					{
						"name": "UserModified",
						"type": "varchar"
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "InvoiceModel"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/InvoicePaymentODS')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1LinkedService_Test",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "TripNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ParentDateStamp",
						"type": "date"
					},
					{
						"name": "ParentLineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "Amount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "DateStamp",
						"type": "date"
					},
					{
						"name": "Description",
						"type": "varchar"
					},
					{
						"name": "InPackage",
						"type": "varchar"
					},
					{
						"name": "InvoiceCode",
						"type": "varchar"
					},
					{
						"name": "LineNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "LineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "LineType",
						"type": "varchar"
					},
					{
						"name": "LocationCode",
						"type": "varchar"
					},
					{
						"name": "Qty",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "Tax1",
						"type": "bit"
					},
					{
						"name": "Tax2",
						"type": "bit"
					},
					{
						"name": "Tax3",
						"type": "bit"
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "InvoicePayment"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/InvoiceSerialODS')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1LinkedService_Test",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "TripNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ParentDateStamp",
						"type": "date"
					},
					{
						"name": "ParentLineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "Amount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "DateStamp",
						"type": "date"
					},
					{
						"name": "Description",
						"type": "varchar"
					},
					{
						"name": "InPackage",
						"type": "varchar"
					},
					{
						"name": "InvoiceCode",
						"type": "varchar"
					},
					{
						"name": "LineNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "LineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "LineType",
						"type": "varchar"
					},
					{
						"name": "LocationCode",
						"type": "varchar"
					},
					{
						"name": "Qty",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "Tax1",
						"type": "bit"
					},
					{
						"name": "Tax2",
						"type": "bit"
					},
					{
						"name": "Tax3",
						"type": "bit"
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "InvoiceSerial"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/InvoiceWarrantyODS')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1LinkedService_Test",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "TripNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ParentDateStamp",
						"type": "date"
					},
					{
						"name": "ParentLineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "Amount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "DateStamp",
						"type": "date"
					},
					{
						"name": "Description",
						"type": "varchar"
					},
					{
						"name": "InPackage",
						"type": "varchar"
					},
					{
						"name": "InvoiceCode",
						"type": "varchar"
					},
					{
						"name": "LineNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "LineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "LineType",
						"type": "varchar"
					},
					{
						"name": "LocationCode",
						"type": "varchar"
					},
					{
						"name": "Qty",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "Tax1",
						"type": "bit"
					},
					{
						"name": "Tax2",
						"type": "bit"
					},
					{
						"name": "Tax3",
						"type": "bit"
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "InvoiceWarranty"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Invoice_CSV')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Testblobstorage1",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"container": "loadtest"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "55",
						"type": "String"
					},
					{
						"name": "False1",
						"type": "String"
					},
					{
						"name": "False2",
						"type": "String"
					},
					{
						"name": "Prop_3",
						"type": "String"
					},
					{
						"name": "Prop_4",
						"type": "String"
					},
					{
						"name": "0.00005",
						"type": "String"
					},
					{
						"name": "Prop_6",
						"type": "String"
					},
					{
						"name": "Prop_7",
						"type": "String"
					},
					{
						"name": "Prop_8",
						"type": "String"
					},
					{
						"name": "Prop_9",
						"type": "String"
					},
					{
						"name": "Prop_10",
						"type": "String"
					},
					{
						"name": "Prop_11",
						"type": "String"
					},
					{
						"name": "Prop_12",
						"type": "String"
					},
					{
						"name": "Prop_13",
						"type": "String"
					},
					{
						"name": "False14",
						"type": "String"
					},
					{
						"name": "Complete Ship",
						"type": "String"
					},
					{
						"name": "Prop_16",
						"type": "String"
					},
					{
						"name": "08:00",
						"type": "String"
					},
					{
						"name": "Prop_18",
						"type": "String"
					},
					{
						"name": "1",
						"type": "String"
					},
					{
						"name": "Prop_20",
						"type": "String"
					},
					{
						"name": "Prop_21",
						"type": "String"
					},
					{
						"name": "Invoice",
						"type": "String"
					},
					{
						"name": "07:00",
						"type": "String"
					},
					{
						"name": "Prop_24",
						"type": "String"
					},
					{
						"name": "0.000025",
						"type": "String"
					},
					{
						"name": "False26",
						"type": "String"
					},
					{
						"name": "Prop_27",
						"type": "String"
					},
					{
						"name": "Prop_28",
						"type": "String"
					},
					{
						"name": "Prop_29",
						"type": "String"
					},
					{
						"name": "Coast",
						"type": "String"
					},
					{
						"name": "False31",
						"type": "String"
					},
					{
						"name": "False32",
						"type": "String"
					},
					{
						"name": "Prop_33",
						"type": "String"
					},
					{
						"name": "Prop_34",
						"type": "String"
					},
					{
						"name": "Prop_35",
						"type": "String"
					},
					{
						"name": "Prop_36",
						"type": "String"
					},
					{
						"name": "Prop_37",
						"type": "String"
					},
					{
						"name": "VAUGHAN",
						"type": "String"
					},
					{
						"name": "APPROVED",
						"type": "String"
					},
					{
						"name": "CONV",
						"type": "String"
					},
					{
						"name": "2018-02-03 00:00:00.0000000",
						"type": "String"
					},
					{
						"name": "02:50",
						"type": "String"
					},
					{
						"name": "False43",
						"type": "String"
					},
					{
						"name": "Prop_44",
						"type": "String"
					},
					{
						"name": "Prop_45",
						"type": "String"
					},
					{
						"name": "0.000046",
						"type": "String"
					},
					{
						"name": "0.000047",
						"type": "String"
					},
					{
						"name": "Prop_48",
						"type": "String"
					},
					{
						"name": "Prop_49",
						"type": "String"
					},
					{
						"name": "Prop_50",
						"type": "String"
					},
					{
						"name": "Prop_51",
						"type": "String"
					},
					{
						"name": "25.0000",
						"type": "String"
					},
					{
						"name": "053",
						"type": "String"
					},
					{
						"name": "Prop_54",
						"type": "String"
					},
					{
						"name": "Prop_55",
						"type": "String"
					},
					{
						"name": "Prop_56",
						"type": "String"
					},
					{
						"name": "False57",
						"type": "String"
					},
					{
						"name": "Prop_58",
						"type": "String"
					},
					{
						"name": "False59",
						"type": "String"
					},
					{
						"name": "Prop_60",
						"type": "String"
					},
					{
						"name": "Prop_61",
						"type": "String"
					},
					{
						"name": "Prop_62",
						"type": "String"
					},
					{
						"name": "2016-02-06 00:00:00.000000063",
						"type": "String"
					},
					{
						"name": "2021-04-30 08:00:32.0000000",
						"type": "String"
					},
					{
						"name": "Prop_65",
						"type": "String"
					},
					{
						"name": "510",
						"type": "String"
					},
					{
						"name": "False67",
						"type": "String"
					},
					{
						"name": "068",
						"type": "String"
					},
					{
						"name": "             1650741",
						"type": "String"
					},
					{
						"name": "500.0000",
						"type": "String"
					},
					{
						"name": "2016-02-06 00:00:00.000000071",
						"type": "String"
					},
					{
						"name": "2021-04-30 00:00:00.000000072",
						"type": "String"
					},
					{
						"name": "Prop_73",
						"type": "String"
					},
					{
						"name": "Prop_74",
						"type": "String"
					},
					{
						"name": "Prop_75",
						"type": "String"
					},
					{
						"name": "00:00",
						"type": "String"
					},
					{
						"name": "Prop_77",
						"type": "String"
					},
					{
						"name": "Neither78",
						"type": "String"
					},
					{
						"name": "513",
						"type": "String"
					},
					{
						"name": "080",
						"type": "String"
					},
					{
						"name": "Prop_81",
						"type": "String"
					},
					{
						"name": "Prop_82",
						"type": "String"
					},
					{
						"name": "Prop_83",
						"type": "String"
					},
					{
						"name": "2021-04-30 00:00:00.000000084",
						"type": "String"
					},
					{
						"name": "2016-02-06 00:00:00.000000085",
						"type": "String"
					},
					{
						"name": "UP",
						"type": "String"
					},
					{
						"name": "CSP87",
						"type": "String"
					},
					{
						"name": "0.000088",
						"type": "String"
					},
					{
						"name": "Prop_89",
						"type": "String"
					},
					{
						"name": "Prop_90",
						"type": "String"
					},
					{
						"name": "UNCONFIRMED",
						"type": "String"
					},
					{
						"name": "Rate 1",
						"type": "String"
					},
					{
						"name": "0.000093",
						"type": "String"
					},
					{
						"name": "Prop_94",
						"type": "String"
					},
					{
						"name": "ON",
						"type": "String"
					},
					{
						"name": "-2265.0000",
						"type": "String"
					},
					{
						"name": "0.000097",
						"type": "String"
					},
					{
						"name": "CSP98",
						"type": "String"
					},
					{
						"name": "Prop_99",
						"type": "String"
					},
					{
						"name": "COD",
						"type": "String"
					},
					{
						"name": "Prop_101",
						"type": "String"
					},
					{
						"name": "Prop_102",
						"type": "String"
					},
					{
						"name": "ZUPGR",
						"type": "String"
					},
					{
						"name": "03045",
						"type": "String"
					},
					{
						"name": "Prop_105",
						"type": "String"
					},
					{
						"name": "0.0000106",
						"type": "String"
					},
					{
						"name": "2021-07-30 00:00:00.0000000",
						"type": "String"
					},
					{
						"name": "CSP108",
						"type": "String"
					},
					{
						"name": "4565.0000",
						"type": "String"
					},
					{
						"name": "Open",
						"type": "String"
					},
					{
						"name": "Prop_111",
						"type": "String"
					},
					{
						"name": "Prop_112",
						"type": "String"
					},
					{
						"name": "Prop_113",
						"type": "String"
					},
					{
						"name": "Prop_114",
						"type": "String"
					},
					{
						"name": "Prop_115",
						"type": "String"
					},
					{
						"name": "Prop_116",
						"type": "String"
					},
					{
						"name": "Prop_117",
						"type": "String"
					},
					{
						"name": "Prop_118",
						"type": "String"
					},
					{
						"name": "Prop_119",
						"type": "String"
					},
					{
						"name": "Prop_120",
						"type": "String"
					},
					{
						"name": "Prop_121",
						"type": "String"
					},
					{
						"name": "No Warranty",
						"type": "String"
					},
					{
						"name": "Prop_123",
						"type": "String"
					},
					{
						"name": "Prop_124",
						"type": "String"
					},
					{
						"name": "0.0000125",
						"type": "String"
					},
					{
						"name": "0.0000126",
						"type": "String"
					},
					{
						"name": "0.0000127",
						"type": "String"
					},
					{
						"name": "Prop_128",
						"type": "String"
					},
					{
						"name": "Prop_129",
						"type": "String"
					},
					{
						"name": "Prop_130",
						"type": "String"
					},
					{
						"name": "Prop_131",
						"type": "String"
					},
					{
						"name": "Prop_132",
						"type": "String"
					},
					{
						"name": "Other",
						"type": "String"
					},
					{
						"name": "Prop_134",
						"type": "String"
					},
					{
						"name": "Major",
						"type": "String"
					},
					{
						"name": "Home service",
						"type": "String"
					},
					{
						"name": "Prop_137",
						"type": "String"
					},
					{
						"name": "Prop_138",
						"type": "String"
					},
					{
						"name": "Prop_139",
						"type": "String"
					},
					{
						"name": "Prop_140",
						"type": "String"
					},
					{
						"name": "False141",
						"type": "String"
					},
					{
						"name": "Prop_142",
						"type": "String"
					},
					{
						"name": "Prop_143",
						"type": "String"
					},
					{
						"name": "Prop_144",
						"type": "String"
					},
					{
						"name": "Prop_145",
						"type": "String"
					},
					{
						"name": "Prop_146",
						"type": "String"
					},
					{
						"name": "Prop_147",
						"type": "String"
					},
					{
						"name": "Prop_148",
						"type": "String"
					},
					{
						"name": "0.0000149",
						"type": "String"
					},
					{
						"name": "ONH",
						"type": "String"
					},
					{
						"name": "Prop_151",
						"type": "String"
					},
					{
						"name": "13.0000",
						"type": "String"
					},
					{
						"name": "299.0000",
						"type": "String"
					},
					{
						"name": "Prop_154",
						"type": "String"
					},
					{
						"name": "0.0000155",
						"type": "String"
					},
					{
						"name": "WWANA",
						"type": "String"
					},
					{
						"name": "02604",
						"type": "String"
					},
					{
						"name": "Neither158",
						"type": "String"
					},
					{
						"name": "Prop_159",
						"type": "String"
					},
					{
						"name": "Prop_160",
						"type": "String"
					},
					{
						"name": "Prop_161",
						"type": "String"
					},
					{
						"name": "Prop_162",
						"type": "String"
					},
					{
						"name": "Prop_163",
						"type": "String"
					},
					{
						"name": "0.0000164",
						"type": "String"
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Landing_BranchDataset')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1_Landing Linked Service",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Financed",
						"type": "bit"
					},
					{
						"name": "Void",
						"type": "bit"
					},
					{
						"name": "Qualification",
						"type": "varchar"
					},
					{
						"name": "Priority",
						"type": "varchar"
					},
					{
						"name": "Tax3Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcRepairCode1",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode2",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode3",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode4",
						"type": "varchar"
					},
					{
						"name": "ContractCode",
						"type": "varchar"
					},
					{
						"name": "SvcContract",
						"type": "varchar"
					},
					{
						"name": "UserFinished",
						"type": "varchar"
					},
					{
						"name": "UserPosted",
						"type": "varchar"
					},
					{
						"name": "UpdateHistoryWarranty",
						"type": "bit"
					},
					{
						"name": "ShipMethod",
						"type": "varchar"
					},
					{
						"name": "TimeCreated",
						"type": "varchar"
					},
					{
						"name": "TimeModified",
						"type": "varchar"
					},
					{
						"name": "TimeFinished",
						"type": "varchar"
					},
					{
						"name": "DispatchUnits",
						"type": "int",
						"precision": 10
					},
					{
						"name": "EDIDateStamp",
						"type": "date"
					},
					{
						"name": "EDITimeStamp",
						"type": "varchar"
					},
					{
						"name": "PrintMethod",
						"type": "varchar"
					},
					{
						"name": "DispatchStartTime",
						"type": "varchar"
					},
					{
						"name": "TripChargeCode",
						"type": "varchar"
					},
					{
						"name": "TripChargeAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Locked",
						"type": "bit"
					},
					{
						"name": "MobileTechInvoiceCode",
						"type": "varchar"
					},
					{
						"name": "ServiceRequestID",
						"type": "varchar"
					},
					{
						"name": "CarrierCode",
						"type": "varchar"
					},
					{
						"name": "ShipViaCode",
						"type": "varchar"
					},
					{
						"name": "JobStatusUpdate",
						"type": "bit"
					},
					{
						"name": "DispatchEmail",
						"type": "bit"
					},
					{
						"name": "LastDateSaved",
						"type": "date"
					},
					{
						"name": "LastTimeSaved",
						"type": "varchar"
					},
					{
						"name": "Terms",
						"type": "varchar"
					},
					{
						"name": "SvcEquipmentNumber",
						"type": "varchar"
					},
					{
						"name": "WebOrderID",
						"type": "varchar"
					},
					{
						"name": "Department",
						"type": "varchar"
					},
					{
						"name": "CreditStatusCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedUserCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedDateStamp",
						"type": "date"
					},
					{
						"name": "CreditApprovedTimeStamp",
						"type": "varchar"
					},
					{
						"name": "EDIMaroline",
						"type": "bit"
					},
					{
						"name": "RequestedDate",
						"type": "date"
					},
					{
						"name": "SvcCSRInvoice",
						"type": "varchar"
					},
					{
						"name": "SvcSoldList",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcSoldSTDCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcFollowUpDate",
						"type": "date"
					},
					{
						"name": "SvcScheduleDate",
						"type": "date"
					},
					{
						"name": "Tax2MaxAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "EDIWhirlpool",
						"type": "bit"
					},
					{
						"name": "MinDepositPercent",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UnitModifier",
						"type": "int",
						"precision": 10
					},
					{
						"name": "DateFinished",
						"type": "date"
					},
					{
						"name": "DatePosted",
						"type": "date"
					},
					{
						"name": "TimePosted",
						"type": "varchar"
					},
					{
						"name": "TTRTaxCalculated",
						"type": "bit"
					},
					{
						"name": "PickUpBranchCode",
						"type": "varchar"
					},
					{
						"name": "PodiumOptOut",
						"type": "bit"
					},
					{
						"name": "SignCustmizedFields",
						"type": "varchar"
					},
					{
						"name": "AVBSaleDateSent",
						"type": "date"
					},
					{
						"name": "AVBSaleTimeSent",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "TTRJurisdictionCode",
						"type": "varchar"
					},
					{
						"name": "BranchCode",
						"type": "varchar"
					},
					{
						"name": "COGSPosted",
						"type": "bit"
					},
					{
						"name": "CallSequence",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "CommittedPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "DateCreated",
						"type": "date"
					},
					{
						"name": "DateModified",
						"type": "date"
					},
					{
						"name": "DispatchPriority",
						"type": "varchar"
					},
					{
						"name": "DispatchRequestedRouteCode",
						"type": "varchar"
					},
					{
						"name": "DispatchSpecRequest",
						"type": "varchar"
					},
					{
						"name": "DispatchTime",
						"type": "varchar"
					},
					{
						"name": "DispatchTimeAM",
						"type": "varchar"
					},
					{
						"name": "Estimate",
						"type": "varchar"
					},
					{
						"name": "Field1",
						"type": "varchar"
					},
					{
						"name": "Field2",
						"type": "varchar"
					},
					{
						"name": "Field3",
						"type": "varchar"
					},
					{
						"name": "Field4",
						"type": "varchar"
					},
					{
						"name": "Field5",
						"type": "varchar"
					},
					{
						"name": "InvFinishDate",
						"type": "date"
					},
					{
						"name": "InvStartDate",
						"type": "date"
					},
					{
						"name": "InvTypeCode",
						"type": "varchar"
					},
					{
						"name": "ItemListPriceCode",
						"type": "varchar"
					},
					{
						"name": "ItemTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "JobLocation",
						"type": "varchar"
					},
					{
						"name": "JobNumber",
						"type": "varchar"
					},
					{
						"name": "JobStatusCode",
						"type": "varchar"
					},
					{
						"name": "LaborRate",
						"type": "varchar"
					},
					{
						"name": "LaborTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "MapReference",
						"type": "varchar"
					},
					{
						"name": "MapZoneCode",
						"type": "varchar"
					},
					{
						"name": "MiscTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OpenPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OtherListPriceCode",
						"type": "varchar"
					},
					{
						"name": "PONumber",
						"type": "varchar"
					},
					{
						"name": "PaymentTypeCode",
						"type": "varchar"
					},
					{
						"name": "PickUpDate",
						"type": "date"
					},
					{
						"name": "Reference",
						"type": "varchar"
					},
					{
						"name": "SaleReferralCode",
						"type": "varchar"
					},
					{
						"name": "Salesperson1Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "ScheduleDate",
						"type": "date"
					},
					{
						"name": "SerialListPriceCode",
						"type": "varchar"
					},
					{
						"name": "SerialTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "SvcAgreementExpDate",
						"type": "date"
					},
					{
						"name": "SvcAgreementNumber",
						"type": "varchar"
					},
					{
						"name": "SvcBrandCode",
						"type": "varchar"
					},
					{
						"name": "SvcCenter",
						"type": "varchar"
					},
					{
						"name": "SvcCenterNumber",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintCode",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDatePurchased",
						"type": "date"
					},
					{
						"name": "SvcDealerCode",
						"type": "varchar"
					},
					{
						"name": "SvcDealerDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDistributorNumber",
						"type": "varchar"
					},
					{
						"name": "SvcInWarranty",
						"type": "varchar"
					},
					{
						"name": "SvcMfgCodeEiaNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMicroLeak",
						"type": "varchar"
					},
					{
						"name": "SvcMiles",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesRate",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcModel",
						"type": "varchar"
					},
					{
						"name": "SvcMotorNewNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMotorOldNumber",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedCode",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedDesc",
						"type": "varchar"
					},
					{
						"name": "SvcProduct",
						"type": "varchar"
					},
					{
						"name": "SvcProductCode",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCatMinorMajor",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCategory",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode",
						"type": "varchar"
					},
					{
						"name": "SvcRunNumber",
						"type": "varchar"
					},
					{
						"name": "SvcSerial",
						"type": "varchar"
					},
					{
						"name": "SvcSpecAuthNumber",
						"type": "varchar"
					},
					{
						"name": "SvcStockMerchandise",
						"type": "bit"
					},
					{
						"name": "SvcTimeCompleted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeCompleted2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted2",
						"type": "varchar"
					},
					{
						"name": "Tax1Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax1Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Code",
						"type": "varchar"
					},
					{
						"name": "Tax2Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax3Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax3Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UserCreated",
						"type": "varchar"
					},
					{
						"name": "UserModified",
						"type": "varchar"
					},
					{
						"name": "Warranty",
						"type": "varchar"
					},
					{
						"name": "WarrantyField1",
						"type": "varchar"
					},
					{
						"name": "WarrantyField2",
						"type": "varchar"
					},
					{
						"name": "WarrantyField3",
						"type": "varchar"
					},
					{
						"name": "WarrantyField4",
						"type": "varchar"
					},
					{
						"name": "WarrantyField5",
						"type": "varchar"
					},
					{
						"name": "WtyTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "Branch"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Landing_BrandDataset')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1_Landing Linked Service",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [],
				"typeProperties": {
					"schema": "rd",
					"table": "Brand"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Landing_CustomerDataset')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1_Landing Linked Service",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "TripNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ParentDateStamp",
						"type": "date"
					},
					{
						"name": "ParentLineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "Amount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "DateStamp",
						"type": "date"
					},
					{
						"name": "Description",
						"type": "varchar"
					},
					{
						"name": "InPackage",
						"type": "varchar"
					},
					{
						"name": "InvoiceCode",
						"type": "varchar"
					},
					{
						"name": "LineNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "LineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "LineType",
						"type": "varchar"
					},
					{
						"name": "LocationCode",
						"type": "varchar"
					},
					{
						"name": "Qty",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "Tax1",
						"type": "bit"
					},
					{
						"name": "Tax2",
						"type": "bit"
					},
					{
						"name": "Tax3",
						"type": "bit"
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "Customer"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Landing_DimProductMajorDataset')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1_Landing Linked Service",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Financed",
						"type": "bit"
					},
					{
						"name": "Void",
						"type": "bit"
					},
					{
						"name": "Qualification",
						"type": "varchar"
					},
					{
						"name": "Priority",
						"type": "varchar"
					},
					{
						"name": "Tax3Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcRepairCode1",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode2",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode3",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode4",
						"type": "varchar"
					},
					{
						"name": "ContractCode",
						"type": "varchar"
					},
					{
						"name": "SvcContract",
						"type": "varchar"
					},
					{
						"name": "UserFinished",
						"type": "varchar"
					},
					{
						"name": "UserPosted",
						"type": "varchar"
					},
					{
						"name": "UpdateHistoryWarranty",
						"type": "bit"
					},
					{
						"name": "ShipMethod",
						"type": "varchar"
					},
					{
						"name": "TimeCreated",
						"type": "varchar"
					},
					{
						"name": "TimeModified",
						"type": "varchar"
					},
					{
						"name": "TimeFinished",
						"type": "varchar"
					},
					{
						"name": "DispatchUnits",
						"type": "int",
						"precision": 10
					},
					{
						"name": "EDIDateStamp",
						"type": "date"
					},
					{
						"name": "EDITimeStamp",
						"type": "varchar"
					},
					{
						"name": "PrintMethod",
						"type": "varchar"
					},
					{
						"name": "DispatchStartTime",
						"type": "varchar"
					},
					{
						"name": "TripChargeCode",
						"type": "varchar"
					},
					{
						"name": "TripChargeAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Locked",
						"type": "bit"
					},
					{
						"name": "MobileTechInvoiceCode",
						"type": "varchar"
					},
					{
						"name": "ServiceRequestID",
						"type": "varchar"
					},
					{
						"name": "CarrierCode",
						"type": "varchar"
					},
					{
						"name": "ShipViaCode",
						"type": "varchar"
					},
					{
						"name": "JobStatusUpdate",
						"type": "bit"
					},
					{
						"name": "DispatchEmail",
						"type": "bit"
					},
					{
						"name": "LastDateSaved",
						"type": "date"
					},
					{
						"name": "LastTimeSaved",
						"type": "varchar"
					},
					{
						"name": "Terms",
						"type": "varchar"
					},
					{
						"name": "SvcEquipmentNumber",
						"type": "varchar"
					},
					{
						"name": "WebOrderID",
						"type": "varchar"
					},
					{
						"name": "Department",
						"type": "varchar"
					},
					{
						"name": "CreditStatusCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedUserCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedDateStamp",
						"type": "date"
					},
					{
						"name": "CreditApprovedTimeStamp",
						"type": "varchar"
					},
					{
						"name": "EDIMaroline",
						"type": "bit"
					},
					{
						"name": "RequestedDate",
						"type": "date"
					},
					{
						"name": "SvcCSRInvoice",
						"type": "varchar"
					},
					{
						"name": "SvcSoldList",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcSoldSTDCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcFollowUpDate",
						"type": "date"
					},
					{
						"name": "SvcScheduleDate",
						"type": "date"
					},
					{
						"name": "Tax2MaxAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "EDIWhirlpool",
						"type": "bit"
					},
					{
						"name": "MinDepositPercent",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UnitModifier",
						"type": "int",
						"precision": 10
					},
					{
						"name": "DateFinished",
						"type": "date"
					},
					{
						"name": "DatePosted",
						"type": "date"
					},
					{
						"name": "TimePosted",
						"type": "varchar"
					},
					{
						"name": "TTRTaxCalculated",
						"type": "bit"
					},
					{
						"name": "PickUpBranchCode",
						"type": "varchar"
					},
					{
						"name": "PodiumOptOut",
						"type": "bit"
					},
					{
						"name": "SignCustmizedFields",
						"type": "varchar"
					},
					{
						"name": "AVBSaleDateSent",
						"type": "date"
					},
					{
						"name": "AVBSaleTimeSent",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "TTRJurisdictionCode",
						"type": "varchar"
					},
					{
						"name": "BranchCode",
						"type": "varchar"
					},
					{
						"name": "COGSPosted",
						"type": "bit"
					},
					{
						"name": "CallSequence",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "CommittedPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "DateCreated",
						"type": "date"
					},
					{
						"name": "DateModified",
						"type": "date"
					},
					{
						"name": "DispatchPriority",
						"type": "varchar"
					},
					{
						"name": "DispatchRequestedRouteCode",
						"type": "varchar"
					},
					{
						"name": "DispatchSpecRequest",
						"type": "varchar"
					},
					{
						"name": "DispatchTime",
						"type": "varchar"
					},
					{
						"name": "DispatchTimeAM",
						"type": "varchar"
					},
					{
						"name": "Estimate",
						"type": "varchar"
					},
					{
						"name": "Field1",
						"type": "varchar"
					},
					{
						"name": "Field2",
						"type": "varchar"
					},
					{
						"name": "Field3",
						"type": "varchar"
					},
					{
						"name": "Field4",
						"type": "varchar"
					},
					{
						"name": "Field5",
						"type": "varchar"
					},
					{
						"name": "InvFinishDate",
						"type": "date"
					},
					{
						"name": "InvStartDate",
						"type": "date"
					},
					{
						"name": "InvTypeCode",
						"type": "varchar"
					},
					{
						"name": "ItemListPriceCode",
						"type": "varchar"
					},
					{
						"name": "ItemTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "JobLocation",
						"type": "varchar"
					},
					{
						"name": "JobNumber",
						"type": "varchar"
					},
					{
						"name": "JobStatusCode",
						"type": "varchar"
					},
					{
						"name": "LaborRate",
						"type": "varchar"
					},
					{
						"name": "LaborTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "MapReference",
						"type": "varchar"
					},
					{
						"name": "MapZoneCode",
						"type": "varchar"
					},
					{
						"name": "MiscTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OpenPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OtherListPriceCode",
						"type": "varchar"
					},
					{
						"name": "PONumber",
						"type": "varchar"
					},
					{
						"name": "PaymentTypeCode",
						"type": "varchar"
					},
					{
						"name": "PickUpDate",
						"type": "date"
					},
					{
						"name": "Reference",
						"type": "varchar"
					},
					{
						"name": "SaleReferralCode",
						"type": "varchar"
					},
					{
						"name": "Salesperson1Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "ScheduleDate",
						"type": "date"
					},
					{
						"name": "SerialListPriceCode",
						"type": "varchar"
					},
					{
						"name": "SerialTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "SvcAgreementExpDate",
						"type": "date"
					},
					{
						"name": "SvcAgreementNumber",
						"type": "varchar"
					},
					{
						"name": "SvcBrandCode",
						"type": "varchar"
					},
					{
						"name": "SvcCenter",
						"type": "varchar"
					},
					{
						"name": "SvcCenterNumber",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintCode",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDatePurchased",
						"type": "date"
					},
					{
						"name": "SvcDealerCode",
						"type": "varchar"
					},
					{
						"name": "SvcDealerDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDistributorNumber",
						"type": "varchar"
					},
					{
						"name": "SvcInWarranty",
						"type": "varchar"
					},
					{
						"name": "SvcMfgCodeEiaNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMicroLeak",
						"type": "varchar"
					},
					{
						"name": "SvcMiles",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesRate",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcModel",
						"type": "varchar"
					},
					{
						"name": "SvcMotorNewNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMotorOldNumber",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedCode",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedDesc",
						"type": "varchar"
					},
					{
						"name": "SvcProduct",
						"type": "varchar"
					},
					{
						"name": "SvcProductCode",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCatMinorMajor",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCategory",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode",
						"type": "varchar"
					},
					{
						"name": "SvcRunNumber",
						"type": "varchar"
					},
					{
						"name": "SvcSerial",
						"type": "varchar"
					},
					{
						"name": "SvcSpecAuthNumber",
						"type": "varchar"
					},
					{
						"name": "SvcStockMerchandise",
						"type": "bit"
					},
					{
						"name": "SvcTimeCompleted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeCompleted2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted2",
						"type": "varchar"
					},
					{
						"name": "Tax1Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax1Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Code",
						"type": "varchar"
					},
					{
						"name": "Tax2Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax3Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax3Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UserCreated",
						"type": "varchar"
					},
					{
						"name": "UserModified",
						"type": "varchar"
					},
					{
						"name": "Warranty",
						"type": "varchar"
					},
					{
						"name": "WarrantyField1",
						"type": "varchar"
					},
					{
						"name": "WarrantyField2",
						"type": "varchar"
					},
					{
						"name": "WarrantyField3",
						"type": "varchar"
					},
					{
						"name": "WarrantyField4",
						"type": "varchar"
					},
					{
						"name": "WarrantyField5",
						"type": "varchar"
					},
					{
						"name": "WtyTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					}
				],
				"typeProperties": {
					"schema": "ca",
					"table": "Dim_ProductMajor"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Landing_DimProductSuperDataset')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1_Landing Linked Service",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Financed",
						"type": "bit"
					},
					{
						"name": "Void",
						"type": "bit"
					},
					{
						"name": "Qualification",
						"type": "varchar"
					},
					{
						"name": "Priority",
						"type": "varchar"
					},
					{
						"name": "Tax3Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcRepairCode1",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode2",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode3",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode4",
						"type": "varchar"
					},
					{
						"name": "ContractCode",
						"type": "varchar"
					},
					{
						"name": "SvcContract",
						"type": "varchar"
					},
					{
						"name": "UserFinished",
						"type": "varchar"
					},
					{
						"name": "UserPosted",
						"type": "varchar"
					},
					{
						"name": "UpdateHistoryWarranty",
						"type": "bit"
					},
					{
						"name": "ShipMethod",
						"type": "varchar"
					},
					{
						"name": "TimeCreated",
						"type": "varchar"
					},
					{
						"name": "TimeModified",
						"type": "varchar"
					},
					{
						"name": "TimeFinished",
						"type": "varchar"
					},
					{
						"name": "DispatchUnits",
						"type": "int",
						"precision": 10
					},
					{
						"name": "EDIDateStamp",
						"type": "date"
					},
					{
						"name": "EDITimeStamp",
						"type": "varchar"
					},
					{
						"name": "PrintMethod",
						"type": "varchar"
					},
					{
						"name": "DispatchStartTime",
						"type": "varchar"
					},
					{
						"name": "TripChargeCode",
						"type": "varchar"
					},
					{
						"name": "TripChargeAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Locked",
						"type": "bit"
					},
					{
						"name": "MobileTechInvoiceCode",
						"type": "varchar"
					},
					{
						"name": "ServiceRequestID",
						"type": "varchar"
					},
					{
						"name": "CarrierCode",
						"type": "varchar"
					},
					{
						"name": "ShipViaCode",
						"type": "varchar"
					},
					{
						"name": "JobStatusUpdate",
						"type": "bit"
					},
					{
						"name": "DispatchEmail",
						"type": "bit"
					},
					{
						"name": "LastDateSaved",
						"type": "date"
					},
					{
						"name": "LastTimeSaved",
						"type": "varchar"
					},
					{
						"name": "Terms",
						"type": "varchar"
					},
					{
						"name": "SvcEquipmentNumber",
						"type": "varchar"
					},
					{
						"name": "WebOrderID",
						"type": "varchar"
					},
					{
						"name": "Department",
						"type": "varchar"
					},
					{
						"name": "CreditStatusCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedUserCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedDateStamp",
						"type": "date"
					},
					{
						"name": "CreditApprovedTimeStamp",
						"type": "varchar"
					},
					{
						"name": "EDIMaroline",
						"type": "bit"
					},
					{
						"name": "RequestedDate",
						"type": "date"
					},
					{
						"name": "SvcCSRInvoice",
						"type": "varchar"
					},
					{
						"name": "SvcSoldList",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcSoldSTDCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcFollowUpDate",
						"type": "date"
					},
					{
						"name": "SvcScheduleDate",
						"type": "date"
					},
					{
						"name": "Tax2MaxAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "EDIWhirlpool",
						"type": "bit"
					},
					{
						"name": "MinDepositPercent",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UnitModifier",
						"type": "int",
						"precision": 10
					},
					{
						"name": "DateFinished",
						"type": "date"
					},
					{
						"name": "DatePosted",
						"type": "date"
					},
					{
						"name": "TimePosted",
						"type": "varchar"
					},
					{
						"name": "TTRTaxCalculated",
						"type": "bit"
					},
					{
						"name": "PickUpBranchCode",
						"type": "varchar"
					},
					{
						"name": "PodiumOptOut",
						"type": "bit"
					},
					{
						"name": "SignCustmizedFields",
						"type": "varchar"
					},
					{
						"name": "AVBSaleDateSent",
						"type": "date"
					},
					{
						"name": "AVBSaleTimeSent",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "TTRJurisdictionCode",
						"type": "varchar"
					},
					{
						"name": "BranchCode",
						"type": "varchar"
					},
					{
						"name": "COGSPosted",
						"type": "bit"
					},
					{
						"name": "CallSequence",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "CommittedPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "DateCreated",
						"type": "date"
					},
					{
						"name": "DateModified",
						"type": "date"
					},
					{
						"name": "DispatchPriority",
						"type": "varchar"
					},
					{
						"name": "DispatchRequestedRouteCode",
						"type": "varchar"
					},
					{
						"name": "DispatchSpecRequest",
						"type": "varchar"
					},
					{
						"name": "DispatchTime",
						"type": "varchar"
					},
					{
						"name": "DispatchTimeAM",
						"type": "varchar"
					},
					{
						"name": "Estimate",
						"type": "varchar"
					},
					{
						"name": "Field1",
						"type": "varchar"
					},
					{
						"name": "Field2",
						"type": "varchar"
					},
					{
						"name": "Field3",
						"type": "varchar"
					},
					{
						"name": "Field4",
						"type": "varchar"
					},
					{
						"name": "Field5",
						"type": "varchar"
					},
					{
						"name": "InvFinishDate",
						"type": "date"
					},
					{
						"name": "InvStartDate",
						"type": "date"
					},
					{
						"name": "InvTypeCode",
						"type": "varchar"
					},
					{
						"name": "ItemListPriceCode",
						"type": "varchar"
					},
					{
						"name": "ItemTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "JobLocation",
						"type": "varchar"
					},
					{
						"name": "JobNumber",
						"type": "varchar"
					},
					{
						"name": "JobStatusCode",
						"type": "varchar"
					},
					{
						"name": "LaborRate",
						"type": "varchar"
					},
					{
						"name": "LaborTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "MapReference",
						"type": "varchar"
					},
					{
						"name": "MapZoneCode",
						"type": "varchar"
					},
					{
						"name": "MiscTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OpenPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OtherListPriceCode",
						"type": "varchar"
					},
					{
						"name": "PONumber",
						"type": "varchar"
					},
					{
						"name": "PaymentTypeCode",
						"type": "varchar"
					},
					{
						"name": "PickUpDate",
						"type": "date"
					},
					{
						"name": "Reference",
						"type": "varchar"
					},
					{
						"name": "SaleReferralCode",
						"type": "varchar"
					},
					{
						"name": "Salesperson1Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "ScheduleDate",
						"type": "date"
					},
					{
						"name": "SerialListPriceCode",
						"type": "varchar"
					},
					{
						"name": "SerialTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "SvcAgreementExpDate",
						"type": "date"
					},
					{
						"name": "SvcAgreementNumber",
						"type": "varchar"
					},
					{
						"name": "SvcBrandCode",
						"type": "varchar"
					},
					{
						"name": "SvcCenter",
						"type": "varchar"
					},
					{
						"name": "SvcCenterNumber",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintCode",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDatePurchased",
						"type": "date"
					},
					{
						"name": "SvcDealerCode",
						"type": "varchar"
					},
					{
						"name": "SvcDealerDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDistributorNumber",
						"type": "varchar"
					},
					{
						"name": "SvcInWarranty",
						"type": "varchar"
					},
					{
						"name": "SvcMfgCodeEiaNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMicroLeak",
						"type": "varchar"
					},
					{
						"name": "SvcMiles",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesRate",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcModel",
						"type": "varchar"
					},
					{
						"name": "SvcMotorNewNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMotorOldNumber",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedCode",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedDesc",
						"type": "varchar"
					},
					{
						"name": "SvcProduct",
						"type": "varchar"
					},
					{
						"name": "SvcProductCode",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCatMinorMajor",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCategory",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode",
						"type": "varchar"
					},
					{
						"name": "SvcRunNumber",
						"type": "varchar"
					},
					{
						"name": "SvcSerial",
						"type": "varchar"
					},
					{
						"name": "SvcSpecAuthNumber",
						"type": "varchar"
					},
					{
						"name": "SvcStockMerchandise",
						"type": "bit"
					},
					{
						"name": "SvcTimeCompleted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeCompleted2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted2",
						"type": "varchar"
					},
					{
						"name": "Tax1Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax1Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Code",
						"type": "varchar"
					},
					{
						"name": "Tax2Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax3Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax3Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UserCreated",
						"type": "varchar"
					},
					{
						"name": "UserModified",
						"type": "varchar"
					},
					{
						"name": "Warranty",
						"type": "varchar"
					},
					{
						"name": "WarrantyField1",
						"type": "varchar"
					},
					{
						"name": "WarrantyField2",
						"type": "varchar"
					},
					{
						"name": "WarrantyField3",
						"type": "varchar"
					},
					{
						"name": "WarrantyField4",
						"type": "varchar"
					},
					{
						"name": "WarrantyField5",
						"type": "varchar"
					},
					{
						"name": "WtyTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					}
				],
				"typeProperties": {
					"schema": "ca",
					"table": "Dim_ProductSuper"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Landing_InvoiceAddressDataset')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1_Landing Linked Service",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "TripNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ParentDateStamp",
						"type": "date"
					},
					{
						"name": "ParentLineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "Amount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "DateStamp",
						"type": "date"
					},
					{
						"name": "Description",
						"type": "varchar"
					},
					{
						"name": "InPackage",
						"type": "varchar"
					},
					{
						"name": "InvoiceCode",
						"type": "varchar"
					},
					{
						"name": "LineNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "LineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "LineType",
						"type": "varchar"
					},
					{
						"name": "LocationCode",
						"type": "varchar"
					},
					{
						"name": "Qty",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "Tax1",
						"type": "bit"
					},
					{
						"name": "Tax2",
						"type": "bit"
					},
					{
						"name": "Tax3",
						"type": "bit"
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "InvoiceAddress"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Landing_InvoiceAddresswatermarktable')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1_Landing Linked Service",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "invoiceaddresswatermark_value",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "InvoiceAddresswatermark_table"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Landing_InvoiceDataset')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1_Landing Linked Service",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Financed",
						"type": "bit"
					},
					{
						"name": "Void",
						"type": "bit"
					},
					{
						"name": "Qualification",
						"type": "varchar"
					},
					{
						"name": "Priority",
						"type": "varchar"
					},
					{
						"name": "Tax3Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcRepairCode1",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode2",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode3",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode4",
						"type": "varchar"
					},
					{
						"name": "ContractCode",
						"type": "varchar"
					},
					{
						"name": "SvcContract",
						"type": "varchar"
					},
					{
						"name": "UserFinished",
						"type": "varchar"
					},
					{
						"name": "UserPosted",
						"type": "varchar"
					},
					{
						"name": "UpdateHistoryWarranty",
						"type": "bit"
					},
					{
						"name": "ShipMethod",
						"type": "varchar"
					},
					{
						"name": "TimeCreated",
						"type": "varchar"
					},
					{
						"name": "TimeModified",
						"type": "varchar"
					},
					{
						"name": "TimeFinished",
						"type": "varchar"
					},
					{
						"name": "DispatchUnits",
						"type": "int",
						"precision": 10
					},
					{
						"name": "EDIDateStamp",
						"type": "date"
					},
					{
						"name": "EDITimeStamp",
						"type": "varchar"
					},
					{
						"name": "PrintMethod",
						"type": "varchar"
					},
					{
						"name": "DispatchStartTime",
						"type": "varchar"
					},
					{
						"name": "TripChargeCode",
						"type": "varchar"
					},
					{
						"name": "TripChargeAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Locked",
						"type": "bit"
					},
					{
						"name": "MobileTechInvoiceCode",
						"type": "varchar"
					},
					{
						"name": "ServiceRequestID",
						"type": "varchar"
					},
					{
						"name": "CarrierCode",
						"type": "varchar"
					},
					{
						"name": "ShipViaCode",
						"type": "varchar"
					},
					{
						"name": "JobStatusUpdate",
						"type": "bit"
					},
					{
						"name": "DispatchEmail",
						"type": "bit"
					},
					{
						"name": "LastDateSaved",
						"type": "date"
					},
					{
						"name": "LastTimeSaved",
						"type": "varchar"
					},
					{
						"name": "Terms",
						"type": "varchar"
					},
					{
						"name": "SvcEquipmentNumber",
						"type": "varchar"
					},
					{
						"name": "WebOrderID",
						"type": "varchar"
					},
					{
						"name": "Department",
						"type": "varchar"
					},
					{
						"name": "CreditStatusCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedUserCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedDateStamp",
						"type": "date"
					},
					{
						"name": "CreditApprovedTimeStamp",
						"type": "varchar"
					},
					{
						"name": "EDIMaroline",
						"type": "bit"
					},
					{
						"name": "RequestedDate",
						"type": "date"
					},
					{
						"name": "SvcCSRInvoice",
						"type": "varchar"
					},
					{
						"name": "SvcSoldList",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcSoldSTDCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcFollowUpDate",
						"type": "date"
					},
					{
						"name": "SvcScheduleDate",
						"type": "date"
					},
					{
						"name": "Tax2MaxAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "EDIWhirlpool",
						"type": "bit"
					},
					{
						"name": "MinDepositPercent",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UnitModifier",
						"type": "int",
						"precision": 10
					},
					{
						"name": "DateFinished",
						"type": "date"
					},
					{
						"name": "DatePosted",
						"type": "date"
					},
					{
						"name": "TimePosted",
						"type": "varchar"
					},
					{
						"name": "TTRTaxCalculated",
						"type": "bit"
					},
					{
						"name": "PickUpBranchCode",
						"type": "varchar"
					},
					{
						"name": "PodiumOptOut",
						"type": "bit"
					},
					{
						"name": "SignCustmizedFields",
						"type": "varchar"
					},
					{
						"name": "AVBSaleDateSent",
						"type": "date"
					},
					{
						"name": "AVBSaleTimeSent",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "TTRJurisdictionCode",
						"type": "varchar"
					},
					{
						"name": "BranchCode",
						"type": "varchar"
					},
					{
						"name": "COGSPosted",
						"type": "bit"
					},
					{
						"name": "CallSequence",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "CommittedPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "DateCreated",
						"type": "date"
					},
					{
						"name": "DateModified",
						"type": "date"
					},
					{
						"name": "DispatchPriority",
						"type": "varchar"
					},
					{
						"name": "DispatchRequestedRouteCode",
						"type": "varchar"
					},
					{
						"name": "DispatchSpecRequest",
						"type": "varchar"
					},
					{
						"name": "DispatchTime",
						"type": "varchar"
					},
					{
						"name": "DispatchTimeAM",
						"type": "varchar"
					},
					{
						"name": "Estimate",
						"type": "varchar"
					},
					{
						"name": "Field1",
						"type": "varchar"
					},
					{
						"name": "Field2",
						"type": "varchar"
					},
					{
						"name": "Field3",
						"type": "varchar"
					},
					{
						"name": "Field4",
						"type": "varchar"
					},
					{
						"name": "Field5",
						"type": "varchar"
					},
					{
						"name": "InvFinishDate",
						"type": "date"
					},
					{
						"name": "InvStartDate",
						"type": "date"
					},
					{
						"name": "InvTypeCode",
						"type": "varchar"
					},
					{
						"name": "ItemListPriceCode",
						"type": "varchar"
					},
					{
						"name": "ItemTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "JobLocation",
						"type": "varchar"
					},
					{
						"name": "JobNumber",
						"type": "varchar"
					},
					{
						"name": "JobStatusCode",
						"type": "varchar"
					},
					{
						"name": "LaborRate",
						"type": "varchar"
					},
					{
						"name": "LaborTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "MapReference",
						"type": "varchar"
					},
					{
						"name": "MapZoneCode",
						"type": "varchar"
					},
					{
						"name": "MiscTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OpenPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OtherListPriceCode",
						"type": "varchar"
					},
					{
						"name": "PONumber",
						"type": "varchar"
					},
					{
						"name": "PaymentTypeCode",
						"type": "varchar"
					},
					{
						"name": "PickUpDate",
						"type": "date"
					},
					{
						"name": "Reference",
						"type": "varchar"
					},
					{
						"name": "SaleReferralCode",
						"type": "varchar"
					},
					{
						"name": "Salesperson1Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "ScheduleDate",
						"type": "date"
					},
					{
						"name": "SerialListPriceCode",
						"type": "varchar"
					},
					{
						"name": "SerialTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "SvcAgreementExpDate",
						"type": "date"
					},
					{
						"name": "SvcAgreementNumber",
						"type": "varchar"
					},
					{
						"name": "SvcBrandCode",
						"type": "varchar"
					},
					{
						"name": "SvcCenter",
						"type": "varchar"
					},
					{
						"name": "SvcCenterNumber",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintCode",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDatePurchased",
						"type": "date"
					},
					{
						"name": "SvcDealerCode",
						"type": "varchar"
					},
					{
						"name": "SvcDealerDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDistributorNumber",
						"type": "varchar"
					},
					{
						"name": "SvcInWarranty",
						"type": "varchar"
					},
					{
						"name": "SvcMfgCodeEiaNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMicroLeak",
						"type": "varchar"
					},
					{
						"name": "SvcMiles",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesRate",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcModel",
						"type": "varchar"
					},
					{
						"name": "SvcMotorNewNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMotorOldNumber",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedCode",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedDesc",
						"type": "varchar"
					},
					{
						"name": "SvcProduct",
						"type": "varchar"
					},
					{
						"name": "SvcProductCode",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCatMinorMajor",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCategory",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode",
						"type": "varchar"
					},
					{
						"name": "SvcRunNumber",
						"type": "varchar"
					},
					{
						"name": "SvcSerial",
						"type": "varchar"
					},
					{
						"name": "SvcSpecAuthNumber",
						"type": "varchar"
					},
					{
						"name": "SvcStockMerchandise",
						"type": "bit"
					},
					{
						"name": "SvcTimeCompleted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeCompleted2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted2",
						"type": "varchar"
					},
					{
						"name": "Tax1Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax1Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Code",
						"type": "varchar"
					},
					{
						"name": "Tax2Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax3Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax3Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UserCreated",
						"type": "varchar"
					},
					{
						"name": "UserModified",
						"type": "varchar"
					},
					{
						"name": "Warranty",
						"type": "varchar"
					},
					{
						"name": "WarrantyField1",
						"type": "varchar"
					},
					{
						"name": "WarrantyField2",
						"type": "varchar"
					},
					{
						"name": "WarrantyField3",
						"type": "varchar"
					},
					{
						"name": "WarrantyField4",
						"type": "varchar"
					},
					{
						"name": "WarrantyField5",
						"type": "varchar"
					},
					{
						"name": "WtyTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "Invoice"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Landing_InvoiceMiscDataset')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1_Landing Linked Service",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "TripNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Comment",
						"type": "varchar"
					},
					{
						"name": "SubmittedDate",
						"type": "date"
					},
					{
						"name": "SubmittedTime",
						"type": "varchar"
					},
					{
						"name": "SubmittedUser",
						"type": "varchar"
					},
					{
						"name": "CreditedDate",
						"type": "date"
					},
					{
						"name": "CreditedTime",
						"type": "varchar"
					},
					{
						"name": "CreditedUser",
						"type": "varchar"
					},
					{
						"name": "InvoicePaymentRef",
						"type": "varchar"
					},
					{
						"name": "UserVerified",
						"type": "varchar"
					},
					{
						"name": "DateVerified",
						"type": "date"
					},
					{
						"name": "TimeVerified",
						"type": "varchar"
					},
					{
						"name": "CommissionCode",
						"type": "varchar"
					},
					{
						"name": "EDIFormat",
						"type": "varchar"
					},
					{
						"name": "InvoiceModelDateStamp",
						"type": "date"
					},
					{
						"name": "InvoiceModelLineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "InvoiceModelInvoiceCode",
						"type": "varchar"
					},
					{
						"name": "InvoiceModelCode",
						"type": "varchar"
					},
					{
						"name": "BranchCode",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "DateCreated",
						"type": "date"
					},
					{
						"name": "DateModified",
						"type": "date"
					},
					{
						"name": "DateStamp",
						"type": "date"
					},
					{
						"name": "GLCostCr",
						"type": "varchar"
					},
					{
						"name": "GLCostDb",
						"type": "varchar"
					},
					{
						"name": "GLRevenue",
						"type": "varchar"
					},
					{
						"name": "InPackage",
						"type": "bit"
					},
					{
						"name": "InvoiceCode",
						"type": "varchar"
					},
					{
						"name": "LineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "MiscCode",
						"type": "varchar"
					},
					{
						"name": "MiscDesc",
						"type": "varchar"
					},
					{
						"name": "Qty",
						"type": "int",
						"precision": 10
					},
					{
						"name": "SellingPrice",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax1",
						"type": "bit"
					},
					{
						"name": "Tax2",
						"type": "bit"
					},
					{
						"name": "Tax3",
						"type": "bit"
					},
					{
						"name": "Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UnitCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UpdateHistory",
						"type": "bit"
					},
					{
						"name": "UserCreated",
						"type": "varchar"
					},
					{
						"name": "UserModified",
						"type": "varchar"
					},
					{
						"name": "Warranty",
						"type": "varchar"
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "InvoiceMisc"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Landing_InvoiceMiscwatermarktable')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1_Landing Linked Service",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "InvoiceMiscwatermark_value",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "InvoiceMiscwatermark_table"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Landing_InvoiceModelDataset')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1_Landing Linked Service",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "TakenStatus",
						"type": "varchar"
					},
					{
						"name": "TakenDate",
						"type": "date"
					},
					{
						"name": "AverageCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "StandardCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "LastCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Color",
						"type": "varchar"
					},
					{
						"name": "POCode",
						"type": "varchar"
					},
					{
						"name": "Reference",
						"type": "varchar"
					},
					{
						"name": "PODateStamp",
						"type": "date"
					},
					{
						"name": "POLineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "SpecialOrderDate",
						"type": "date"
					},
					{
						"name": "TripNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "LandedCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "AutoBackorder",
						"type": "bit"
					},
					{
						"name": "ManufacturersWarranty",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ReplacementCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UserVerified",
						"type": "varchar"
					},
					{
						"name": "DateVerified",
						"type": "date"
					},
					{
						"name": "TimeVerified",
						"type": "varchar"
					},
					{
						"name": "OriginalCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "ReserveExclusive",
						"type": "bit"
					},
					{
						"name": "CommissionCode",
						"type": "varchar"
					},
					{
						"name": "EDIFormat",
						"type": "varchar"
					},
					{
						"name": "BranchCode",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "DateCreated",
						"type": "date"
					},
					{
						"name": "DateModified",
						"type": "date"
					},
					{
						"name": "DateStamp",
						"type": "date"
					},
					{
						"name": "InPackage",
						"type": "bit"
					},
					{
						"name": "InvoiceCode",
						"type": "varchar"
					},
					{
						"name": "LineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "LocationCode",
						"type": "varchar"
					},
					{
						"name": "ModelCode",
						"type": "varchar"
					},
					{
						"name": "ModelDesc",
						"type": "varchar"
					},
					{
						"name": "NewUsed",
						"type": "varchar"
					},
					{
						"name": "QtyOrdered",
						"type": "int",
						"precision": 10
					},
					{
						"name": "QtyReserved",
						"type": "int",
						"precision": 10
					},
					{
						"name": "QtyShipped",
						"type": "int",
						"precision": 10
					},
					{
						"name": "SellingPrice",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Spiff",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "Tax1",
						"type": "bit"
					},
					{
						"name": "Tax1CostList",
						"type": "varchar"
					},
					{
						"name": "Tax1Included",
						"type": "bit"
					},
					{
						"name": "Tax1Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2",
						"type": "bit"
					},
					{
						"name": "Tax3",
						"type": "bit"
					},
					{
						"name": "Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UserCreated",
						"type": "varchar"
					},
					{
						"name": "UserModified",
						"type": "varchar"
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "InvoiceModel"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Landing_InvoiceModelwatermarktable')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1_Landing Linked Service",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "InvoiceModelwatermark_value",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "InvoiceModelwatermark_table"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Landing_InvoicePaymentDataset')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1_Landing Linked Service",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "TripNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ParentDateStamp",
						"type": "date"
					},
					{
						"name": "ParentLineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "Amount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "DateStamp",
						"type": "date"
					},
					{
						"name": "Description",
						"type": "varchar"
					},
					{
						"name": "InPackage",
						"type": "varchar"
					},
					{
						"name": "InvoiceCode",
						"type": "varchar"
					},
					{
						"name": "LineNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "LineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "LineType",
						"type": "varchar"
					},
					{
						"name": "LocationCode",
						"type": "varchar"
					},
					{
						"name": "Qty",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "Tax1",
						"type": "bit"
					},
					{
						"name": "Tax2",
						"type": "bit"
					},
					{
						"name": "Tax3",
						"type": "bit"
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "InvoicePayment"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Landing_InvoiceSerialDataset')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1_Landing Linked Service",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "TripNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ParentDateStamp",
						"type": "date"
					},
					{
						"name": "ParentLineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "Amount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "DateStamp",
						"type": "date"
					},
					{
						"name": "Description",
						"type": "varchar"
					},
					{
						"name": "InPackage",
						"type": "varchar"
					},
					{
						"name": "InvoiceCode",
						"type": "varchar"
					},
					{
						"name": "LineNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "LineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "LineType",
						"type": "varchar"
					},
					{
						"name": "LocationCode",
						"type": "varchar"
					},
					{
						"name": "Qty",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "Tax1",
						"type": "bit"
					},
					{
						"name": "Tax2",
						"type": "bit"
					},
					{
						"name": "Tax3",
						"type": "bit"
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "InvoiceSerial"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Landing_InvoiceWarrantyDataset')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1_Landing Linked Service",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "TripNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ParentDateStamp",
						"type": "date"
					},
					{
						"name": "ParentLineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "Amount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "DateStamp",
						"type": "date"
					},
					{
						"name": "Description",
						"type": "varchar"
					},
					{
						"name": "InPackage",
						"type": "varchar"
					},
					{
						"name": "InvoiceCode",
						"type": "varchar"
					},
					{
						"name": "LineNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "LineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "LineType",
						"type": "varchar"
					},
					{
						"name": "LocationCode",
						"type": "varchar"
					},
					{
						"name": "Qty",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "Tax1",
						"type": "bit"
					},
					{
						"name": "Tax2",
						"type": "bit"
					},
					{
						"name": "Tax3",
						"type": "bit"
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "InvoiceWarranty"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Landing_LocationDataset')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1_Landing Linked Service",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Financed",
						"type": "bit"
					},
					{
						"name": "Void",
						"type": "bit"
					},
					{
						"name": "Qualification",
						"type": "varchar"
					},
					{
						"name": "Priority",
						"type": "varchar"
					},
					{
						"name": "Tax3Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcRepairCode1",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode2",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode3",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode4",
						"type": "varchar"
					},
					{
						"name": "ContractCode",
						"type": "varchar"
					},
					{
						"name": "SvcContract",
						"type": "varchar"
					},
					{
						"name": "UserFinished",
						"type": "varchar"
					},
					{
						"name": "UserPosted",
						"type": "varchar"
					},
					{
						"name": "UpdateHistoryWarranty",
						"type": "bit"
					},
					{
						"name": "ShipMethod",
						"type": "varchar"
					},
					{
						"name": "TimeCreated",
						"type": "varchar"
					},
					{
						"name": "TimeModified",
						"type": "varchar"
					},
					{
						"name": "TimeFinished",
						"type": "varchar"
					},
					{
						"name": "DispatchUnits",
						"type": "int",
						"precision": 10
					},
					{
						"name": "EDIDateStamp",
						"type": "date"
					},
					{
						"name": "EDITimeStamp",
						"type": "varchar"
					},
					{
						"name": "PrintMethod",
						"type": "varchar"
					},
					{
						"name": "DispatchStartTime",
						"type": "varchar"
					},
					{
						"name": "TripChargeCode",
						"type": "varchar"
					},
					{
						"name": "TripChargeAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Locked",
						"type": "bit"
					},
					{
						"name": "MobileTechInvoiceCode",
						"type": "varchar"
					},
					{
						"name": "ServiceRequestID",
						"type": "varchar"
					},
					{
						"name": "CarrierCode",
						"type": "varchar"
					},
					{
						"name": "ShipViaCode",
						"type": "varchar"
					},
					{
						"name": "JobStatusUpdate",
						"type": "bit"
					},
					{
						"name": "DispatchEmail",
						"type": "bit"
					},
					{
						"name": "LastDateSaved",
						"type": "date"
					},
					{
						"name": "LastTimeSaved",
						"type": "varchar"
					},
					{
						"name": "Terms",
						"type": "varchar"
					},
					{
						"name": "SvcEquipmentNumber",
						"type": "varchar"
					},
					{
						"name": "WebOrderID",
						"type": "varchar"
					},
					{
						"name": "Department",
						"type": "varchar"
					},
					{
						"name": "CreditStatusCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedUserCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedDateStamp",
						"type": "date"
					},
					{
						"name": "CreditApprovedTimeStamp",
						"type": "varchar"
					},
					{
						"name": "EDIMaroline",
						"type": "bit"
					},
					{
						"name": "RequestedDate",
						"type": "date"
					},
					{
						"name": "SvcCSRInvoice",
						"type": "varchar"
					},
					{
						"name": "SvcSoldList",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcSoldSTDCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcFollowUpDate",
						"type": "date"
					},
					{
						"name": "SvcScheduleDate",
						"type": "date"
					},
					{
						"name": "Tax2MaxAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "EDIWhirlpool",
						"type": "bit"
					},
					{
						"name": "MinDepositPercent",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UnitModifier",
						"type": "int",
						"precision": 10
					},
					{
						"name": "DateFinished",
						"type": "date"
					},
					{
						"name": "DatePosted",
						"type": "date"
					},
					{
						"name": "TimePosted",
						"type": "varchar"
					},
					{
						"name": "TTRTaxCalculated",
						"type": "bit"
					},
					{
						"name": "PickUpBranchCode",
						"type": "varchar"
					},
					{
						"name": "PodiumOptOut",
						"type": "bit"
					},
					{
						"name": "SignCustmizedFields",
						"type": "varchar"
					},
					{
						"name": "AVBSaleDateSent",
						"type": "date"
					},
					{
						"name": "AVBSaleTimeSent",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "TTRJurisdictionCode",
						"type": "varchar"
					},
					{
						"name": "BranchCode",
						"type": "varchar"
					},
					{
						"name": "COGSPosted",
						"type": "bit"
					},
					{
						"name": "CallSequence",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "CommittedPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "DateCreated",
						"type": "date"
					},
					{
						"name": "DateModified",
						"type": "date"
					},
					{
						"name": "DispatchPriority",
						"type": "varchar"
					},
					{
						"name": "DispatchRequestedRouteCode",
						"type": "varchar"
					},
					{
						"name": "DispatchSpecRequest",
						"type": "varchar"
					},
					{
						"name": "DispatchTime",
						"type": "varchar"
					},
					{
						"name": "DispatchTimeAM",
						"type": "varchar"
					},
					{
						"name": "Estimate",
						"type": "varchar"
					},
					{
						"name": "Field1",
						"type": "varchar"
					},
					{
						"name": "Field2",
						"type": "varchar"
					},
					{
						"name": "Field3",
						"type": "varchar"
					},
					{
						"name": "Field4",
						"type": "varchar"
					},
					{
						"name": "Field5",
						"type": "varchar"
					},
					{
						"name": "InvFinishDate",
						"type": "date"
					},
					{
						"name": "InvStartDate",
						"type": "date"
					},
					{
						"name": "InvTypeCode",
						"type": "varchar"
					},
					{
						"name": "ItemListPriceCode",
						"type": "varchar"
					},
					{
						"name": "ItemTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "JobLocation",
						"type": "varchar"
					},
					{
						"name": "JobNumber",
						"type": "varchar"
					},
					{
						"name": "JobStatusCode",
						"type": "varchar"
					},
					{
						"name": "LaborRate",
						"type": "varchar"
					},
					{
						"name": "LaborTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "MapReference",
						"type": "varchar"
					},
					{
						"name": "MapZoneCode",
						"type": "varchar"
					},
					{
						"name": "MiscTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OpenPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OtherListPriceCode",
						"type": "varchar"
					},
					{
						"name": "PONumber",
						"type": "varchar"
					},
					{
						"name": "PaymentTypeCode",
						"type": "varchar"
					},
					{
						"name": "PickUpDate",
						"type": "date"
					},
					{
						"name": "Reference",
						"type": "varchar"
					},
					{
						"name": "SaleReferralCode",
						"type": "varchar"
					},
					{
						"name": "Salesperson1Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "ScheduleDate",
						"type": "date"
					},
					{
						"name": "SerialListPriceCode",
						"type": "varchar"
					},
					{
						"name": "SerialTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "SvcAgreementExpDate",
						"type": "date"
					},
					{
						"name": "SvcAgreementNumber",
						"type": "varchar"
					},
					{
						"name": "SvcBrandCode",
						"type": "varchar"
					},
					{
						"name": "SvcCenter",
						"type": "varchar"
					},
					{
						"name": "SvcCenterNumber",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintCode",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDatePurchased",
						"type": "date"
					},
					{
						"name": "SvcDealerCode",
						"type": "varchar"
					},
					{
						"name": "SvcDealerDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDistributorNumber",
						"type": "varchar"
					},
					{
						"name": "SvcInWarranty",
						"type": "varchar"
					},
					{
						"name": "SvcMfgCodeEiaNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMicroLeak",
						"type": "varchar"
					},
					{
						"name": "SvcMiles",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesRate",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcModel",
						"type": "varchar"
					},
					{
						"name": "SvcMotorNewNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMotorOldNumber",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedCode",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedDesc",
						"type": "varchar"
					},
					{
						"name": "SvcProduct",
						"type": "varchar"
					},
					{
						"name": "SvcProductCode",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCatMinorMajor",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCategory",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode",
						"type": "varchar"
					},
					{
						"name": "SvcRunNumber",
						"type": "varchar"
					},
					{
						"name": "SvcSerial",
						"type": "varchar"
					},
					{
						"name": "SvcSpecAuthNumber",
						"type": "varchar"
					},
					{
						"name": "SvcStockMerchandise",
						"type": "bit"
					},
					{
						"name": "SvcTimeCompleted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeCompleted2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted2",
						"type": "varchar"
					},
					{
						"name": "Tax1Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax1Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Code",
						"type": "varchar"
					},
					{
						"name": "Tax2Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax3Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax3Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UserCreated",
						"type": "varchar"
					},
					{
						"name": "UserModified",
						"type": "varchar"
					},
					{
						"name": "Warranty",
						"type": "varchar"
					},
					{
						"name": "WarrantyField1",
						"type": "varchar"
					},
					{
						"name": "WarrantyField2",
						"type": "varchar"
					},
					{
						"name": "WarrantyField3",
						"type": "varchar"
					},
					{
						"name": "WarrantyField4",
						"type": "varchar"
					},
					{
						"name": "WarrantyField5",
						"type": "varchar"
					},
					{
						"name": "WtyTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "Location"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Landing_MiscDataset')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1_Landing Linked Service",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Financed",
						"type": "bit"
					},
					{
						"name": "Void",
						"type": "bit"
					},
					{
						"name": "Qualification",
						"type": "varchar"
					},
					{
						"name": "Priority",
						"type": "varchar"
					},
					{
						"name": "Tax3Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcRepairCode1",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode2",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode3",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode4",
						"type": "varchar"
					},
					{
						"name": "ContractCode",
						"type": "varchar"
					},
					{
						"name": "SvcContract",
						"type": "varchar"
					},
					{
						"name": "UserFinished",
						"type": "varchar"
					},
					{
						"name": "UserPosted",
						"type": "varchar"
					},
					{
						"name": "UpdateHistoryWarranty",
						"type": "bit"
					},
					{
						"name": "ShipMethod",
						"type": "varchar"
					},
					{
						"name": "TimeCreated",
						"type": "varchar"
					},
					{
						"name": "TimeModified",
						"type": "varchar"
					},
					{
						"name": "TimeFinished",
						"type": "varchar"
					},
					{
						"name": "DispatchUnits",
						"type": "int",
						"precision": 10
					},
					{
						"name": "EDIDateStamp",
						"type": "date"
					},
					{
						"name": "EDITimeStamp",
						"type": "varchar"
					},
					{
						"name": "PrintMethod",
						"type": "varchar"
					},
					{
						"name": "DispatchStartTime",
						"type": "varchar"
					},
					{
						"name": "TripChargeCode",
						"type": "varchar"
					},
					{
						"name": "TripChargeAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Locked",
						"type": "bit"
					},
					{
						"name": "MobileTechInvoiceCode",
						"type": "varchar"
					},
					{
						"name": "ServiceRequestID",
						"type": "varchar"
					},
					{
						"name": "CarrierCode",
						"type": "varchar"
					},
					{
						"name": "ShipViaCode",
						"type": "varchar"
					},
					{
						"name": "JobStatusUpdate",
						"type": "bit"
					},
					{
						"name": "DispatchEmail",
						"type": "bit"
					},
					{
						"name": "LastDateSaved",
						"type": "date"
					},
					{
						"name": "LastTimeSaved",
						"type": "varchar"
					},
					{
						"name": "Terms",
						"type": "varchar"
					},
					{
						"name": "SvcEquipmentNumber",
						"type": "varchar"
					},
					{
						"name": "WebOrderID",
						"type": "varchar"
					},
					{
						"name": "Department",
						"type": "varchar"
					},
					{
						"name": "CreditStatusCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedUserCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedDateStamp",
						"type": "date"
					},
					{
						"name": "CreditApprovedTimeStamp",
						"type": "varchar"
					},
					{
						"name": "EDIMaroline",
						"type": "bit"
					},
					{
						"name": "RequestedDate",
						"type": "date"
					},
					{
						"name": "SvcCSRInvoice",
						"type": "varchar"
					},
					{
						"name": "SvcSoldList",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcSoldSTDCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcFollowUpDate",
						"type": "date"
					},
					{
						"name": "SvcScheduleDate",
						"type": "date"
					},
					{
						"name": "Tax2MaxAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "EDIWhirlpool",
						"type": "bit"
					},
					{
						"name": "MinDepositPercent",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UnitModifier",
						"type": "int",
						"precision": 10
					},
					{
						"name": "DateFinished",
						"type": "date"
					},
					{
						"name": "DatePosted",
						"type": "date"
					},
					{
						"name": "TimePosted",
						"type": "varchar"
					},
					{
						"name": "TTRTaxCalculated",
						"type": "bit"
					},
					{
						"name": "PickUpBranchCode",
						"type": "varchar"
					},
					{
						"name": "PodiumOptOut",
						"type": "bit"
					},
					{
						"name": "SignCustmizedFields",
						"type": "varchar"
					},
					{
						"name": "AVBSaleDateSent",
						"type": "date"
					},
					{
						"name": "AVBSaleTimeSent",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "TTRJurisdictionCode",
						"type": "varchar"
					},
					{
						"name": "BranchCode",
						"type": "varchar"
					},
					{
						"name": "COGSPosted",
						"type": "bit"
					},
					{
						"name": "CallSequence",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "CommittedPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "DateCreated",
						"type": "date"
					},
					{
						"name": "DateModified",
						"type": "date"
					},
					{
						"name": "DispatchPriority",
						"type": "varchar"
					},
					{
						"name": "DispatchRequestedRouteCode",
						"type": "varchar"
					},
					{
						"name": "DispatchSpecRequest",
						"type": "varchar"
					},
					{
						"name": "DispatchTime",
						"type": "varchar"
					},
					{
						"name": "DispatchTimeAM",
						"type": "varchar"
					},
					{
						"name": "Estimate",
						"type": "varchar"
					},
					{
						"name": "Field1",
						"type": "varchar"
					},
					{
						"name": "Field2",
						"type": "varchar"
					},
					{
						"name": "Field3",
						"type": "varchar"
					},
					{
						"name": "Field4",
						"type": "varchar"
					},
					{
						"name": "Field5",
						"type": "varchar"
					},
					{
						"name": "InvFinishDate",
						"type": "date"
					},
					{
						"name": "InvStartDate",
						"type": "date"
					},
					{
						"name": "InvTypeCode",
						"type": "varchar"
					},
					{
						"name": "ItemListPriceCode",
						"type": "varchar"
					},
					{
						"name": "ItemTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "JobLocation",
						"type": "varchar"
					},
					{
						"name": "JobNumber",
						"type": "varchar"
					},
					{
						"name": "JobStatusCode",
						"type": "varchar"
					},
					{
						"name": "LaborRate",
						"type": "varchar"
					},
					{
						"name": "LaborTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "MapReference",
						"type": "varchar"
					},
					{
						"name": "MapZoneCode",
						"type": "varchar"
					},
					{
						"name": "MiscTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OpenPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OtherListPriceCode",
						"type": "varchar"
					},
					{
						"name": "PONumber",
						"type": "varchar"
					},
					{
						"name": "PaymentTypeCode",
						"type": "varchar"
					},
					{
						"name": "PickUpDate",
						"type": "date"
					},
					{
						"name": "Reference",
						"type": "varchar"
					},
					{
						"name": "SaleReferralCode",
						"type": "varchar"
					},
					{
						"name": "Salesperson1Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "ScheduleDate",
						"type": "date"
					},
					{
						"name": "SerialListPriceCode",
						"type": "varchar"
					},
					{
						"name": "SerialTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "SvcAgreementExpDate",
						"type": "date"
					},
					{
						"name": "SvcAgreementNumber",
						"type": "varchar"
					},
					{
						"name": "SvcBrandCode",
						"type": "varchar"
					},
					{
						"name": "SvcCenter",
						"type": "varchar"
					},
					{
						"name": "SvcCenterNumber",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintCode",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDatePurchased",
						"type": "date"
					},
					{
						"name": "SvcDealerCode",
						"type": "varchar"
					},
					{
						"name": "SvcDealerDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDistributorNumber",
						"type": "varchar"
					},
					{
						"name": "SvcInWarranty",
						"type": "varchar"
					},
					{
						"name": "SvcMfgCodeEiaNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMicroLeak",
						"type": "varchar"
					},
					{
						"name": "SvcMiles",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesRate",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcModel",
						"type": "varchar"
					},
					{
						"name": "SvcMotorNewNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMotorOldNumber",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedCode",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedDesc",
						"type": "varchar"
					},
					{
						"name": "SvcProduct",
						"type": "varchar"
					},
					{
						"name": "SvcProductCode",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCatMinorMajor",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCategory",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode",
						"type": "varchar"
					},
					{
						"name": "SvcRunNumber",
						"type": "varchar"
					},
					{
						"name": "SvcSerial",
						"type": "varchar"
					},
					{
						"name": "SvcSpecAuthNumber",
						"type": "varchar"
					},
					{
						"name": "SvcStockMerchandise",
						"type": "bit"
					},
					{
						"name": "SvcTimeCompleted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeCompleted2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted2",
						"type": "varchar"
					},
					{
						"name": "Tax1Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax1Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Code",
						"type": "varchar"
					},
					{
						"name": "Tax2Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax3Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax3Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UserCreated",
						"type": "varchar"
					},
					{
						"name": "UserModified",
						"type": "varchar"
					},
					{
						"name": "Warranty",
						"type": "varchar"
					},
					{
						"name": "WarrantyField1",
						"type": "varchar"
					},
					{
						"name": "WarrantyField2",
						"type": "varchar"
					},
					{
						"name": "WarrantyField3",
						"type": "varchar"
					},
					{
						"name": "WarrantyField4",
						"type": "varchar"
					},
					{
						"name": "WarrantyField5",
						"type": "varchar"
					},
					{
						"name": "WtyTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "Misc"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Landing_ModelDataset')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1_Landing Linked Service",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Financed",
						"type": "bit"
					},
					{
						"name": "Void",
						"type": "bit"
					},
					{
						"name": "Qualification",
						"type": "varchar"
					},
					{
						"name": "Priority",
						"type": "varchar"
					},
					{
						"name": "Tax3Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcRepairCode1",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode2",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode3",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode4",
						"type": "varchar"
					},
					{
						"name": "ContractCode",
						"type": "varchar"
					},
					{
						"name": "SvcContract",
						"type": "varchar"
					},
					{
						"name": "UserFinished",
						"type": "varchar"
					},
					{
						"name": "UserPosted",
						"type": "varchar"
					},
					{
						"name": "UpdateHistoryWarranty",
						"type": "bit"
					},
					{
						"name": "ShipMethod",
						"type": "varchar"
					},
					{
						"name": "TimeCreated",
						"type": "varchar"
					},
					{
						"name": "TimeModified",
						"type": "varchar"
					},
					{
						"name": "TimeFinished",
						"type": "varchar"
					},
					{
						"name": "DispatchUnits",
						"type": "int",
						"precision": 10
					},
					{
						"name": "EDIDateStamp",
						"type": "date"
					},
					{
						"name": "EDITimeStamp",
						"type": "varchar"
					},
					{
						"name": "PrintMethod",
						"type": "varchar"
					},
					{
						"name": "DispatchStartTime",
						"type": "varchar"
					},
					{
						"name": "TripChargeCode",
						"type": "varchar"
					},
					{
						"name": "TripChargeAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Locked",
						"type": "bit"
					},
					{
						"name": "MobileTechInvoiceCode",
						"type": "varchar"
					},
					{
						"name": "ServiceRequestID",
						"type": "varchar"
					},
					{
						"name": "CarrierCode",
						"type": "varchar"
					},
					{
						"name": "ShipViaCode",
						"type": "varchar"
					},
					{
						"name": "JobStatusUpdate",
						"type": "bit"
					},
					{
						"name": "DispatchEmail",
						"type": "bit"
					},
					{
						"name": "LastDateSaved",
						"type": "date"
					},
					{
						"name": "LastTimeSaved",
						"type": "varchar"
					},
					{
						"name": "Terms",
						"type": "varchar"
					},
					{
						"name": "SvcEquipmentNumber",
						"type": "varchar"
					},
					{
						"name": "WebOrderID",
						"type": "varchar"
					},
					{
						"name": "Department",
						"type": "varchar"
					},
					{
						"name": "CreditStatusCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedUserCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedDateStamp",
						"type": "date"
					},
					{
						"name": "CreditApprovedTimeStamp",
						"type": "varchar"
					},
					{
						"name": "EDIMaroline",
						"type": "bit"
					},
					{
						"name": "RequestedDate",
						"type": "date"
					},
					{
						"name": "SvcCSRInvoice",
						"type": "varchar"
					},
					{
						"name": "SvcSoldList",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcSoldSTDCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcFollowUpDate",
						"type": "date"
					},
					{
						"name": "SvcScheduleDate",
						"type": "date"
					},
					{
						"name": "Tax2MaxAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "EDIWhirlpool",
						"type": "bit"
					},
					{
						"name": "MinDepositPercent",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UnitModifier",
						"type": "int",
						"precision": 10
					},
					{
						"name": "DateFinished",
						"type": "date"
					},
					{
						"name": "DatePosted",
						"type": "date"
					},
					{
						"name": "TimePosted",
						"type": "varchar"
					},
					{
						"name": "TTRTaxCalculated",
						"type": "bit"
					},
					{
						"name": "PickUpBranchCode",
						"type": "varchar"
					},
					{
						"name": "PodiumOptOut",
						"type": "bit"
					},
					{
						"name": "SignCustmizedFields",
						"type": "varchar"
					},
					{
						"name": "AVBSaleDateSent",
						"type": "date"
					},
					{
						"name": "AVBSaleTimeSent",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "TTRJurisdictionCode",
						"type": "varchar"
					},
					{
						"name": "BranchCode",
						"type": "varchar"
					},
					{
						"name": "COGSPosted",
						"type": "bit"
					},
					{
						"name": "CallSequence",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "CommittedPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "DateCreated",
						"type": "date"
					},
					{
						"name": "DateModified",
						"type": "date"
					},
					{
						"name": "DispatchPriority",
						"type": "varchar"
					},
					{
						"name": "DispatchRequestedRouteCode",
						"type": "varchar"
					},
					{
						"name": "DispatchSpecRequest",
						"type": "varchar"
					},
					{
						"name": "DispatchTime",
						"type": "varchar"
					},
					{
						"name": "DispatchTimeAM",
						"type": "varchar"
					},
					{
						"name": "Estimate",
						"type": "varchar"
					},
					{
						"name": "Field1",
						"type": "varchar"
					},
					{
						"name": "Field2",
						"type": "varchar"
					},
					{
						"name": "Field3",
						"type": "varchar"
					},
					{
						"name": "Field4",
						"type": "varchar"
					},
					{
						"name": "Field5",
						"type": "varchar"
					},
					{
						"name": "InvFinishDate",
						"type": "date"
					},
					{
						"name": "InvStartDate",
						"type": "date"
					},
					{
						"name": "InvTypeCode",
						"type": "varchar"
					},
					{
						"name": "ItemListPriceCode",
						"type": "varchar"
					},
					{
						"name": "ItemTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "JobLocation",
						"type": "varchar"
					},
					{
						"name": "JobNumber",
						"type": "varchar"
					},
					{
						"name": "JobStatusCode",
						"type": "varchar"
					},
					{
						"name": "LaborRate",
						"type": "varchar"
					},
					{
						"name": "LaborTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "MapReference",
						"type": "varchar"
					},
					{
						"name": "MapZoneCode",
						"type": "varchar"
					},
					{
						"name": "MiscTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OpenPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OtherListPriceCode",
						"type": "varchar"
					},
					{
						"name": "PONumber",
						"type": "varchar"
					},
					{
						"name": "PaymentTypeCode",
						"type": "varchar"
					},
					{
						"name": "PickUpDate",
						"type": "date"
					},
					{
						"name": "Reference",
						"type": "varchar"
					},
					{
						"name": "SaleReferralCode",
						"type": "varchar"
					},
					{
						"name": "Salesperson1Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "ScheduleDate",
						"type": "date"
					},
					{
						"name": "SerialListPriceCode",
						"type": "varchar"
					},
					{
						"name": "SerialTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "SvcAgreementExpDate",
						"type": "date"
					},
					{
						"name": "SvcAgreementNumber",
						"type": "varchar"
					},
					{
						"name": "SvcBrandCode",
						"type": "varchar"
					},
					{
						"name": "SvcCenter",
						"type": "varchar"
					},
					{
						"name": "SvcCenterNumber",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintCode",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDatePurchased",
						"type": "date"
					},
					{
						"name": "SvcDealerCode",
						"type": "varchar"
					},
					{
						"name": "SvcDealerDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDistributorNumber",
						"type": "varchar"
					},
					{
						"name": "SvcInWarranty",
						"type": "varchar"
					},
					{
						"name": "SvcMfgCodeEiaNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMicroLeak",
						"type": "varchar"
					},
					{
						"name": "SvcMiles",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesRate",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcModel",
						"type": "varchar"
					},
					{
						"name": "SvcMotorNewNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMotorOldNumber",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedCode",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedDesc",
						"type": "varchar"
					},
					{
						"name": "SvcProduct",
						"type": "varchar"
					},
					{
						"name": "SvcProductCode",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCatMinorMajor",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCategory",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode",
						"type": "varchar"
					},
					{
						"name": "SvcRunNumber",
						"type": "varchar"
					},
					{
						"name": "SvcSerial",
						"type": "varchar"
					},
					{
						"name": "SvcSpecAuthNumber",
						"type": "varchar"
					},
					{
						"name": "SvcStockMerchandise",
						"type": "bit"
					},
					{
						"name": "SvcTimeCompleted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeCompleted2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted2",
						"type": "varchar"
					},
					{
						"name": "Tax1Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax1Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Code",
						"type": "varchar"
					},
					{
						"name": "Tax2Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax3Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax3Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UserCreated",
						"type": "varchar"
					},
					{
						"name": "UserModified",
						"type": "varchar"
					},
					{
						"name": "Warranty",
						"type": "varchar"
					},
					{
						"name": "WarrantyField1",
						"type": "varchar"
					},
					{
						"name": "WarrantyField2",
						"type": "varchar"
					},
					{
						"name": "WarrantyField3",
						"type": "varchar"
					},
					{
						"name": "WarrantyField4",
						"type": "varchar"
					},
					{
						"name": "WarrantyField5",
						"type": "varchar"
					},
					{
						"name": "WtyTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "Model"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Landing_ModelNote')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1_Landing Linked Service",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Financed",
						"type": "bit"
					},
					{
						"name": "Void",
						"type": "bit"
					},
					{
						"name": "Qualification",
						"type": "varchar"
					},
					{
						"name": "Priority",
						"type": "varchar"
					},
					{
						"name": "Tax3Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcRepairCode1",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode2",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode3",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode4",
						"type": "varchar"
					},
					{
						"name": "ContractCode",
						"type": "varchar"
					},
					{
						"name": "SvcContract",
						"type": "varchar"
					},
					{
						"name": "UserFinished",
						"type": "varchar"
					},
					{
						"name": "UserPosted",
						"type": "varchar"
					},
					{
						"name": "UpdateHistoryWarranty",
						"type": "bit"
					},
					{
						"name": "ShipMethod",
						"type": "varchar"
					},
					{
						"name": "TimeCreated",
						"type": "varchar"
					},
					{
						"name": "TimeModified",
						"type": "varchar"
					},
					{
						"name": "TimeFinished",
						"type": "varchar"
					},
					{
						"name": "DispatchUnits",
						"type": "int",
						"precision": 10
					},
					{
						"name": "EDIDateStamp",
						"type": "date"
					},
					{
						"name": "EDITimeStamp",
						"type": "varchar"
					},
					{
						"name": "PrintMethod",
						"type": "varchar"
					},
					{
						"name": "DispatchStartTime",
						"type": "varchar"
					},
					{
						"name": "TripChargeCode",
						"type": "varchar"
					},
					{
						"name": "TripChargeAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Locked",
						"type": "bit"
					},
					{
						"name": "MobileTechInvoiceCode",
						"type": "varchar"
					},
					{
						"name": "ServiceRequestID",
						"type": "varchar"
					},
					{
						"name": "CarrierCode",
						"type": "varchar"
					},
					{
						"name": "ShipViaCode",
						"type": "varchar"
					},
					{
						"name": "JobStatusUpdate",
						"type": "bit"
					},
					{
						"name": "DispatchEmail",
						"type": "bit"
					},
					{
						"name": "LastDateSaved",
						"type": "date"
					},
					{
						"name": "LastTimeSaved",
						"type": "varchar"
					},
					{
						"name": "Terms",
						"type": "varchar"
					},
					{
						"name": "SvcEquipmentNumber",
						"type": "varchar"
					},
					{
						"name": "WebOrderID",
						"type": "varchar"
					},
					{
						"name": "Department",
						"type": "varchar"
					},
					{
						"name": "CreditStatusCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedUserCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedDateStamp",
						"type": "date"
					},
					{
						"name": "CreditApprovedTimeStamp",
						"type": "varchar"
					},
					{
						"name": "EDIMaroline",
						"type": "bit"
					},
					{
						"name": "RequestedDate",
						"type": "date"
					},
					{
						"name": "SvcCSRInvoice",
						"type": "varchar"
					},
					{
						"name": "SvcSoldList",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcSoldSTDCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcFollowUpDate",
						"type": "date"
					},
					{
						"name": "SvcScheduleDate",
						"type": "date"
					},
					{
						"name": "Tax2MaxAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "EDIWhirlpool",
						"type": "bit"
					},
					{
						"name": "MinDepositPercent",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UnitModifier",
						"type": "int",
						"precision": 10
					},
					{
						"name": "DateFinished",
						"type": "date"
					},
					{
						"name": "DatePosted",
						"type": "date"
					},
					{
						"name": "TimePosted",
						"type": "varchar"
					},
					{
						"name": "TTRTaxCalculated",
						"type": "bit"
					},
					{
						"name": "PickUpBranchCode",
						"type": "varchar"
					},
					{
						"name": "PodiumOptOut",
						"type": "bit"
					},
					{
						"name": "SignCustmizedFields",
						"type": "varchar"
					},
					{
						"name": "AVBSaleDateSent",
						"type": "date"
					},
					{
						"name": "AVBSaleTimeSent",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "TTRJurisdictionCode",
						"type": "varchar"
					},
					{
						"name": "BranchCode",
						"type": "varchar"
					},
					{
						"name": "COGSPosted",
						"type": "bit"
					},
					{
						"name": "CallSequence",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "CommittedPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "DateCreated",
						"type": "date"
					},
					{
						"name": "DateModified",
						"type": "date"
					},
					{
						"name": "DispatchPriority",
						"type": "varchar"
					},
					{
						"name": "DispatchRequestedRouteCode",
						"type": "varchar"
					},
					{
						"name": "DispatchSpecRequest",
						"type": "varchar"
					},
					{
						"name": "DispatchTime",
						"type": "varchar"
					},
					{
						"name": "DispatchTimeAM",
						"type": "varchar"
					},
					{
						"name": "Estimate",
						"type": "varchar"
					},
					{
						"name": "Field1",
						"type": "varchar"
					},
					{
						"name": "Field2",
						"type": "varchar"
					},
					{
						"name": "Field3",
						"type": "varchar"
					},
					{
						"name": "Field4",
						"type": "varchar"
					},
					{
						"name": "Field5",
						"type": "varchar"
					},
					{
						"name": "InvFinishDate",
						"type": "date"
					},
					{
						"name": "InvStartDate",
						"type": "date"
					},
					{
						"name": "InvTypeCode",
						"type": "varchar"
					},
					{
						"name": "ItemListPriceCode",
						"type": "varchar"
					},
					{
						"name": "ItemTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "JobLocation",
						"type": "varchar"
					},
					{
						"name": "JobNumber",
						"type": "varchar"
					},
					{
						"name": "JobStatusCode",
						"type": "varchar"
					},
					{
						"name": "LaborRate",
						"type": "varchar"
					},
					{
						"name": "LaborTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "MapReference",
						"type": "varchar"
					},
					{
						"name": "MapZoneCode",
						"type": "varchar"
					},
					{
						"name": "MiscTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OpenPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OtherListPriceCode",
						"type": "varchar"
					},
					{
						"name": "PONumber",
						"type": "varchar"
					},
					{
						"name": "PaymentTypeCode",
						"type": "varchar"
					},
					{
						"name": "PickUpDate",
						"type": "date"
					},
					{
						"name": "Reference",
						"type": "varchar"
					},
					{
						"name": "SaleReferralCode",
						"type": "varchar"
					},
					{
						"name": "Salesperson1Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "ScheduleDate",
						"type": "date"
					},
					{
						"name": "SerialListPriceCode",
						"type": "varchar"
					},
					{
						"name": "SerialTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "SvcAgreementExpDate",
						"type": "date"
					},
					{
						"name": "SvcAgreementNumber",
						"type": "varchar"
					},
					{
						"name": "SvcBrandCode",
						"type": "varchar"
					},
					{
						"name": "SvcCenter",
						"type": "varchar"
					},
					{
						"name": "SvcCenterNumber",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintCode",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDatePurchased",
						"type": "date"
					},
					{
						"name": "SvcDealerCode",
						"type": "varchar"
					},
					{
						"name": "SvcDealerDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDistributorNumber",
						"type": "varchar"
					},
					{
						"name": "SvcInWarranty",
						"type": "varchar"
					},
					{
						"name": "SvcMfgCodeEiaNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMicroLeak",
						"type": "varchar"
					},
					{
						"name": "SvcMiles",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesRate",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcModel",
						"type": "varchar"
					},
					{
						"name": "SvcMotorNewNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMotorOldNumber",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedCode",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedDesc",
						"type": "varchar"
					},
					{
						"name": "SvcProduct",
						"type": "varchar"
					},
					{
						"name": "SvcProductCode",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCatMinorMajor",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCategory",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode",
						"type": "varchar"
					},
					{
						"name": "SvcRunNumber",
						"type": "varchar"
					},
					{
						"name": "SvcSerial",
						"type": "varchar"
					},
					{
						"name": "SvcSpecAuthNumber",
						"type": "varchar"
					},
					{
						"name": "SvcStockMerchandise",
						"type": "bit"
					},
					{
						"name": "SvcTimeCompleted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeCompleted2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted2",
						"type": "varchar"
					},
					{
						"name": "Tax1Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax1Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Code",
						"type": "varchar"
					},
					{
						"name": "Tax2Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax3Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax3Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UserCreated",
						"type": "varchar"
					},
					{
						"name": "UserModified",
						"type": "varchar"
					},
					{
						"name": "Warranty",
						"type": "varchar"
					},
					{
						"name": "WarrantyField1",
						"type": "varchar"
					},
					{
						"name": "WarrantyField2",
						"type": "varchar"
					},
					{
						"name": "WarrantyField3",
						"type": "varchar"
					},
					{
						"name": "WarrantyField4",
						"type": "varchar"
					},
					{
						"name": "WarrantyField5",
						"type": "varchar"
					},
					{
						"name": "WtyTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "ModelNote"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Landing_PODataset')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1_Landing Linked Service",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Financed",
						"type": "bit"
					},
					{
						"name": "Void",
						"type": "bit"
					},
					{
						"name": "Qualification",
						"type": "varchar"
					},
					{
						"name": "Priority",
						"type": "varchar"
					},
					{
						"name": "Tax3Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcRepairCode1",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode2",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode3",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode4",
						"type": "varchar"
					},
					{
						"name": "ContractCode",
						"type": "varchar"
					},
					{
						"name": "SvcContract",
						"type": "varchar"
					},
					{
						"name": "UserFinished",
						"type": "varchar"
					},
					{
						"name": "UserPosted",
						"type": "varchar"
					},
					{
						"name": "UpdateHistoryWarranty",
						"type": "bit"
					},
					{
						"name": "ShipMethod",
						"type": "varchar"
					},
					{
						"name": "TimeCreated",
						"type": "varchar"
					},
					{
						"name": "TimeModified",
						"type": "varchar"
					},
					{
						"name": "TimeFinished",
						"type": "varchar"
					},
					{
						"name": "DispatchUnits",
						"type": "int",
						"precision": 10
					},
					{
						"name": "EDIDateStamp",
						"type": "date"
					},
					{
						"name": "EDITimeStamp",
						"type": "varchar"
					},
					{
						"name": "PrintMethod",
						"type": "varchar"
					},
					{
						"name": "DispatchStartTime",
						"type": "varchar"
					},
					{
						"name": "TripChargeCode",
						"type": "varchar"
					},
					{
						"name": "TripChargeAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Locked",
						"type": "bit"
					},
					{
						"name": "MobileTechInvoiceCode",
						"type": "varchar"
					},
					{
						"name": "ServiceRequestID",
						"type": "varchar"
					},
					{
						"name": "CarrierCode",
						"type": "varchar"
					},
					{
						"name": "ShipViaCode",
						"type": "varchar"
					},
					{
						"name": "JobStatusUpdate",
						"type": "bit"
					},
					{
						"name": "DispatchEmail",
						"type": "bit"
					},
					{
						"name": "LastDateSaved",
						"type": "date"
					},
					{
						"name": "LastTimeSaved",
						"type": "varchar"
					},
					{
						"name": "Terms",
						"type": "varchar"
					},
					{
						"name": "SvcEquipmentNumber",
						"type": "varchar"
					},
					{
						"name": "WebOrderID",
						"type": "varchar"
					},
					{
						"name": "Department",
						"type": "varchar"
					},
					{
						"name": "CreditStatusCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedUserCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedDateStamp",
						"type": "date"
					},
					{
						"name": "CreditApprovedTimeStamp",
						"type": "varchar"
					},
					{
						"name": "EDIMaroline",
						"type": "bit"
					},
					{
						"name": "RequestedDate",
						"type": "date"
					},
					{
						"name": "SvcCSRInvoice",
						"type": "varchar"
					},
					{
						"name": "SvcSoldList",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcSoldSTDCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcFollowUpDate",
						"type": "date"
					},
					{
						"name": "SvcScheduleDate",
						"type": "date"
					},
					{
						"name": "Tax2MaxAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "EDIWhirlpool",
						"type": "bit"
					},
					{
						"name": "MinDepositPercent",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UnitModifier",
						"type": "int",
						"precision": 10
					},
					{
						"name": "DateFinished",
						"type": "date"
					},
					{
						"name": "DatePosted",
						"type": "date"
					},
					{
						"name": "TimePosted",
						"type": "varchar"
					},
					{
						"name": "TTRTaxCalculated",
						"type": "bit"
					},
					{
						"name": "PickUpBranchCode",
						"type": "varchar"
					},
					{
						"name": "PodiumOptOut",
						"type": "bit"
					},
					{
						"name": "SignCustmizedFields",
						"type": "varchar"
					},
					{
						"name": "AVBSaleDateSent",
						"type": "date"
					},
					{
						"name": "AVBSaleTimeSent",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "TTRJurisdictionCode",
						"type": "varchar"
					},
					{
						"name": "BranchCode",
						"type": "varchar"
					},
					{
						"name": "COGSPosted",
						"type": "bit"
					},
					{
						"name": "CallSequence",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "CommittedPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "DateCreated",
						"type": "date"
					},
					{
						"name": "DateModified",
						"type": "date"
					},
					{
						"name": "DispatchPriority",
						"type": "varchar"
					},
					{
						"name": "DispatchRequestedRouteCode",
						"type": "varchar"
					},
					{
						"name": "DispatchSpecRequest",
						"type": "varchar"
					},
					{
						"name": "DispatchTime",
						"type": "varchar"
					},
					{
						"name": "DispatchTimeAM",
						"type": "varchar"
					},
					{
						"name": "Estimate",
						"type": "varchar"
					},
					{
						"name": "Field1",
						"type": "varchar"
					},
					{
						"name": "Field2",
						"type": "varchar"
					},
					{
						"name": "Field3",
						"type": "varchar"
					},
					{
						"name": "Field4",
						"type": "varchar"
					},
					{
						"name": "Field5",
						"type": "varchar"
					},
					{
						"name": "InvFinishDate",
						"type": "date"
					},
					{
						"name": "InvStartDate",
						"type": "date"
					},
					{
						"name": "InvTypeCode",
						"type": "varchar"
					},
					{
						"name": "ItemListPriceCode",
						"type": "varchar"
					},
					{
						"name": "ItemTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "JobLocation",
						"type": "varchar"
					},
					{
						"name": "JobNumber",
						"type": "varchar"
					},
					{
						"name": "JobStatusCode",
						"type": "varchar"
					},
					{
						"name": "LaborRate",
						"type": "varchar"
					},
					{
						"name": "LaborTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "MapReference",
						"type": "varchar"
					},
					{
						"name": "MapZoneCode",
						"type": "varchar"
					},
					{
						"name": "MiscTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OpenPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OtherListPriceCode",
						"type": "varchar"
					},
					{
						"name": "PONumber",
						"type": "varchar"
					},
					{
						"name": "PaymentTypeCode",
						"type": "varchar"
					},
					{
						"name": "PickUpDate",
						"type": "date"
					},
					{
						"name": "Reference",
						"type": "varchar"
					},
					{
						"name": "SaleReferralCode",
						"type": "varchar"
					},
					{
						"name": "Salesperson1Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "ScheduleDate",
						"type": "date"
					},
					{
						"name": "SerialListPriceCode",
						"type": "varchar"
					},
					{
						"name": "SerialTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "SvcAgreementExpDate",
						"type": "date"
					},
					{
						"name": "SvcAgreementNumber",
						"type": "varchar"
					},
					{
						"name": "SvcBrandCode",
						"type": "varchar"
					},
					{
						"name": "SvcCenter",
						"type": "varchar"
					},
					{
						"name": "SvcCenterNumber",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintCode",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDatePurchased",
						"type": "date"
					},
					{
						"name": "SvcDealerCode",
						"type": "varchar"
					},
					{
						"name": "SvcDealerDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDistributorNumber",
						"type": "varchar"
					},
					{
						"name": "SvcInWarranty",
						"type": "varchar"
					},
					{
						"name": "SvcMfgCodeEiaNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMicroLeak",
						"type": "varchar"
					},
					{
						"name": "SvcMiles",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesRate",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcModel",
						"type": "varchar"
					},
					{
						"name": "SvcMotorNewNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMotorOldNumber",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedCode",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedDesc",
						"type": "varchar"
					},
					{
						"name": "SvcProduct",
						"type": "varchar"
					},
					{
						"name": "SvcProductCode",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCatMinorMajor",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCategory",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode",
						"type": "varchar"
					},
					{
						"name": "SvcRunNumber",
						"type": "varchar"
					},
					{
						"name": "SvcSerial",
						"type": "varchar"
					},
					{
						"name": "SvcSpecAuthNumber",
						"type": "varchar"
					},
					{
						"name": "SvcStockMerchandise",
						"type": "bit"
					},
					{
						"name": "SvcTimeCompleted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeCompleted2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted2",
						"type": "varchar"
					},
					{
						"name": "Tax1Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax1Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Code",
						"type": "varchar"
					},
					{
						"name": "Tax2Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax3Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax3Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UserCreated",
						"type": "varchar"
					},
					{
						"name": "UserModified",
						"type": "varchar"
					},
					{
						"name": "Warranty",
						"type": "varchar"
					},
					{
						"name": "WarrantyField1",
						"type": "varchar"
					},
					{
						"name": "WarrantyField2",
						"type": "varchar"
					},
					{
						"name": "WarrantyField3",
						"type": "varchar"
					},
					{
						"name": "WarrantyField4",
						"type": "varchar"
					},
					{
						"name": "WarrantyField5",
						"type": "varchar"
					},
					{
						"name": "WtyTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "PO"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Landing_POModelDataset')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1_Landing Linked Service",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Financed",
						"type": "bit"
					},
					{
						"name": "Void",
						"type": "bit"
					},
					{
						"name": "Qualification",
						"type": "varchar"
					},
					{
						"name": "Priority",
						"type": "varchar"
					},
					{
						"name": "Tax3Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcRepairCode1",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode2",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode3",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode4",
						"type": "varchar"
					},
					{
						"name": "ContractCode",
						"type": "varchar"
					},
					{
						"name": "SvcContract",
						"type": "varchar"
					},
					{
						"name": "UserFinished",
						"type": "varchar"
					},
					{
						"name": "UserPosted",
						"type": "varchar"
					},
					{
						"name": "UpdateHistoryWarranty",
						"type": "bit"
					},
					{
						"name": "ShipMethod",
						"type": "varchar"
					},
					{
						"name": "TimeCreated",
						"type": "varchar"
					},
					{
						"name": "TimeModified",
						"type": "varchar"
					},
					{
						"name": "TimeFinished",
						"type": "varchar"
					},
					{
						"name": "DispatchUnits",
						"type": "int",
						"precision": 10
					},
					{
						"name": "EDIDateStamp",
						"type": "date"
					},
					{
						"name": "EDITimeStamp",
						"type": "varchar"
					},
					{
						"name": "PrintMethod",
						"type": "varchar"
					},
					{
						"name": "DispatchStartTime",
						"type": "varchar"
					},
					{
						"name": "TripChargeCode",
						"type": "varchar"
					},
					{
						"name": "TripChargeAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Locked",
						"type": "bit"
					},
					{
						"name": "MobileTechInvoiceCode",
						"type": "varchar"
					},
					{
						"name": "ServiceRequestID",
						"type": "varchar"
					},
					{
						"name": "CarrierCode",
						"type": "varchar"
					},
					{
						"name": "ShipViaCode",
						"type": "varchar"
					},
					{
						"name": "JobStatusUpdate",
						"type": "bit"
					},
					{
						"name": "DispatchEmail",
						"type": "bit"
					},
					{
						"name": "LastDateSaved",
						"type": "date"
					},
					{
						"name": "LastTimeSaved",
						"type": "varchar"
					},
					{
						"name": "Terms",
						"type": "varchar"
					},
					{
						"name": "SvcEquipmentNumber",
						"type": "varchar"
					},
					{
						"name": "WebOrderID",
						"type": "varchar"
					},
					{
						"name": "Department",
						"type": "varchar"
					},
					{
						"name": "CreditStatusCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedUserCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedDateStamp",
						"type": "date"
					},
					{
						"name": "CreditApprovedTimeStamp",
						"type": "varchar"
					},
					{
						"name": "EDIMaroline",
						"type": "bit"
					},
					{
						"name": "RequestedDate",
						"type": "date"
					},
					{
						"name": "SvcCSRInvoice",
						"type": "varchar"
					},
					{
						"name": "SvcSoldList",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcSoldSTDCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcFollowUpDate",
						"type": "date"
					},
					{
						"name": "SvcScheduleDate",
						"type": "date"
					},
					{
						"name": "Tax2MaxAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "EDIWhirlpool",
						"type": "bit"
					},
					{
						"name": "MinDepositPercent",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UnitModifier",
						"type": "int",
						"precision": 10
					},
					{
						"name": "DateFinished",
						"type": "date"
					},
					{
						"name": "DatePosted",
						"type": "date"
					},
					{
						"name": "TimePosted",
						"type": "varchar"
					},
					{
						"name": "TTRTaxCalculated",
						"type": "bit"
					},
					{
						"name": "PickUpBranchCode",
						"type": "varchar"
					},
					{
						"name": "PodiumOptOut",
						"type": "bit"
					},
					{
						"name": "SignCustmizedFields",
						"type": "varchar"
					},
					{
						"name": "AVBSaleDateSent",
						"type": "date"
					},
					{
						"name": "AVBSaleTimeSent",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "TTRJurisdictionCode",
						"type": "varchar"
					},
					{
						"name": "BranchCode",
						"type": "varchar"
					},
					{
						"name": "COGSPosted",
						"type": "bit"
					},
					{
						"name": "CallSequence",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "CommittedPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "DateCreated",
						"type": "date"
					},
					{
						"name": "DateModified",
						"type": "date"
					},
					{
						"name": "DispatchPriority",
						"type": "varchar"
					},
					{
						"name": "DispatchRequestedRouteCode",
						"type": "varchar"
					},
					{
						"name": "DispatchSpecRequest",
						"type": "varchar"
					},
					{
						"name": "DispatchTime",
						"type": "varchar"
					},
					{
						"name": "DispatchTimeAM",
						"type": "varchar"
					},
					{
						"name": "Estimate",
						"type": "varchar"
					},
					{
						"name": "Field1",
						"type": "varchar"
					},
					{
						"name": "Field2",
						"type": "varchar"
					},
					{
						"name": "Field3",
						"type": "varchar"
					},
					{
						"name": "Field4",
						"type": "varchar"
					},
					{
						"name": "Field5",
						"type": "varchar"
					},
					{
						"name": "InvFinishDate",
						"type": "date"
					},
					{
						"name": "InvStartDate",
						"type": "date"
					},
					{
						"name": "InvTypeCode",
						"type": "varchar"
					},
					{
						"name": "ItemListPriceCode",
						"type": "varchar"
					},
					{
						"name": "ItemTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "JobLocation",
						"type": "varchar"
					},
					{
						"name": "JobNumber",
						"type": "varchar"
					},
					{
						"name": "JobStatusCode",
						"type": "varchar"
					},
					{
						"name": "LaborRate",
						"type": "varchar"
					},
					{
						"name": "LaborTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "MapReference",
						"type": "varchar"
					},
					{
						"name": "MapZoneCode",
						"type": "varchar"
					},
					{
						"name": "MiscTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OpenPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OtherListPriceCode",
						"type": "varchar"
					},
					{
						"name": "PONumber",
						"type": "varchar"
					},
					{
						"name": "PaymentTypeCode",
						"type": "varchar"
					},
					{
						"name": "PickUpDate",
						"type": "date"
					},
					{
						"name": "Reference",
						"type": "varchar"
					},
					{
						"name": "SaleReferralCode",
						"type": "varchar"
					},
					{
						"name": "Salesperson1Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "ScheduleDate",
						"type": "date"
					},
					{
						"name": "SerialListPriceCode",
						"type": "varchar"
					},
					{
						"name": "SerialTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "SvcAgreementExpDate",
						"type": "date"
					},
					{
						"name": "SvcAgreementNumber",
						"type": "varchar"
					},
					{
						"name": "SvcBrandCode",
						"type": "varchar"
					},
					{
						"name": "SvcCenter",
						"type": "varchar"
					},
					{
						"name": "SvcCenterNumber",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintCode",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDatePurchased",
						"type": "date"
					},
					{
						"name": "SvcDealerCode",
						"type": "varchar"
					},
					{
						"name": "SvcDealerDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDistributorNumber",
						"type": "varchar"
					},
					{
						"name": "SvcInWarranty",
						"type": "varchar"
					},
					{
						"name": "SvcMfgCodeEiaNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMicroLeak",
						"type": "varchar"
					},
					{
						"name": "SvcMiles",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesRate",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcModel",
						"type": "varchar"
					},
					{
						"name": "SvcMotorNewNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMotorOldNumber",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedCode",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedDesc",
						"type": "varchar"
					},
					{
						"name": "SvcProduct",
						"type": "varchar"
					},
					{
						"name": "SvcProductCode",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCatMinorMajor",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCategory",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode",
						"type": "varchar"
					},
					{
						"name": "SvcRunNumber",
						"type": "varchar"
					},
					{
						"name": "SvcSerial",
						"type": "varchar"
					},
					{
						"name": "SvcSpecAuthNumber",
						"type": "varchar"
					},
					{
						"name": "SvcStockMerchandise",
						"type": "bit"
					},
					{
						"name": "SvcTimeCompleted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeCompleted2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted2",
						"type": "varchar"
					},
					{
						"name": "Tax1Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax1Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Code",
						"type": "varchar"
					},
					{
						"name": "Tax2Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax3Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax3Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UserCreated",
						"type": "varchar"
					},
					{
						"name": "UserModified",
						"type": "varchar"
					},
					{
						"name": "Warranty",
						"type": "varchar"
					},
					{
						"name": "WarrantyField1",
						"type": "varchar"
					},
					{
						"name": "WarrantyField2",
						"type": "varchar"
					},
					{
						"name": "WarrantyField3",
						"type": "varchar"
					},
					{
						"name": "WarrantyField4",
						"type": "varchar"
					},
					{
						"name": "WarrantyField5",
						"type": "varchar"
					},
					{
						"name": "WtyTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "POModel"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Landing_POSerialDataset')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1_Landing Linked Service",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Financed",
						"type": "bit"
					},
					{
						"name": "Void",
						"type": "bit"
					},
					{
						"name": "Qualification",
						"type": "varchar"
					},
					{
						"name": "Priority",
						"type": "varchar"
					},
					{
						"name": "Tax3Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcRepairCode1",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode2",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode3",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode4",
						"type": "varchar"
					},
					{
						"name": "ContractCode",
						"type": "varchar"
					},
					{
						"name": "SvcContract",
						"type": "varchar"
					},
					{
						"name": "UserFinished",
						"type": "varchar"
					},
					{
						"name": "UserPosted",
						"type": "varchar"
					},
					{
						"name": "UpdateHistoryWarranty",
						"type": "bit"
					},
					{
						"name": "ShipMethod",
						"type": "varchar"
					},
					{
						"name": "TimeCreated",
						"type": "varchar"
					},
					{
						"name": "TimeModified",
						"type": "varchar"
					},
					{
						"name": "TimeFinished",
						"type": "varchar"
					},
					{
						"name": "DispatchUnits",
						"type": "int",
						"precision": 10
					},
					{
						"name": "EDIDateStamp",
						"type": "date"
					},
					{
						"name": "EDITimeStamp",
						"type": "varchar"
					},
					{
						"name": "PrintMethod",
						"type": "varchar"
					},
					{
						"name": "DispatchStartTime",
						"type": "varchar"
					},
					{
						"name": "TripChargeCode",
						"type": "varchar"
					},
					{
						"name": "TripChargeAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Locked",
						"type": "bit"
					},
					{
						"name": "MobileTechInvoiceCode",
						"type": "varchar"
					},
					{
						"name": "ServiceRequestID",
						"type": "varchar"
					},
					{
						"name": "CarrierCode",
						"type": "varchar"
					},
					{
						"name": "ShipViaCode",
						"type": "varchar"
					},
					{
						"name": "JobStatusUpdate",
						"type": "bit"
					},
					{
						"name": "DispatchEmail",
						"type": "bit"
					},
					{
						"name": "LastDateSaved",
						"type": "date"
					},
					{
						"name": "LastTimeSaved",
						"type": "varchar"
					},
					{
						"name": "Terms",
						"type": "varchar"
					},
					{
						"name": "SvcEquipmentNumber",
						"type": "varchar"
					},
					{
						"name": "WebOrderID",
						"type": "varchar"
					},
					{
						"name": "Department",
						"type": "varchar"
					},
					{
						"name": "CreditStatusCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedUserCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedDateStamp",
						"type": "date"
					},
					{
						"name": "CreditApprovedTimeStamp",
						"type": "varchar"
					},
					{
						"name": "EDIMaroline",
						"type": "bit"
					},
					{
						"name": "RequestedDate",
						"type": "date"
					},
					{
						"name": "SvcCSRInvoice",
						"type": "varchar"
					},
					{
						"name": "SvcSoldList",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcSoldSTDCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcFollowUpDate",
						"type": "date"
					},
					{
						"name": "SvcScheduleDate",
						"type": "date"
					},
					{
						"name": "Tax2MaxAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "EDIWhirlpool",
						"type": "bit"
					},
					{
						"name": "MinDepositPercent",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UnitModifier",
						"type": "int",
						"precision": 10
					},
					{
						"name": "DateFinished",
						"type": "date"
					},
					{
						"name": "DatePosted",
						"type": "date"
					},
					{
						"name": "TimePosted",
						"type": "varchar"
					},
					{
						"name": "TTRTaxCalculated",
						"type": "bit"
					},
					{
						"name": "PickUpBranchCode",
						"type": "varchar"
					},
					{
						"name": "PodiumOptOut",
						"type": "bit"
					},
					{
						"name": "SignCustmizedFields",
						"type": "varchar"
					},
					{
						"name": "AVBSaleDateSent",
						"type": "date"
					},
					{
						"name": "AVBSaleTimeSent",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "TTRJurisdictionCode",
						"type": "varchar"
					},
					{
						"name": "BranchCode",
						"type": "varchar"
					},
					{
						"name": "COGSPosted",
						"type": "bit"
					},
					{
						"name": "CallSequence",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "CommittedPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "DateCreated",
						"type": "date"
					},
					{
						"name": "DateModified",
						"type": "date"
					},
					{
						"name": "DispatchPriority",
						"type": "varchar"
					},
					{
						"name": "DispatchRequestedRouteCode",
						"type": "varchar"
					},
					{
						"name": "DispatchSpecRequest",
						"type": "varchar"
					},
					{
						"name": "DispatchTime",
						"type": "varchar"
					},
					{
						"name": "DispatchTimeAM",
						"type": "varchar"
					},
					{
						"name": "Estimate",
						"type": "varchar"
					},
					{
						"name": "Field1",
						"type": "varchar"
					},
					{
						"name": "Field2",
						"type": "varchar"
					},
					{
						"name": "Field3",
						"type": "varchar"
					},
					{
						"name": "Field4",
						"type": "varchar"
					},
					{
						"name": "Field5",
						"type": "varchar"
					},
					{
						"name": "InvFinishDate",
						"type": "date"
					},
					{
						"name": "InvStartDate",
						"type": "date"
					},
					{
						"name": "InvTypeCode",
						"type": "varchar"
					},
					{
						"name": "ItemListPriceCode",
						"type": "varchar"
					},
					{
						"name": "ItemTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "JobLocation",
						"type": "varchar"
					},
					{
						"name": "JobNumber",
						"type": "varchar"
					},
					{
						"name": "JobStatusCode",
						"type": "varchar"
					},
					{
						"name": "LaborRate",
						"type": "varchar"
					},
					{
						"name": "LaborTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "MapReference",
						"type": "varchar"
					},
					{
						"name": "MapZoneCode",
						"type": "varchar"
					},
					{
						"name": "MiscTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OpenPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OtherListPriceCode",
						"type": "varchar"
					},
					{
						"name": "PONumber",
						"type": "varchar"
					},
					{
						"name": "PaymentTypeCode",
						"type": "varchar"
					},
					{
						"name": "PickUpDate",
						"type": "date"
					},
					{
						"name": "Reference",
						"type": "varchar"
					},
					{
						"name": "SaleReferralCode",
						"type": "varchar"
					},
					{
						"name": "Salesperson1Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "ScheduleDate",
						"type": "date"
					},
					{
						"name": "SerialListPriceCode",
						"type": "varchar"
					},
					{
						"name": "SerialTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "SvcAgreementExpDate",
						"type": "date"
					},
					{
						"name": "SvcAgreementNumber",
						"type": "varchar"
					},
					{
						"name": "SvcBrandCode",
						"type": "varchar"
					},
					{
						"name": "SvcCenter",
						"type": "varchar"
					},
					{
						"name": "SvcCenterNumber",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintCode",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDatePurchased",
						"type": "date"
					},
					{
						"name": "SvcDealerCode",
						"type": "varchar"
					},
					{
						"name": "SvcDealerDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDistributorNumber",
						"type": "varchar"
					},
					{
						"name": "SvcInWarranty",
						"type": "varchar"
					},
					{
						"name": "SvcMfgCodeEiaNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMicroLeak",
						"type": "varchar"
					},
					{
						"name": "SvcMiles",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesRate",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcModel",
						"type": "varchar"
					},
					{
						"name": "SvcMotorNewNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMotorOldNumber",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedCode",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedDesc",
						"type": "varchar"
					},
					{
						"name": "SvcProduct",
						"type": "varchar"
					},
					{
						"name": "SvcProductCode",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCatMinorMajor",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCategory",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode",
						"type": "varchar"
					},
					{
						"name": "SvcRunNumber",
						"type": "varchar"
					},
					{
						"name": "SvcSerial",
						"type": "varchar"
					},
					{
						"name": "SvcSpecAuthNumber",
						"type": "varchar"
					},
					{
						"name": "SvcStockMerchandise",
						"type": "bit"
					},
					{
						"name": "SvcTimeCompleted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeCompleted2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted2",
						"type": "varchar"
					},
					{
						"name": "Tax1Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax1Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Code",
						"type": "varchar"
					},
					{
						"name": "Tax2Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax3Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax3Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UserCreated",
						"type": "varchar"
					},
					{
						"name": "UserModified",
						"type": "varchar"
					},
					{
						"name": "Warranty",
						"type": "varchar"
					},
					{
						"name": "WarrantyField1",
						"type": "varchar"
					},
					{
						"name": "WarrantyField2",
						"type": "varchar"
					},
					{
						"name": "WarrantyField3",
						"type": "varchar"
					},
					{
						"name": "WarrantyField4",
						"type": "varchar"
					},
					{
						"name": "WarrantyField5",
						"type": "varchar"
					},
					{
						"name": "WtyTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "POSerial"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Landing_ProductDataset')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1_Landing Linked Service",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Financed",
						"type": "bit"
					},
					{
						"name": "Void",
						"type": "bit"
					},
					{
						"name": "Qualification",
						"type": "varchar"
					},
					{
						"name": "Priority",
						"type": "varchar"
					},
					{
						"name": "Tax3Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcRepairCode1",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode2",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode3",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode4",
						"type": "varchar"
					},
					{
						"name": "ContractCode",
						"type": "varchar"
					},
					{
						"name": "SvcContract",
						"type": "varchar"
					},
					{
						"name": "UserFinished",
						"type": "varchar"
					},
					{
						"name": "UserPosted",
						"type": "varchar"
					},
					{
						"name": "UpdateHistoryWarranty",
						"type": "bit"
					},
					{
						"name": "ShipMethod",
						"type": "varchar"
					},
					{
						"name": "TimeCreated",
						"type": "varchar"
					},
					{
						"name": "TimeModified",
						"type": "varchar"
					},
					{
						"name": "TimeFinished",
						"type": "varchar"
					},
					{
						"name": "DispatchUnits",
						"type": "int",
						"precision": 10
					},
					{
						"name": "EDIDateStamp",
						"type": "date"
					},
					{
						"name": "EDITimeStamp",
						"type": "varchar"
					},
					{
						"name": "PrintMethod",
						"type": "varchar"
					},
					{
						"name": "DispatchStartTime",
						"type": "varchar"
					},
					{
						"name": "TripChargeCode",
						"type": "varchar"
					},
					{
						"name": "TripChargeAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Locked",
						"type": "bit"
					},
					{
						"name": "MobileTechInvoiceCode",
						"type": "varchar"
					},
					{
						"name": "ServiceRequestID",
						"type": "varchar"
					},
					{
						"name": "CarrierCode",
						"type": "varchar"
					},
					{
						"name": "ShipViaCode",
						"type": "varchar"
					},
					{
						"name": "JobStatusUpdate",
						"type": "bit"
					},
					{
						"name": "DispatchEmail",
						"type": "bit"
					},
					{
						"name": "LastDateSaved",
						"type": "date"
					},
					{
						"name": "LastTimeSaved",
						"type": "varchar"
					},
					{
						"name": "Terms",
						"type": "varchar"
					},
					{
						"name": "SvcEquipmentNumber",
						"type": "varchar"
					},
					{
						"name": "WebOrderID",
						"type": "varchar"
					},
					{
						"name": "Department",
						"type": "varchar"
					},
					{
						"name": "CreditStatusCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedUserCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedDateStamp",
						"type": "date"
					},
					{
						"name": "CreditApprovedTimeStamp",
						"type": "varchar"
					},
					{
						"name": "EDIMaroline",
						"type": "bit"
					},
					{
						"name": "RequestedDate",
						"type": "date"
					},
					{
						"name": "SvcCSRInvoice",
						"type": "varchar"
					},
					{
						"name": "SvcSoldList",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcSoldSTDCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcFollowUpDate",
						"type": "date"
					},
					{
						"name": "SvcScheduleDate",
						"type": "date"
					},
					{
						"name": "Tax2MaxAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "EDIWhirlpool",
						"type": "bit"
					},
					{
						"name": "MinDepositPercent",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UnitModifier",
						"type": "int",
						"precision": 10
					},
					{
						"name": "DateFinished",
						"type": "date"
					},
					{
						"name": "DatePosted",
						"type": "date"
					},
					{
						"name": "TimePosted",
						"type": "varchar"
					},
					{
						"name": "TTRTaxCalculated",
						"type": "bit"
					},
					{
						"name": "PickUpBranchCode",
						"type": "varchar"
					},
					{
						"name": "PodiumOptOut",
						"type": "bit"
					},
					{
						"name": "SignCustmizedFields",
						"type": "varchar"
					},
					{
						"name": "AVBSaleDateSent",
						"type": "date"
					},
					{
						"name": "AVBSaleTimeSent",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "TTRJurisdictionCode",
						"type": "varchar"
					},
					{
						"name": "BranchCode",
						"type": "varchar"
					},
					{
						"name": "COGSPosted",
						"type": "bit"
					},
					{
						"name": "CallSequence",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "CommittedPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "DateCreated",
						"type": "date"
					},
					{
						"name": "DateModified",
						"type": "date"
					},
					{
						"name": "DispatchPriority",
						"type": "varchar"
					},
					{
						"name": "DispatchRequestedRouteCode",
						"type": "varchar"
					},
					{
						"name": "DispatchSpecRequest",
						"type": "varchar"
					},
					{
						"name": "DispatchTime",
						"type": "varchar"
					},
					{
						"name": "DispatchTimeAM",
						"type": "varchar"
					},
					{
						"name": "Estimate",
						"type": "varchar"
					},
					{
						"name": "Field1",
						"type": "varchar"
					},
					{
						"name": "Field2",
						"type": "varchar"
					},
					{
						"name": "Field3",
						"type": "varchar"
					},
					{
						"name": "Field4",
						"type": "varchar"
					},
					{
						"name": "Field5",
						"type": "varchar"
					},
					{
						"name": "InvFinishDate",
						"type": "date"
					},
					{
						"name": "InvStartDate",
						"type": "date"
					},
					{
						"name": "InvTypeCode",
						"type": "varchar"
					},
					{
						"name": "ItemListPriceCode",
						"type": "varchar"
					},
					{
						"name": "ItemTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "JobLocation",
						"type": "varchar"
					},
					{
						"name": "JobNumber",
						"type": "varchar"
					},
					{
						"name": "JobStatusCode",
						"type": "varchar"
					},
					{
						"name": "LaborRate",
						"type": "varchar"
					},
					{
						"name": "LaborTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "MapReference",
						"type": "varchar"
					},
					{
						"name": "MapZoneCode",
						"type": "varchar"
					},
					{
						"name": "MiscTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OpenPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OtherListPriceCode",
						"type": "varchar"
					},
					{
						"name": "PONumber",
						"type": "varchar"
					},
					{
						"name": "PaymentTypeCode",
						"type": "varchar"
					},
					{
						"name": "PickUpDate",
						"type": "date"
					},
					{
						"name": "Reference",
						"type": "varchar"
					},
					{
						"name": "SaleReferralCode",
						"type": "varchar"
					},
					{
						"name": "Salesperson1Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "ScheduleDate",
						"type": "date"
					},
					{
						"name": "SerialListPriceCode",
						"type": "varchar"
					},
					{
						"name": "SerialTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "SvcAgreementExpDate",
						"type": "date"
					},
					{
						"name": "SvcAgreementNumber",
						"type": "varchar"
					},
					{
						"name": "SvcBrandCode",
						"type": "varchar"
					},
					{
						"name": "SvcCenter",
						"type": "varchar"
					},
					{
						"name": "SvcCenterNumber",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintCode",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDatePurchased",
						"type": "date"
					},
					{
						"name": "SvcDealerCode",
						"type": "varchar"
					},
					{
						"name": "SvcDealerDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDistributorNumber",
						"type": "varchar"
					},
					{
						"name": "SvcInWarranty",
						"type": "varchar"
					},
					{
						"name": "SvcMfgCodeEiaNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMicroLeak",
						"type": "varchar"
					},
					{
						"name": "SvcMiles",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesRate",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcModel",
						"type": "varchar"
					},
					{
						"name": "SvcMotorNewNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMotorOldNumber",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedCode",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedDesc",
						"type": "varchar"
					},
					{
						"name": "SvcProduct",
						"type": "varchar"
					},
					{
						"name": "SvcProductCode",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCatMinorMajor",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCategory",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode",
						"type": "varchar"
					},
					{
						"name": "SvcRunNumber",
						"type": "varchar"
					},
					{
						"name": "SvcSerial",
						"type": "varchar"
					},
					{
						"name": "SvcSpecAuthNumber",
						"type": "varchar"
					},
					{
						"name": "SvcStockMerchandise",
						"type": "bit"
					},
					{
						"name": "SvcTimeCompleted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeCompleted2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted2",
						"type": "varchar"
					},
					{
						"name": "Tax1Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax1Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Code",
						"type": "varchar"
					},
					{
						"name": "Tax2Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax3Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax3Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UserCreated",
						"type": "varchar"
					},
					{
						"name": "UserModified",
						"type": "varchar"
					},
					{
						"name": "Warranty",
						"type": "varchar"
					},
					{
						"name": "WarrantyField1",
						"type": "varchar"
					},
					{
						"name": "WarrantyField2",
						"type": "varchar"
					},
					{
						"name": "WarrantyField3",
						"type": "varchar"
					},
					{
						"name": "WarrantyField4",
						"type": "varchar"
					},
					{
						"name": "WarrantyField5",
						"type": "varchar"
					},
					{
						"name": "WtyTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "Product"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Landing_ProductMinorDataset')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1_Landing Linked Service",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Financed",
						"type": "bit"
					},
					{
						"name": "Void",
						"type": "bit"
					},
					{
						"name": "Qualification",
						"type": "varchar"
					},
					{
						"name": "Priority",
						"type": "varchar"
					},
					{
						"name": "Tax3Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcRepairCode1",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode2",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode3",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode4",
						"type": "varchar"
					},
					{
						"name": "ContractCode",
						"type": "varchar"
					},
					{
						"name": "SvcContract",
						"type": "varchar"
					},
					{
						"name": "UserFinished",
						"type": "varchar"
					},
					{
						"name": "UserPosted",
						"type": "varchar"
					},
					{
						"name": "UpdateHistoryWarranty",
						"type": "bit"
					},
					{
						"name": "ShipMethod",
						"type": "varchar"
					},
					{
						"name": "TimeCreated",
						"type": "varchar"
					},
					{
						"name": "TimeModified",
						"type": "varchar"
					},
					{
						"name": "TimeFinished",
						"type": "varchar"
					},
					{
						"name": "DispatchUnits",
						"type": "int",
						"precision": 10
					},
					{
						"name": "EDIDateStamp",
						"type": "date"
					},
					{
						"name": "EDITimeStamp",
						"type": "varchar"
					},
					{
						"name": "PrintMethod",
						"type": "varchar"
					},
					{
						"name": "DispatchStartTime",
						"type": "varchar"
					},
					{
						"name": "TripChargeCode",
						"type": "varchar"
					},
					{
						"name": "TripChargeAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Locked",
						"type": "bit"
					},
					{
						"name": "MobileTechInvoiceCode",
						"type": "varchar"
					},
					{
						"name": "ServiceRequestID",
						"type": "varchar"
					},
					{
						"name": "CarrierCode",
						"type": "varchar"
					},
					{
						"name": "ShipViaCode",
						"type": "varchar"
					},
					{
						"name": "JobStatusUpdate",
						"type": "bit"
					},
					{
						"name": "DispatchEmail",
						"type": "bit"
					},
					{
						"name": "LastDateSaved",
						"type": "date"
					},
					{
						"name": "LastTimeSaved",
						"type": "varchar"
					},
					{
						"name": "Terms",
						"type": "varchar"
					},
					{
						"name": "SvcEquipmentNumber",
						"type": "varchar"
					},
					{
						"name": "WebOrderID",
						"type": "varchar"
					},
					{
						"name": "Department",
						"type": "varchar"
					},
					{
						"name": "CreditStatusCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedUserCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedDateStamp",
						"type": "date"
					},
					{
						"name": "CreditApprovedTimeStamp",
						"type": "varchar"
					},
					{
						"name": "EDIMaroline",
						"type": "bit"
					},
					{
						"name": "RequestedDate",
						"type": "date"
					},
					{
						"name": "SvcCSRInvoice",
						"type": "varchar"
					},
					{
						"name": "SvcSoldList",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcSoldSTDCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcFollowUpDate",
						"type": "date"
					},
					{
						"name": "SvcScheduleDate",
						"type": "date"
					},
					{
						"name": "Tax2MaxAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "EDIWhirlpool",
						"type": "bit"
					},
					{
						"name": "MinDepositPercent",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UnitModifier",
						"type": "int",
						"precision": 10
					},
					{
						"name": "DateFinished",
						"type": "date"
					},
					{
						"name": "DatePosted",
						"type": "date"
					},
					{
						"name": "TimePosted",
						"type": "varchar"
					},
					{
						"name": "TTRTaxCalculated",
						"type": "bit"
					},
					{
						"name": "PickUpBranchCode",
						"type": "varchar"
					},
					{
						"name": "PodiumOptOut",
						"type": "bit"
					},
					{
						"name": "SignCustmizedFields",
						"type": "varchar"
					},
					{
						"name": "AVBSaleDateSent",
						"type": "date"
					},
					{
						"name": "AVBSaleTimeSent",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "TTRJurisdictionCode",
						"type": "varchar"
					},
					{
						"name": "BranchCode",
						"type": "varchar"
					},
					{
						"name": "COGSPosted",
						"type": "bit"
					},
					{
						"name": "CallSequence",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "CommittedPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "DateCreated",
						"type": "date"
					},
					{
						"name": "DateModified",
						"type": "date"
					},
					{
						"name": "DispatchPriority",
						"type": "varchar"
					},
					{
						"name": "DispatchRequestedRouteCode",
						"type": "varchar"
					},
					{
						"name": "DispatchSpecRequest",
						"type": "varchar"
					},
					{
						"name": "DispatchTime",
						"type": "varchar"
					},
					{
						"name": "DispatchTimeAM",
						"type": "varchar"
					},
					{
						"name": "Estimate",
						"type": "varchar"
					},
					{
						"name": "Field1",
						"type": "varchar"
					},
					{
						"name": "Field2",
						"type": "varchar"
					},
					{
						"name": "Field3",
						"type": "varchar"
					},
					{
						"name": "Field4",
						"type": "varchar"
					},
					{
						"name": "Field5",
						"type": "varchar"
					},
					{
						"name": "InvFinishDate",
						"type": "date"
					},
					{
						"name": "InvStartDate",
						"type": "date"
					},
					{
						"name": "InvTypeCode",
						"type": "varchar"
					},
					{
						"name": "ItemListPriceCode",
						"type": "varchar"
					},
					{
						"name": "ItemTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "JobLocation",
						"type": "varchar"
					},
					{
						"name": "JobNumber",
						"type": "varchar"
					},
					{
						"name": "JobStatusCode",
						"type": "varchar"
					},
					{
						"name": "LaborRate",
						"type": "varchar"
					},
					{
						"name": "LaborTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "MapReference",
						"type": "varchar"
					},
					{
						"name": "MapZoneCode",
						"type": "varchar"
					},
					{
						"name": "MiscTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OpenPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OtherListPriceCode",
						"type": "varchar"
					},
					{
						"name": "PONumber",
						"type": "varchar"
					},
					{
						"name": "PaymentTypeCode",
						"type": "varchar"
					},
					{
						"name": "PickUpDate",
						"type": "date"
					},
					{
						"name": "Reference",
						"type": "varchar"
					},
					{
						"name": "SaleReferralCode",
						"type": "varchar"
					},
					{
						"name": "Salesperson1Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "ScheduleDate",
						"type": "date"
					},
					{
						"name": "SerialListPriceCode",
						"type": "varchar"
					},
					{
						"name": "SerialTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "SvcAgreementExpDate",
						"type": "date"
					},
					{
						"name": "SvcAgreementNumber",
						"type": "varchar"
					},
					{
						"name": "SvcBrandCode",
						"type": "varchar"
					},
					{
						"name": "SvcCenter",
						"type": "varchar"
					},
					{
						"name": "SvcCenterNumber",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintCode",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDatePurchased",
						"type": "date"
					},
					{
						"name": "SvcDealerCode",
						"type": "varchar"
					},
					{
						"name": "SvcDealerDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDistributorNumber",
						"type": "varchar"
					},
					{
						"name": "SvcInWarranty",
						"type": "varchar"
					},
					{
						"name": "SvcMfgCodeEiaNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMicroLeak",
						"type": "varchar"
					},
					{
						"name": "SvcMiles",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesRate",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcModel",
						"type": "varchar"
					},
					{
						"name": "SvcMotorNewNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMotorOldNumber",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedCode",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedDesc",
						"type": "varchar"
					},
					{
						"name": "SvcProduct",
						"type": "varchar"
					},
					{
						"name": "SvcProductCode",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCatMinorMajor",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCategory",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode",
						"type": "varchar"
					},
					{
						"name": "SvcRunNumber",
						"type": "varchar"
					},
					{
						"name": "SvcSerial",
						"type": "varchar"
					},
					{
						"name": "SvcSpecAuthNumber",
						"type": "varchar"
					},
					{
						"name": "SvcStockMerchandise",
						"type": "bit"
					},
					{
						"name": "SvcTimeCompleted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeCompleted2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted2",
						"type": "varchar"
					},
					{
						"name": "Tax1Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax1Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Code",
						"type": "varchar"
					},
					{
						"name": "Tax2Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax3Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax3Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UserCreated",
						"type": "varchar"
					},
					{
						"name": "UserModified",
						"type": "varchar"
					},
					{
						"name": "Warranty",
						"type": "varchar"
					},
					{
						"name": "WarrantyField1",
						"type": "varchar"
					},
					{
						"name": "WarrantyField2",
						"type": "varchar"
					},
					{
						"name": "WarrantyField3",
						"type": "varchar"
					},
					{
						"name": "WarrantyField4",
						"type": "varchar"
					},
					{
						"name": "WarrantyField5",
						"type": "varchar"
					},
					{
						"name": "WtyTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "ProductMinor"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Landing_SaleReferralDataset')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1_Landing Linked Service",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Financed",
						"type": "bit"
					},
					{
						"name": "Void",
						"type": "bit"
					},
					{
						"name": "Qualification",
						"type": "varchar"
					},
					{
						"name": "Priority",
						"type": "varchar"
					},
					{
						"name": "Tax3Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcRepairCode1",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode2",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode3",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode4",
						"type": "varchar"
					},
					{
						"name": "ContractCode",
						"type": "varchar"
					},
					{
						"name": "SvcContract",
						"type": "varchar"
					},
					{
						"name": "UserFinished",
						"type": "varchar"
					},
					{
						"name": "UserPosted",
						"type": "varchar"
					},
					{
						"name": "UpdateHistoryWarranty",
						"type": "bit"
					},
					{
						"name": "ShipMethod",
						"type": "varchar"
					},
					{
						"name": "TimeCreated",
						"type": "varchar"
					},
					{
						"name": "TimeModified",
						"type": "varchar"
					},
					{
						"name": "TimeFinished",
						"type": "varchar"
					},
					{
						"name": "DispatchUnits",
						"type": "int",
						"precision": 10
					},
					{
						"name": "EDIDateStamp",
						"type": "date"
					},
					{
						"name": "EDITimeStamp",
						"type": "varchar"
					},
					{
						"name": "PrintMethod",
						"type": "varchar"
					},
					{
						"name": "DispatchStartTime",
						"type": "varchar"
					},
					{
						"name": "TripChargeCode",
						"type": "varchar"
					},
					{
						"name": "TripChargeAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Locked",
						"type": "bit"
					},
					{
						"name": "MobileTechInvoiceCode",
						"type": "varchar"
					},
					{
						"name": "ServiceRequestID",
						"type": "varchar"
					},
					{
						"name": "CarrierCode",
						"type": "varchar"
					},
					{
						"name": "ShipViaCode",
						"type": "varchar"
					},
					{
						"name": "JobStatusUpdate",
						"type": "bit"
					},
					{
						"name": "DispatchEmail",
						"type": "bit"
					},
					{
						"name": "LastDateSaved",
						"type": "date"
					},
					{
						"name": "LastTimeSaved",
						"type": "varchar"
					},
					{
						"name": "Terms",
						"type": "varchar"
					},
					{
						"name": "SvcEquipmentNumber",
						"type": "varchar"
					},
					{
						"name": "WebOrderID",
						"type": "varchar"
					},
					{
						"name": "Department",
						"type": "varchar"
					},
					{
						"name": "CreditStatusCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedUserCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedDateStamp",
						"type": "date"
					},
					{
						"name": "CreditApprovedTimeStamp",
						"type": "varchar"
					},
					{
						"name": "EDIMaroline",
						"type": "bit"
					},
					{
						"name": "RequestedDate",
						"type": "date"
					},
					{
						"name": "SvcCSRInvoice",
						"type": "varchar"
					},
					{
						"name": "SvcSoldList",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcSoldSTDCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcFollowUpDate",
						"type": "date"
					},
					{
						"name": "SvcScheduleDate",
						"type": "date"
					},
					{
						"name": "Tax2MaxAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "EDIWhirlpool",
						"type": "bit"
					},
					{
						"name": "MinDepositPercent",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UnitModifier",
						"type": "int",
						"precision": 10
					},
					{
						"name": "DateFinished",
						"type": "date"
					},
					{
						"name": "DatePosted",
						"type": "date"
					},
					{
						"name": "TimePosted",
						"type": "varchar"
					},
					{
						"name": "TTRTaxCalculated",
						"type": "bit"
					},
					{
						"name": "PickUpBranchCode",
						"type": "varchar"
					},
					{
						"name": "PodiumOptOut",
						"type": "bit"
					},
					{
						"name": "SignCustmizedFields",
						"type": "varchar"
					},
					{
						"name": "AVBSaleDateSent",
						"type": "date"
					},
					{
						"name": "AVBSaleTimeSent",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "TTRJurisdictionCode",
						"type": "varchar"
					},
					{
						"name": "BranchCode",
						"type": "varchar"
					},
					{
						"name": "COGSPosted",
						"type": "bit"
					},
					{
						"name": "CallSequence",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "CommittedPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "DateCreated",
						"type": "date"
					},
					{
						"name": "DateModified",
						"type": "date"
					},
					{
						"name": "DispatchPriority",
						"type": "varchar"
					},
					{
						"name": "DispatchRequestedRouteCode",
						"type": "varchar"
					},
					{
						"name": "DispatchSpecRequest",
						"type": "varchar"
					},
					{
						"name": "DispatchTime",
						"type": "varchar"
					},
					{
						"name": "DispatchTimeAM",
						"type": "varchar"
					},
					{
						"name": "Estimate",
						"type": "varchar"
					},
					{
						"name": "Field1",
						"type": "varchar"
					},
					{
						"name": "Field2",
						"type": "varchar"
					},
					{
						"name": "Field3",
						"type": "varchar"
					},
					{
						"name": "Field4",
						"type": "varchar"
					},
					{
						"name": "Field5",
						"type": "varchar"
					},
					{
						"name": "InvFinishDate",
						"type": "date"
					},
					{
						"name": "InvStartDate",
						"type": "date"
					},
					{
						"name": "InvTypeCode",
						"type": "varchar"
					},
					{
						"name": "ItemListPriceCode",
						"type": "varchar"
					},
					{
						"name": "ItemTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "JobLocation",
						"type": "varchar"
					},
					{
						"name": "JobNumber",
						"type": "varchar"
					},
					{
						"name": "JobStatusCode",
						"type": "varchar"
					},
					{
						"name": "LaborRate",
						"type": "varchar"
					},
					{
						"name": "LaborTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "MapReference",
						"type": "varchar"
					},
					{
						"name": "MapZoneCode",
						"type": "varchar"
					},
					{
						"name": "MiscTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OpenPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OtherListPriceCode",
						"type": "varchar"
					},
					{
						"name": "PONumber",
						"type": "varchar"
					},
					{
						"name": "PaymentTypeCode",
						"type": "varchar"
					},
					{
						"name": "PickUpDate",
						"type": "date"
					},
					{
						"name": "Reference",
						"type": "varchar"
					},
					{
						"name": "SaleReferralCode",
						"type": "varchar"
					},
					{
						"name": "Salesperson1Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "ScheduleDate",
						"type": "date"
					},
					{
						"name": "SerialListPriceCode",
						"type": "varchar"
					},
					{
						"name": "SerialTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "SvcAgreementExpDate",
						"type": "date"
					},
					{
						"name": "SvcAgreementNumber",
						"type": "varchar"
					},
					{
						"name": "SvcBrandCode",
						"type": "varchar"
					},
					{
						"name": "SvcCenter",
						"type": "varchar"
					},
					{
						"name": "SvcCenterNumber",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintCode",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDatePurchased",
						"type": "date"
					},
					{
						"name": "SvcDealerCode",
						"type": "varchar"
					},
					{
						"name": "SvcDealerDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDistributorNumber",
						"type": "varchar"
					},
					{
						"name": "SvcInWarranty",
						"type": "varchar"
					},
					{
						"name": "SvcMfgCodeEiaNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMicroLeak",
						"type": "varchar"
					},
					{
						"name": "SvcMiles",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesRate",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcModel",
						"type": "varchar"
					},
					{
						"name": "SvcMotorNewNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMotorOldNumber",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedCode",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedDesc",
						"type": "varchar"
					},
					{
						"name": "SvcProduct",
						"type": "varchar"
					},
					{
						"name": "SvcProductCode",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCatMinorMajor",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCategory",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode",
						"type": "varchar"
					},
					{
						"name": "SvcRunNumber",
						"type": "varchar"
					},
					{
						"name": "SvcSerial",
						"type": "varchar"
					},
					{
						"name": "SvcSpecAuthNumber",
						"type": "varchar"
					},
					{
						"name": "SvcStockMerchandise",
						"type": "bit"
					},
					{
						"name": "SvcTimeCompleted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeCompleted2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted2",
						"type": "varchar"
					},
					{
						"name": "Tax1Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax1Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Code",
						"type": "varchar"
					},
					{
						"name": "Tax2Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax3Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax3Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UserCreated",
						"type": "varchar"
					},
					{
						"name": "UserModified",
						"type": "varchar"
					},
					{
						"name": "Warranty",
						"type": "varchar"
					},
					{
						"name": "WarrantyField1",
						"type": "varchar"
					},
					{
						"name": "WarrantyField2",
						"type": "varchar"
					},
					{
						"name": "WarrantyField3",
						"type": "varchar"
					},
					{
						"name": "WarrantyField4",
						"type": "varchar"
					},
					{
						"name": "WarrantyField5",
						"type": "varchar"
					},
					{
						"name": "WtyTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "SaleReferral"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Landing_SalesPersonDataset')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1_Landing Linked Service",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "TakenStatus",
						"type": "varchar"
					},
					{
						"name": "TakenDate",
						"type": "date"
					},
					{
						"name": "AverageCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "StandardCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "LastCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Color",
						"type": "varchar"
					},
					{
						"name": "POCode",
						"type": "varchar"
					},
					{
						"name": "Reference",
						"type": "varchar"
					},
					{
						"name": "PODateStamp",
						"type": "date"
					},
					{
						"name": "POLineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "SpecialOrderDate",
						"type": "date"
					},
					{
						"name": "TripNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "LandedCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "AutoBackorder",
						"type": "bit"
					},
					{
						"name": "ManufacturersWarranty",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ReplacementCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UserVerified",
						"type": "varchar"
					},
					{
						"name": "DateVerified",
						"type": "date"
					},
					{
						"name": "TimeVerified",
						"type": "varchar"
					},
					{
						"name": "OriginalCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "ReserveExclusive",
						"type": "bit"
					},
					{
						"name": "CommissionCode",
						"type": "varchar"
					},
					{
						"name": "EDIFormat",
						"type": "varchar"
					},
					{
						"name": "BranchCode",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "DateCreated",
						"type": "date"
					},
					{
						"name": "DateModified",
						"type": "date"
					},
					{
						"name": "DateStamp",
						"type": "date"
					},
					{
						"name": "InPackage",
						"type": "bit"
					},
					{
						"name": "InvoiceCode",
						"type": "varchar"
					},
					{
						"name": "LineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "LocationCode",
						"type": "varchar"
					},
					{
						"name": "ModelCode",
						"type": "varchar"
					},
					{
						"name": "ModelDesc",
						"type": "varchar"
					},
					{
						"name": "NewUsed",
						"type": "varchar"
					},
					{
						"name": "QtyOrdered",
						"type": "int",
						"precision": 10
					},
					{
						"name": "QtyReserved",
						"type": "int",
						"precision": 10
					},
					{
						"name": "QtyShipped",
						"type": "int",
						"precision": 10
					},
					{
						"name": "SellingPrice",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Spiff",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "Tax1",
						"type": "bit"
					},
					{
						"name": "Tax1CostList",
						"type": "varchar"
					},
					{
						"name": "Tax1Included",
						"type": "bit"
					},
					{
						"name": "Tax1Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2",
						"type": "bit"
					},
					{
						"name": "Tax3",
						"type": "bit"
					},
					{
						"name": "Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UserCreated",
						"type": "varchar"
					},
					{
						"name": "UserModified",
						"type": "varchar"
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "Salesperson"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Landing_SerialDataset')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1_Landing Linked Service",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Financed",
						"type": "bit"
					},
					{
						"name": "Void",
						"type": "bit"
					},
					{
						"name": "Qualification",
						"type": "varchar"
					},
					{
						"name": "Priority",
						"type": "varchar"
					},
					{
						"name": "Tax3Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcRepairCode1",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode2",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode3",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode4",
						"type": "varchar"
					},
					{
						"name": "ContractCode",
						"type": "varchar"
					},
					{
						"name": "SvcContract",
						"type": "varchar"
					},
					{
						"name": "UserFinished",
						"type": "varchar"
					},
					{
						"name": "UserPosted",
						"type": "varchar"
					},
					{
						"name": "UpdateHistoryWarranty",
						"type": "bit"
					},
					{
						"name": "ShipMethod",
						"type": "varchar"
					},
					{
						"name": "TimeCreated",
						"type": "varchar"
					},
					{
						"name": "TimeModified",
						"type": "varchar"
					},
					{
						"name": "TimeFinished",
						"type": "varchar"
					},
					{
						"name": "DispatchUnits",
						"type": "int",
						"precision": 10
					},
					{
						"name": "EDIDateStamp",
						"type": "date"
					},
					{
						"name": "EDITimeStamp",
						"type": "varchar"
					},
					{
						"name": "PrintMethod",
						"type": "varchar"
					},
					{
						"name": "DispatchStartTime",
						"type": "varchar"
					},
					{
						"name": "TripChargeCode",
						"type": "varchar"
					},
					{
						"name": "TripChargeAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Locked",
						"type": "bit"
					},
					{
						"name": "MobileTechInvoiceCode",
						"type": "varchar"
					},
					{
						"name": "ServiceRequestID",
						"type": "varchar"
					},
					{
						"name": "CarrierCode",
						"type": "varchar"
					},
					{
						"name": "ShipViaCode",
						"type": "varchar"
					},
					{
						"name": "JobStatusUpdate",
						"type": "bit"
					},
					{
						"name": "DispatchEmail",
						"type": "bit"
					},
					{
						"name": "LastDateSaved",
						"type": "date"
					},
					{
						"name": "LastTimeSaved",
						"type": "varchar"
					},
					{
						"name": "Terms",
						"type": "varchar"
					},
					{
						"name": "SvcEquipmentNumber",
						"type": "varchar"
					},
					{
						"name": "WebOrderID",
						"type": "varchar"
					},
					{
						"name": "Department",
						"type": "varchar"
					},
					{
						"name": "CreditStatusCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedUserCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedDateStamp",
						"type": "date"
					},
					{
						"name": "CreditApprovedTimeStamp",
						"type": "varchar"
					},
					{
						"name": "EDIMaroline",
						"type": "bit"
					},
					{
						"name": "RequestedDate",
						"type": "date"
					},
					{
						"name": "SvcCSRInvoice",
						"type": "varchar"
					},
					{
						"name": "SvcSoldList",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcSoldSTDCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcFollowUpDate",
						"type": "date"
					},
					{
						"name": "SvcScheduleDate",
						"type": "date"
					},
					{
						"name": "Tax2MaxAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "EDIWhirlpool",
						"type": "bit"
					},
					{
						"name": "MinDepositPercent",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UnitModifier",
						"type": "int",
						"precision": 10
					},
					{
						"name": "DateFinished",
						"type": "date"
					},
					{
						"name": "DatePosted",
						"type": "date"
					},
					{
						"name": "TimePosted",
						"type": "varchar"
					},
					{
						"name": "TTRTaxCalculated",
						"type": "bit"
					},
					{
						"name": "PickUpBranchCode",
						"type": "varchar"
					},
					{
						"name": "PodiumOptOut",
						"type": "bit"
					},
					{
						"name": "SignCustmizedFields",
						"type": "varchar"
					},
					{
						"name": "AVBSaleDateSent",
						"type": "date"
					},
					{
						"name": "AVBSaleTimeSent",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "TTRJurisdictionCode",
						"type": "varchar"
					},
					{
						"name": "BranchCode",
						"type": "varchar"
					},
					{
						"name": "COGSPosted",
						"type": "bit"
					},
					{
						"name": "CallSequence",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "CommittedPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "DateCreated",
						"type": "date"
					},
					{
						"name": "DateModified",
						"type": "date"
					},
					{
						"name": "DispatchPriority",
						"type": "varchar"
					},
					{
						"name": "DispatchRequestedRouteCode",
						"type": "varchar"
					},
					{
						"name": "DispatchSpecRequest",
						"type": "varchar"
					},
					{
						"name": "DispatchTime",
						"type": "varchar"
					},
					{
						"name": "DispatchTimeAM",
						"type": "varchar"
					},
					{
						"name": "Estimate",
						"type": "varchar"
					},
					{
						"name": "Field1",
						"type": "varchar"
					},
					{
						"name": "Field2",
						"type": "varchar"
					},
					{
						"name": "Field3",
						"type": "varchar"
					},
					{
						"name": "Field4",
						"type": "varchar"
					},
					{
						"name": "Field5",
						"type": "varchar"
					},
					{
						"name": "InvFinishDate",
						"type": "date"
					},
					{
						"name": "InvStartDate",
						"type": "date"
					},
					{
						"name": "InvTypeCode",
						"type": "varchar"
					},
					{
						"name": "ItemListPriceCode",
						"type": "varchar"
					},
					{
						"name": "ItemTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "JobLocation",
						"type": "varchar"
					},
					{
						"name": "JobNumber",
						"type": "varchar"
					},
					{
						"name": "JobStatusCode",
						"type": "varchar"
					},
					{
						"name": "LaborRate",
						"type": "varchar"
					},
					{
						"name": "LaborTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "MapReference",
						"type": "varchar"
					},
					{
						"name": "MapZoneCode",
						"type": "varchar"
					},
					{
						"name": "MiscTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OpenPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OtherListPriceCode",
						"type": "varchar"
					},
					{
						"name": "PONumber",
						"type": "varchar"
					},
					{
						"name": "PaymentTypeCode",
						"type": "varchar"
					},
					{
						"name": "PickUpDate",
						"type": "date"
					},
					{
						"name": "Reference",
						"type": "varchar"
					},
					{
						"name": "SaleReferralCode",
						"type": "varchar"
					},
					{
						"name": "Salesperson1Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "ScheduleDate",
						"type": "date"
					},
					{
						"name": "SerialListPriceCode",
						"type": "varchar"
					},
					{
						"name": "SerialTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "SvcAgreementExpDate",
						"type": "date"
					},
					{
						"name": "SvcAgreementNumber",
						"type": "varchar"
					},
					{
						"name": "SvcBrandCode",
						"type": "varchar"
					},
					{
						"name": "SvcCenter",
						"type": "varchar"
					},
					{
						"name": "SvcCenterNumber",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintCode",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDatePurchased",
						"type": "date"
					},
					{
						"name": "SvcDealerCode",
						"type": "varchar"
					},
					{
						"name": "SvcDealerDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDistributorNumber",
						"type": "varchar"
					},
					{
						"name": "SvcInWarranty",
						"type": "varchar"
					},
					{
						"name": "SvcMfgCodeEiaNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMicroLeak",
						"type": "varchar"
					},
					{
						"name": "SvcMiles",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesRate",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcModel",
						"type": "varchar"
					},
					{
						"name": "SvcMotorNewNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMotorOldNumber",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedCode",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedDesc",
						"type": "varchar"
					},
					{
						"name": "SvcProduct",
						"type": "varchar"
					},
					{
						"name": "SvcProductCode",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCatMinorMajor",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCategory",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode",
						"type": "varchar"
					},
					{
						"name": "SvcRunNumber",
						"type": "varchar"
					},
					{
						"name": "SvcSerial",
						"type": "varchar"
					},
					{
						"name": "SvcSpecAuthNumber",
						"type": "varchar"
					},
					{
						"name": "SvcStockMerchandise",
						"type": "bit"
					},
					{
						"name": "SvcTimeCompleted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeCompleted2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted2",
						"type": "varchar"
					},
					{
						"name": "Tax1Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax1Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Code",
						"type": "varchar"
					},
					{
						"name": "Tax2Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax3Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax3Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UserCreated",
						"type": "varchar"
					},
					{
						"name": "UserModified",
						"type": "varchar"
					},
					{
						"name": "Warranty",
						"type": "varchar"
					},
					{
						"name": "WarrantyField1",
						"type": "varchar"
					},
					{
						"name": "WarrantyField2",
						"type": "varchar"
					},
					{
						"name": "WarrantyField3",
						"type": "varchar"
					},
					{
						"name": "WarrantyField4",
						"type": "varchar"
					},
					{
						"name": "WarrantyField5",
						"type": "varchar"
					},
					{
						"name": "WtyTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "Serial"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Landing_SupplierDataset')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1_Landing Linked Service",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Financed",
						"type": "bit"
					},
					{
						"name": "Void",
						"type": "bit"
					},
					{
						"name": "Qualification",
						"type": "varchar"
					},
					{
						"name": "Priority",
						"type": "varchar"
					},
					{
						"name": "Tax3Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcRepairCode1",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode2",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode3",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode4",
						"type": "varchar"
					},
					{
						"name": "ContractCode",
						"type": "varchar"
					},
					{
						"name": "SvcContract",
						"type": "varchar"
					},
					{
						"name": "UserFinished",
						"type": "varchar"
					},
					{
						"name": "UserPosted",
						"type": "varchar"
					},
					{
						"name": "UpdateHistoryWarranty",
						"type": "bit"
					},
					{
						"name": "ShipMethod",
						"type": "varchar"
					},
					{
						"name": "TimeCreated",
						"type": "varchar"
					},
					{
						"name": "TimeModified",
						"type": "varchar"
					},
					{
						"name": "TimeFinished",
						"type": "varchar"
					},
					{
						"name": "DispatchUnits",
						"type": "int",
						"precision": 10
					},
					{
						"name": "EDIDateStamp",
						"type": "date"
					},
					{
						"name": "EDITimeStamp",
						"type": "varchar"
					},
					{
						"name": "PrintMethod",
						"type": "varchar"
					},
					{
						"name": "DispatchStartTime",
						"type": "varchar"
					},
					{
						"name": "TripChargeCode",
						"type": "varchar"
					},
					{
						"name": "TripChargeAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Locked",
						"type": "bit"
					},
					{
						"name": "MobileTechInvoiceCode",
						"type": "varchar"
					},
					{
						"name": "ServiceRequestID",
						"type": "varchar"
					},
					{
						"name": "CarrierCode",
						"type": "varchar"
					},
					{
						"name": "ShipViaCode",
						"type": "varchar"
					},
					{
						"name": "JobStatusUpdate",
						"type": "bit"
					},
					{
						"name": "DispatchEmail",
						"type": "bit"
					},
					{
						"name": "LastDateSaved",
						"type": "date"
					},
					{
						"name": "LastTimeSaved",
						"type": "varchar"
					},
					{
						"name": "Terms",
						"type": "varchar"
					},
					{
						"name": "SvcEquipmentNumber",
						"type": "varchar"
					},
					{
						"name": "WebOrderID",
						"type": "varchar"
					},
					{
						"name": "Department",
						"type": "varchar"
					},
					{
						"name": "CreditStatusCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedUserCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedDateStamp",
						"type": "date"
					},
					{
						"name": "CreditApprovedTimeStamp",
						"type": "varchar"
					},
					{
						"name": "EDIMaroline",
						"type": "bit"
					},
					{
						"name": "RequestedDate",
						"type": "date"
					},
					{
						"name": "SvcCSRInvoice",
						"type": "varchar"
					},
					{
						"name": "SvcSoldList",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcSoldSTDCost",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcFollowUpDate",
						"type": "date"
					},
					{
						"name": "SvcScheduleDate",
						"type": "date"
					},
					{
						"name": "Tax2MaxAmount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "EDIWhirlpool",
						"type": "bit"
					},
					{
						"name": "MinDepositPercent",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UnitModifier",
						"type": "int",
						"precision": 10
					},
					{
						"name": "DateFinished",
						"type": "date"
					},
					{
						"name": "DatePosted",
						"type": "date"
					},
					{
						"name": "TimePosted",
						"type": "varchar"
					},
					{
						"name": "TTRTaxCalculated",
						"type": "bit"
					},
					{
						"name": "PickUpBranchCode",
						"type": "varchar"
					},
					{
						"name": "PodiumOptOut",
						"type": "bit"
					},
					{
						"name": "SignCustmizedFields",
						"type": "varchar"
					},
					{
						"name": "AVBSaleDateSent",
						"type": "date"
					},
					{
						"name": "AVBSaleTimeSent",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "TTRJurisdictionCode",
						"type": "varchar"
					},
					{
						"name": "BranchCode",
						"type": "varchar"
					},
					{
						"name": "COGSPosted",
						"type": "bit"
					},
					{
						"name": "CallSequence",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "CommittedPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "DateCreated",
						"type": "date"
					},
					{
						"name": "DateModified",
						"type": "date"
					},
					{
						"name": "DispatchPriority",
						"type": "varchar"
					},
					{
						"name": "DispatchRequestedRouteCode",
						"type": "varchar"
					},
					{
						"name": "DispatchSpecRequest",
						"type": "varchar"
					},
					{
						"name": "DispatchTime",
						"type": "varchar"
					},
					{
						"name": "DispatchTimeAM",
						"type": "varchar"
					},
					{
						"name": "Estimate",
						"type": "varchar"
					},
					{
						"name": "Field1",
						"type": "varchar"
					},
					{
						"name": "Field2",
						"type": "varchar"
					},
					{
						"name": "Field3",
						"type": "varchar"
					},
					{
						"name": "Field4",
						"type": "varchar"
					},
					{
						"name": "Field5",
						"type": "varchar"
					},
					{
						"name": "InvFinishDate",
						"type": "date"
					},
					{
						"name": "InvStartDate",
						"type": "date"
					},
					{
						"name": "InvTypeCode",
						"type": "varchar"
					},
					{
						"name": "ItemListPriceCode",
						"type": "varchar"
					},
					{
						"name": "ItemTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "JobLocation",
						"type": "varchar"
					},
					{
						"name": "JobNumber",
						"type": "varchar"
					},
					{
						"name": "JobStatusCode",
						"type": "varchar"
					},
					{
						"name": "LaborRate",
						"type": "varchar"
					},
					{
						"name": "LaborTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "MapReference",
						"type": "varchar"
					},
					{
						"name": "MapZoneCode",
						"type": "varchar"
					},
					{
						"name": "MiscTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OpenPaymentTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "OtherListPriceCode",
						"type": "varchar"
					},
					{
						"name": "PONumber",
						"type": "varchar"
					},
					{
						"name": "PaymentTypeCode",
						"type": "varchar"
					},
					{
						"name": "PickUpDate",
						"type": "date"
					},
					{
						"name": "Reference",
						"type": "varchar"
					},
					{
						"name": "SaleReferralCode",
						"type": "varchar"
					},
					{
						"name": "Salesperson1Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "ScheduleDate",
						"type": "date"
					},
					{
						"name": "SerialListPriceCode",
						"type": "varchar"
					},
					{
						"name": "SerialTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "SvcAgreementExpDate",
						"type": "date"
					},
					{
						"name": "SvcAgreementNumber",
						"type": "varchar"
					},
					{
						"name": "SvcBrandCode",
						"type": "varchar"
					},
					{
						"name": "SvcCenter",
						"type": "varchar"
					},
					{
						"name": "SvcCenterNumber",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintCode",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDatePurchased",
						"type": "date"
					},
					{
						"name": "SvcDealerCode",
						"type": "varchar"
					},
					{
						"name": "SvcDealerDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDistributorNumber",
						"type": "varchar"
					},
					{
						"name": "SvcInWarranty",
						"type": "varchar"
					},
					{
						"name": "SvcMfgCodeEiaNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMicroLeak",
						"type": "varchar"
					},
					{
						"name": "SvcMiles",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesRate",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcMilesTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "SvcModel",
						"type": "varchar"
					},
					{
						"name": "SvcMotorNewNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMotorOldNumber",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedCode",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedDesc",
						"type": "varchar"
					},
					{
						"name": "SvcProduct",
						"type": "varchar"
					},
					{
						"name": "SvcProductCode",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCatMinorMajor",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCategory",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode",
						"type": "varchar"
					},
					{
						"name": "SvcRunNumber",
						"type": "varchar"
					},
					{
						"name": "SvcSerial",
						"type": "varchar"
					},
					{
						"name": "SvcSpecAuthNumber",
						"type": "varchar"
					},
					{
						"name": "SvcStockMerchandise",
						"type": "bit"
					},
					{
						"name": "SvcTimeCompleted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeCompleted2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted2",
						"type": "varchar"
					},
					{
						"name": "Tax1Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax1Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Code",
						"type": "varchar"
					},
					{
						"name": "Tax2Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax2Percentage",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax2Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Tax3Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax3Total",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "UserCreated",
						"type": "varchar"
					},
					{
						"name": "UserModified",
						"type": "varchar"
					},
					{
						"name": "Warranty",
						"type": "varchar"
					},
					{
						"name": "WarrantyField1",
						"type": "varchar"
					},
					{
						"name": "WarrantyField2",
						"type": "varchar"
					},
					{
						"name": "WarrantyField3",
						"type": "varchar"
					},
					{
						"name": "WarrantyField4",
						"type": "varchar"
					},
					{
						"name": "WarrantyField5",
						"type": "varchar"
					},
					{
						"name": "WtyTotal",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "Supplier"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Landing_watermarktableDataset')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1_Landing Linked Service",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "invoicewatermark_value",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					}
				],
				"typeProperties": {
					"schema": "dbo",
					"table": "watermark_table"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/ModelODS')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1LinkedService_Test",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "TripNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ParentDateStamp",
						"type": "date"
					},
					{
						"name": "ParentLineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "Amount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "DateStamp",
						"type": "date"
					},
					{
						"name": "Description",
						"type": "varchar"
					},
					{
						"name": "InPackage",
						"type": "varchar"
					},
					{
						"name": "InvoiceCode",
						"type": "varchar"
					},
					{
						"name": "LineNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "LineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "LineType",
						"type": "varchar"
					},
					{
						"name": "LocationCode",
						"type": "varchar"
					},
					{
						"name": "Qty",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "Tax1",
						"type": "bit"
					},
					{
						"name": "Tax2",
						"type": "bit"
					},
					{
						"name": "Tax3",
						"type": "bit"
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "Model"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/OdbcDataSource')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Connection to your source data store.",
				"linkedServiceName": {
					"referenceName": "Odbc1",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "OdbcTable",
				"schema": [],
				"typeProperties": {
					"tableName": "DataSourceTable"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/POODS')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1LinkedService_Test",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "TripNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ParentDateStamp",
						"type": "date"
					},
					{
						"name": "ParentLineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "Amount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "DateStamp",
						"type": "date"
					},
					{
						"name": "Description",
						"type": "varchar"
					},
					{
						"name": "InPackage",
						"type": "varchar"
					},
					{
						"name": "InvoiceCode",
						"type": "varchar"
					},
					{
						"name": "LineNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "LineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "LineType",
						"type": "varchar"
					},
					{
						"name": "LocationCode",
						"type": "varchar"
					},
					{
						"name": "Qty",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "Tax1",
						"type": "bit"
					},
					{
						"name": "Tax2",
						"type": "bit"
					},
					{
						"name": "Tax3",
						"type": "bit"
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "PO"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Secondary1_Sink')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1LinkedService_Test",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Financed",
						"type": "bit"
					},
					{
						"name": "Void",
						"type": "bit"
					},
					{
						"name": "SoldToCityCode",
						"type": "varchar"
					},
					{
						"name": "BillToSuite",
						"type": "varchar"
					},
					{
						"name": "SoldToSuite",
						"type": "varchar"
					},
					{
						"name": "Qualification",
						"type": "varchar"
					},
					{
						"name": "Priority",
						"type": "varchar"
					},
					{
						"name": "Tax3Percentage",
						"type": "decimal",
						"precision": 18,
						"scale": 0
					},
					{
						"name": "SvcRepairCode1",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode2",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode3",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode4",
						"type": "varchar"
					},
					{
						"name": "ContractCode",
						"type": "varchar"
					},
					{
						"name": "SvcContract",
						"type": "varchar"
					},
					{
						"name": "UserFinished",
						"type": "varchar"
					},
					{
						"name": "UserPosted",
						"type": "varchar"
					},
					{
						"name": "UpdateHistoryWarranty",
						"type": "bit"
					},
					{
						"name": "ShipMethod",
						"type": "varchar"
					},
					{
						"name": "TimeCreated",
						"type": "varchar"
					},
					{
						"name": "TimeModified",
						"type": "varchar"
					},
					{
						"name": "TimeFinished",
						"type": "varchar"
					},
					{
						"name": "DispatchUnits",
						"type": "int",
						"precision": 10
					},
					{
						"name": "EDIDateStamp",
						"type": "date"
					},
					{
						"name": "EDITimeStamp",
						"type": "varchar"
					},
					{
						"name": "PrintMethod",
						"type": "varchar"
					},
					{
						"name": "DispatchStartTime",
						"type": "varchar"
					},
					{
						"name": "TripChargeCode",
						"type": "varchar"
					},
					{
						"name": "TripChargeAmount",
						"type": "decimal",
						"precision": 18,
						"scale": 0
					},
					{
						"name": "Locked",
						"type": "bit"
					},
					{
						"name": "MobileTechInvoiceCode",
						"type": "varchar"
					},
					{
						"name": "ServiceRequestID",
						"type": "varchar"
					},
					{
						"name": "CarrierCode",
						"type": "varchar"
					},
					{
						"name": "ShipViaCode",
						"type": "varchar"
					},
					{
						"name": "SoldToLatitude",
						"type": "decimal",
						"precision": 18,
						"scale": 0
					},
					{
						"name": "SoldToLongitude",
						"type": "decimal",
						"precision": 18,
						"scale": 0
					},
					{
						"name": "JobStatusUpdate",
						"type": "bit"
					},
					{
						"name": "DispatchEmail",
						"type": "bit"
					},
					{
						"name": "LastDateSaved",
						"type": "date"
					},
					{
						"name": "LastTimeSaved",
						"type": "varchar"
					},
					{
						"name": "SoldToBusinessPhone",
						"type": "varchar"
					},
					{
						"name": "SoldToFax",
						"type": "varchar"
					},
					{
						"name": "BillToBusinessPhone",
						"type": "varchar"
					},
					{
						"name": "BillToFax",
						"type": "varchar"
					},
					{
						"name": "SoldToPhone1TextEnabled",
						"type": "bit"
					},
					{
						"name": "SoldToPhone2TextEnabled",
						"type": "bit"
					},
					{
						"name": "SoldToBusinessPhoneTextEnabled",
						"type": "bit"
					},
					{
						"name": "SoldToFaxTextEnabled",
						"type": "bit"
					},
					{
						"name": "BillToPhone1TextEnabled",
						"type": "bit"
					},
					{
						"name": "BillToPhone2TextEnabled",
						"type": "bit"
					},
					{
						"name": "BillToBusinessPhoneTextEnabled",
						"type": "bit"
					},
					{
						"name": "BillToFaxTextEnabled",
						"type": "bit"
					},
					{
						"name": "Terms",
						"type": "varchar"
					},
					{
						"name": "SvcEquipmentNumber",
						"type": "varchar"
					},
					{
						"name": "SoldToPreferredContact",
						"type": "varchar"
					},
					{
						"name": "BillToPreferredContact",
						"type": "varchar"
					},
					{
						"name": "WebOrderID",
						"type": "varchar"
					},
					{
						"name": "Department",
						"type": "varchar"
					},
					{
						"name": "CreditStatusCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedUserCode",
						"type": "varchar"
					},
					{
						"name": "CreditApprovedDateStamp",
						"type": "date"
					},
					{
						"name": "CreditApprovedTimeStamp",
						"type": "varchar"
					},
					{
						"name": "EDIMaroline",
						"type": "bit"
					},
					{
						"name": "RequestedDate",
						"type": "date"
					},
					{
						"name": "SvcCSRInvoice",
						"type": "varchar"
					},
					{
						"name": "SvcSoldList",
						"type": "decimal",
						"precision": 18,
						"scale": 0
					},
					{
						"name": "SvcSoldSTDCost",
						"type": "decimal",
						"precision": 18,
						"scale": 0
					},
					{
						"name": "SvcFollowUpDate",
						"type": "date"
					},
					{
						"name": "SvcScheduleDate",
						"type": "date"
					},
					{
						"name": "Tax2MaxAmount",
						"type": "decimal",
						"precision": 18,
						"scale": 0
					},
					{
						"name": "EDIWhirlpool",
						"type": "bit"
					},
					{
						"name": "SoldToDeclineEmail",
						"type": "bit"
					},
					{
						"name": "MinDepositPercent",
						"type": "decimal",
						"precision": 18,
						"scale": 0
					},
					{
						"name": "UnitModifier",
						"type": "int",
						"precision": 10
					},
					{
						"name": "DateFinished",
						"type": "date"
					},
					{
						"name": "DatePosted",
						"type": "date"
					},
					{
						"name": "TimePosted",
						"type": "varchar"
					},
					{
						"name": "TTRTaxCalculated",
						"type": "bit"
					},
					{
						"name": "PickUpBranchCode",
						"type": "varchar"
					},
					{
						"name": "PodiumOptOut",
						"type": "bit"
					},
					{
						"name": "SignCustmizedFields",
						"type": "varchar"
					},
					{
						"name": "AVBSaleDateSent",
						"type": "date"
					},
					{
						"name": "AVBSaleTimeSent",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "TTRJurisdictionCode",
						"type": "varchar"
					},
					{
						"name": "BillToAddress1",
						"type": "varchar"
					},
					{
						"name": "BillToAddress2",
						"type": "varchar"
					},
					{
						"name": "BillToCity",
						"type": "varchar"
					},
					{
						"name": "BillToCode",
						"type": "varchar"
					},
					{
						"name": "BillToEmail",
						"type": "varchar"
					},
					{
						"name": "BillToFirstName",
						"type": "varchar"
					},
					{
						"name": "BillToLastName",
						"type": "varchar"
					},
					{
						"name": "BillToPhone1",
						"type": "varchar"
					},
					{
						"name": "BillToPhone2",
						"type": "varchar"
					},
					{
						"name": "BillToState",
						"type": "varchar"
					},
					{
						"name": "BillToZipCode",
						"type": "varchar"
					},
					{
						"name": "BranchCode",
						"type": "varchar"
					},
					{
						"name": "COGSPosted",
						"type": "bit"
					},
					{
						"name": "CallSequence",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "CommittedPaymentTotal",
						"type": "decimal",
						"precision": 18,
						"scale": 0
					},
					{
						"name": "DateCreated",
						"type": "date"
					},
					{
						"name": "DateModified",
						"type": "date"
					},
					{
						"name": "DispatchPriority",
						"type": "varchar"
					},
					{
						"name": "DispatchRequestedRouteCode",
						"type": "varchar"
					},
					{
						"name": "DispatchSpecRequest",
						"type": "varchar"
					},
					{
						"name": "DispatchTime",
						"type": "varchar"
					},
					{
						"name": "DispatchTimeAM",
						"type": "varchar"
					},
					{
						"name": "Estimate",
						"type": "varchar"
					},
					{
						"name": "Field1",
						"type": "varchar"
					},
					{
						"name": "Field2",
						"type": "varchar"
					},
					{
						"name": "Field3",
						"type": "varchar"
					},
					{
						"name": "Field4",
						"type": "varchar"
					},
					{
						"name": "Field5",
						"type": "varchar"
					},
					{
						"name": "InvFinishDate",
						"type": "date"
					},
					{
						"name": "InvStartDate",
						"type": "date"
					},
					{
						"name": "InvTypeCode",
						"type": "varchar"
					},
					{
						"name": "ItemListPriceCode",
						"type": "varchar"
					},
					{
						"name": "ItemTotal",
						"type": "decimal",
						"precision": 18,
						"scale": 0
					},
					{
						"name": "JobLocation",
						"type": "varchar"
					},
					{
						"name": "JobNumber",
						"type": "varchar"
					},
					{
						"name": "JobStatusCode",
						"type": "varchar"
					},
					{
						"name": "LaborRate",
						"type": "varchar"
					},
					{
						"name": "LaborTotal",
						"type": "decimal",
						"precision": 18,
						"scale": 0
					},
					{
						"name": "MapReference",
						"type": "varchar"
					},
					{
						"name": "MapZoneCode",
						"type": "varchar"
					},
					{
						"name": "MiscTotal",
						"type": "decimal",
						"precision": 18,
						"scale": 0
					},
					{
						"name": "OpenPaymentTotal",
						"type": "decimal",
						"precision": 18,
						"scale": 0
					},
					{
						"name": "OtherListPriceCode",
						"type": "varchar"
					},
					{
						"name": "PONumber",
						"type": "varchar"
					},
					{
						"name": "PaymentTypeCode",
						"type": "varchar"
					},
					{
						"name": "PickUpDate",
						"type": "date"
					},
					{
						"name": "Reference",
						"type": "varchar"
					},
					{
						"name": "SaleReferralCode",
						"type": "varchar"
					},
					{
						"name": "Salesperson1Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Code",
						"type": "varchar"
					},
					{
						"name": "Salesperson2Percentage",
						"type": "decimal",
						"precision": 18,
						"scale": 0
					},
					{
						"name": "ScheduleDate",
						"type": "date"
					},
					{
						"name": "SerialListPriceCode",
						"type": "varchar"
					},
					{
						"name": "SerialTotal",
						"type": "decimal",
						"precision": 18,
						"scale": 0
					},
					{
						"name": "SoldToAddress1",
						"type": "varchar"
					},
					{
						"name": "SoldToAddress2",
						"type": "varchar"
					},
					{
						"name": "SoldToCity",
						"type": "varchar"
					},
					{
						"name": "SoldToCode",
						"type": "varchar"
					},
					{
						"name": "SoldToDirections",
						"type": "varchar"
					},
					{
						"name": "SoldToEmail",
						"type": "varchar"
					},
					{
						"name": "SoldToFirstName",
						"type": "varchar"
					},
					{
						"name": "SoldToLastName",
						"type": "varchar"
					},
					{
						"name": "SoldToPhone1",
						"type": "varchar"
					},
					{
						"name": "SoldToPhone2",
						"type": "varchar"
					},
					{
						"name": "SoldToState",
						"type": "varchar"
					},
					{
						"name": "SoldToZipCode",
						"type": "varchar"
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "SvcAgreementExpDate",
						"type": "date"
					},
					{
						"name": "SvcAgreementNumber",
						"type": "varchar"
					},
					{
						"name": "SvcBrandCode",
						"type": "varchar"
					},
					{
						"name": "SvcCenter",
						"type": "varchar"
					},
					{
						"name": "SvcCenterNumber",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintCode",
						"type": "varchar"
					},
					{
						"name": "SvcComplaintDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDatePurchased",
						"type": "date"
					},
					{
						"name": "SvcDealerCode",
						"type": "varchar"
					},
					{
						"name": "SvcDealerDesc",
						"type": "varchar"
					},
					{
						"name": "SvcDistributorNumber",
						"type": "varchar"
					},
					{
						"name": "SvcInWarranty",
						"type": "varchar"
					},
					{
						"name": "SvcMfgCodeEiaNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMicroLeak",
						"type": "varchar"
					},
					{
						"name": "SvcMiles",
						"type": "decimal",
						"precision": 18,
						"scale": 0
					},
					{
						"name": "SvcMilesRate",
						"type": "decimal",
						"precision": 18,
						"scale": 0
					},
					{
						"name": "SvcMilesTotal",
						"type": "decimal",
						"precision": 18,
						"scale": 0
					},
					{
						"name": "SvcModel",
						"type": "varchar"
					},
					{
						"name": "SvcMotorNewNumber",
						"type": "varchar"
					},
					{
						"name": "SvcMotorOldNumber",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedCode",
						"type": "varchar"
					},
					{
						"name": "SvcPerformedDesc",
						"type": "varchar"
					},
					{
						"name": "SvcProduct",
						"type": "varchar"
					},
					{
						"name": "SvcProductCode",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCatMinorMajor",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCategory",
						"type": "varchar"
					},
					{
						"name": "SvcRepairCode",
						"type": "varchar"
					},
					{
						"name": "SvcRunNumber",
						"type": "varchar"
					},
					{
						"name": "SvcSerial",
						"type": "varchar"
					},
					{
						"name": "SvcSpecAuthNumber",
						"type": "varchar"
					},
					{
						"name": "SvcStockMerchandise",
						"type": "bit"
					},
					{
						"name": "SvcTimeCompleted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeCompleted2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeOnJob2",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted1",
						"type": "varchar"
					},
					{
						"name": "SvcTimeStarted2",
						"type": "varchar"
					},
					{
						"name": "Tax1Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax1Total",
						"type": "decimal",
						"precision": 18,
						"scale": 0
					},
					{
						"name": "Tax2Code",
						"type": "varchar"
					},
					{
						"name": "Tax2Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax2Percentage",
						"type": "decimal",
						"precision": 18,
						"scale": 0
					},
					{
						"name": "Tax2Total",
						"type": "decimal",
						"precision": 18,
						"scale": 0
					},
					{
						"name": "Tax3Exempt",
						"type": "varchar"
					},
					{
						"name": "Tax3Total",
						"type": "decimal",
						"precision": 18,
						"scale": 0
					},
					{
						"name": "UserCreated",
						"type": "varchar"
					},
					{
						"name": "UserModified",
						"type": "varchar"
					},
					{
						"name": "Warranty",
						"type": "varchar"
					},
					{
						"name": "WarrantyField1",
						"type": "varchar"
					},
					{
						"name": "WarrantyField2",
						"type": "varchar"
					},
					{
						"name": "WarrantyField3",
						"type": "varchar"
					},
					{
						"name": "WarrantyField4",
						"type": "varchar"
					},
					{
						"name": "WarrantyField5",
						"type": "varchar"
					},
					{
						"name": "WtyTotal",
						"type": "decimal",
						"precision": 18,
						"scale": 0
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "Invoice"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Secondary1_Source')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Odbc1",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "OdbcTable",
				"schema": [],
				"typeProperties": {
					"tableName": "SQLUser.Invoice"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/SerialODS')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1LinkedService_Test",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "TripNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ParentDateStamp",
						"type": "date"
					},
					{
						"name": "ParentLineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "Amount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "DateStamp",
						"type": "date"
					},
					{
						"name": "Description",
						"type": "varchar"
					},
					{
						"name": "InPackage",
						"type": "varchar"
					},
					{
						"name": "InvoiceCode",
						"type": "varchar"
					},
					{
						"name": "LineNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "LineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "LineType",
						"type": "varchar"
					},
					{
						"name": "LocationCode",
						"type": "varchar"
					},
					{
						"name": "Qty",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "Tax1",
						"type": "bit"
					},
					{
						"name": "Tax2",
						"type": "bit"
					},
					{
						"name": "Tax3",
						"type": "bit"
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "Serial"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/SourceDataset_hdo')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Odbc1",
					"type": "LinkedServiceReference"
				},
				"parameters": {
					"TableName": {
						"type": "string"
					}
				},
				"annotations": [],
				"type": "OdbcTable",
				"schema": [],
				"typeProperties": {
					"tableName": {
						"value": "@dataset().TableName",
						"type": "Expression"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/SupplierODS')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Secondary1LinkedService_Test",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "AzureSqlTable",
				"schema": [
					{
						"name": "ID",
						"type": "int",
						"precision": 10
					},
					{
						"name": "TripNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "ParentDateStamp",
						"type": "date"
					},
					{
						"name": "ParentLineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "sysCreated",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "sysModified",
						"type": "datetime",
						"precision": 23,
						"scale": 3
					},
					{
						"name": "Amount",
						"type": "decimal",
						"precision": 15,
						"scale": 4
					},
					{
						"name": "Code",
						"type": "varchar"
					},
					{
						"name": "DateStamp",
						"type": "date"
					},
					{
						"name": "Description",
						"type": "varchar"
					},
					{
						"name": "InPackage",
						"type": "varchar"
					},
					{
						"name": "InvoiceCode",
						"type": "varchar"
					},
					{
						"name": "LineNo",
						"type": "int",
						"precision": 10
					},
					{
						"name": "LineTimeStamp",
						"type": "varchar"
					},
					{
						"name": "LineType",
						"type": "varchar"
					},
					{
						"name": "LocationCode",
						"type": "varchar"
					},
					{
						"name": "Qty",
						"type": "int",
						"precision": 10
					},
					{
						"name": "Status",
						"type": "varchar"
					},
					{
						"name": "Tax1",
						"type": "bit"
					},
					{
						"name": "Tax2",
						"type": "bit"
					},
					{
						"name": "Tax3",
						"type": "bit"
					}
				],
				"typeProperties": {
					"schema": "rd",
					"table": "Supplier"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Test_CSV')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Testblobstorage1",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"container": "loadtest"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/invoiceaddressCSV')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "BlobStorageLinkedService",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"container": "rdinvoiceaddress"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "ID",
						"type": "String"
					},
					{
						"name": "TripNo",
						"type": "String"
					},
					{
						"name": "ParentDateStamp",
						"type": "String"
					},
					{
						"name": "ParentLineTimeStamp",
						"type": "String"
					},
					{
						"name": "sysCreated",
						"type": "String"
					},
					{
						"name": "sysModified",
						"type": "String"
					},
					{
						"name": "Amount",
						"type": "String"
					},
					{
						"name": "Code",
						"type": "String"
					},
					{
						"name": "DateStamp",
						"type": "String"
					},
					{
						"name": "Description",
						"type": "String"
					},
					{
						"name": "InPackage",
						"type": "String"
					},
					{
						"name": "InvoiceCode",
						"type": "String"
					},
					{
						"name": "LineNo",
						"type": "String"
					},
					{
						"name": "LineTimeStamp",
						"type": "String"
					},
					{
						"name": "LineType",
						"type": "String"
					},
					{
						"name": "LocationCode",
						"type": "String"
					},
					{
						"name": "Qty",
						"type": "String"
					},
					{
						"name": "Status",
						"type": "String"
					},
					{
						"name": "Tax1",
						"type": "String"
					},
					{
						"name": "Tax2",
						"type": "String"
					},
					{
						"name": "Tax3",
						"type": "String"
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/invoiceaddressdataset')]",
			"type": "Microsoft.DataFactory/factories/datasets",
			"apiVersion": "2018-06-01",
			"properties": {
				"linkedServiceName": {
					"referenceName": "BlobStorageLinkedService",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "DelimitedText",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"container": "invoiceaddress"
					},
					"columnDelimiter": ",",
					"escapeChar": "\\",
					"firstRowAsHeader": true,
					"quoteChar": "\""
				},
				"schema": [
					{
						"name": "ID",
						"type": "String"
					},
					{
						"name": "TripNo",
						"type": "String"
					},
					{
						"name": "ParentDateStamp",
						"type": "String"
					},
					{
						"name": "ParentLineTimeStamp",
						"type": "String"
					},
					{
						"name": "sysCreated",
						"type": "String"
					},
					{
						"name": "sysModified",
						"type": "String"
					},
					{
						"name": "Amount",
						"type": "String"
					},
					{
						"name": "Code",
						"type": "String"
					},
					{
						"name": "DateStamp",
						"type": "String"
					},
					{
						"name": "Description",
						"type": "String"
					},
					{
						"name": "InPackage",
						"type": "String"
					},
					{
						"name": "InvoiceCode",
						"type": "String"
					},
					{
						"name": "LineNo",
						"type": "String"
					},
					{
						"name": "LineTimeStamp",
						"type": "String"
					},
					{
						"name": "LineType",
						"type": "String"
					},
					{
						"name": "LocationCode",
						"type": "String"
					},
					{
						"name": "Qty",
						"type": "String"
					},
					{
						"name": "Status",
						"type": "String"
					},
					{
						"name": "Tax1",
						"type": "String"
					},
					{
						"name": "Tax2",
						"type": "String"
					},
					{
						"name": "Tax3",
						"type": "String"
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/FullTableRefresh_Trigger')]",
			"type": "Microsoft.DataFactory/factories/triggers",
			"apiVersion": "2018-06-01",
			"properties": {
				"annotations": [],
				"runtimeState": "Started",
				"pipelines": [
					{
						"pipelineReference": {
							"referenceName": "Branch_Cache to ODS",
							"type": "PipelineReference"
						},
						"parameters": {
							"ControlTable_Entity": "Branch",
							"ControlTable_Group1": "10",
							"ETLBeginTimeColumn": "ETL Last Run Start",
							"ETLEndTimeColumn": "ETL Last Run End",
							"ControlTable_Group2": "20"
						}
					},
					{
						"pipelineReference": {
							"referenceName": "Brand_Cache to ODS",
							"type": "PipelineReference"
						},
						"parameters": {
							"ControlTable_Entity": "Brand",
							"ControlTable_Group1": "10",
							"ETLBeginTimeColumn": "ETL Last Run Start",
							"ETLEndTimeColumn": "ETL Last Run End",
							"ControlTable_Group2": "20"
						}
					},
					{
						"pipelineReference": {
							"referenceName": "Misc_Cache to ODS",
							"type": "PipelineReference"
						},
						"parameters": {
							"ControlTable_Entity": "Misc",
							"ControlTable_Group1": "10",
							"ETLBeginTimeColumn": "ETL Last Run Start",
							"ETLEndTimeColumn": "ETL Last Run End",
							"ControlTable_Group2": "20"
						}
					},
					{
						"pipelineReference": {
							"referenceName": "SalesPerson_Cache to ODS",
							"type": "PipelineReference"
						},
						"parameters": {
							"ControlTable_Entity": "SalesPerson",
							"ControlTable_Group1": "10",
							"ETLBeginTimeColumn": "ETL Last Run Start",
							"ETLEndTimeColumn": "ETL Last Run End",
							"ControlTable_Group2": "20"
						}
					},
					{
						"pipelineReference": {
							"referenceName": "Location_Cache to ODS",
							"type": "PipelineReference"
						},
						"parameters": {
							"ControlTable_Entity": "Location",
							"ControlTable_Group1": "10",
							"ETLBeginTimeColumn": "ETL Last Run Start",
							"ETLEndTimeColumn": "ETL Last Run End",
							"ControlTable_Group2": "20"
						}
					},
					{
						"pipelineReference": {
							"referenceName": "Product_Cache to ODS",
							"type": "PipelineReference"
						},
						"parameters": {
							"ControlTable_Entity": "Product",
							"ControlTable_Group1": "10",
							"ETLBeginTimeColumn": "ETL Last Run Start",
							"ETLEndTimeColumn": "ETL Last Run End",
							"ControlTable_Group2": "20"
						}
					},
					{
						"pipelineReference": {
							"referenceName": "ProductMinor_Cache to ODS Copy Activity",
							"type": "PipelineReference"
						},
						"parameters": {
							"ControlTable_Entity": "ProductMinor",
							"ControlTable_Group1": "10",
							"ETLBeginTimeColumn": "ETL Last Run Start",
							"ETLEndTimeColumn": "ETL Last Run End",
							"ControlTable_Group2": "20"
						}
					},
					{
						"pipelineReference": {
							"referenceName": "Dim_ProductMajor_Cache to ODS Copy Activity",
							"type": "PipelineReference"
						},
						"parameters": {
							"ControlTable_Entity": "Dim_ProductMajor",
							"ControlTable_Group1": "10",
							"ETLBeginTimeColumn": "ETL Last Run Start",
							"ETLEndTimeColumn": "ETL Last Run End",
							"ControlTable_Group2": "20"
						}
					},
					{
						"pipelineReference": {
							"referenceName": "Dim_ProductSuper_Cache to ODS Copy Activity",
							"type": "PipelineReference"
						},
						"parameters": {
							"ControlTable_Entity": "Dim_ProductSuper",
							"ControlTable_Group1": "10",
							"ETLBeginTimeColumn": "ETL Last Run Start",
							"ETLEndTimeColumn": "ETL Last Run End",
							"ControlTable_Group2": "20"
						}
					},
					{
						"pipelineReference": {
							"referenceName": "ModelNote_Cache to ODS",
							"type": "PipelineReference"
						},
						"parameters": {
							"ControlTable_Entity": "ModelNote",
							"ControlTable_Group1": "10",
							"ETLBeginTimeColumn": "ETL Last Run Start",
							"ETLEndTimeColumn": "ETL Last Run End",
							"ControlTable_Group2": "20"
						}
					}
				],
				"type": "ScheduleTrigger",
				"typeProperties": {
					"recurrence": {
						"frequency": "Hour",
						"interval": 6,
						"startTime": "2021-06-30T13:48:00",
						"timeZone": "Pacific Standard Time"
					}
				}
			},
			"dependsOn": [
				"[concat(variables('factoryId'), '/pipelines/Branch_Cache to ODS')]",
				"[concat(variables('factoryId'), '/pipelines/Brand_Cache to ODS')]",
				"[concat(variables('factoryId'), '/pipelines/Misc_Cache to ODS')]",
				"[concat(variables('factoryId'), '/pipelines/SalesPerson_Cache to ODS')]",
				"[concat(variables('factoryId'), '/pipelines/Location_Cache to ODS')]",
				"[concat(variables('factoryId'), '/pipelines/Product_Cache to ODS')]",
				"[concat(variables('factoryId'), '/pipelines/ProductMinor_Cache to ODS Copy Activity')]",
				"[concat(variables('factoryId'), '/pipelines/Dim_ProductMajor_Cache to ODS Copy Activity')]",
				"[concat(variables('factoryId'), '/pipelines/Dim_ProductSuper_Cache to ODS Copy Activity')]",
				"[concat(variables('factoryId'), '/pipelines/ModelNote_Cache to ODS')]"
			]
		}
	]
}